/*------------------------------------INSERT VALUES INTO METADATA TABLE-----------------------------------------------*/

INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appt_Date', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Opportunity[Date_Time_of_First_Appt__c])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Opportunity[Date_Time_of_First_Appt__c]))  return IF(ISBLANK(Opportunity[Date_Time_of_First_Appt__c]), BLANK(), FORMAT(if(and(Opportunity[Date_Time_of_First_Appt__c] >= DST_Start, Opportunity[Date_Time_of_First_Appt__c] < DST_End), Opportunity[Date_Time_of_First_Appt__c] - (4/24), Opportunity[Date_Time_of_First_Appt__c] - (5/24)), ""MM/DD/YYYY""))"', N'Opportunity.[Date_Time_of_First_Appt__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appts_Ran_count', N'Calculation', N'Column', N'"CALCULATE(COUNT(Event[Id]), FILTER(Event, Opportunity[Id] = Event[Opp Id]), FILTER(Event, Event[Outcomes (groups 1)] = ""Appointment Ran""))"', N'count(Event.[id])', N'[Event]', N'Opportunity.[Id] = Event.[Oppt_Id]   and Event.[Outcomes_groups_1] = ''Appointment Ran''', 31, NULL, N'Opportunity.Id', N'Id', 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avoided_Rep_Control_Track_C', N'Case - Power of 1', N'Column', N'"IF(     ISBLANK(Opportunity[Under Rep Control Track C]),     1,     0 )"', N'CASE WHEN Opportunity.[Under_Rep_Control_Track_C] IS NULL THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Below_target_Cash', N'Case - Result', N'Column', N'"If(not(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])) && not(ISBLANK(Opportunity[Final Cash])) && Opportunity[Commissionable_Price_Per_Watt__c] < Opportunity[Final Cash],""Cash"", BLANK())"', N'CASE WHEN Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL   AND Opportunity.[Target_Cash] IS NOT NULL AND 
Opportunity.[Commissionable_Price_Per_Watt__c] < Opportunity.[Target_Cash]   THEN ''CASH''  ELSE  NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Below_target_floor', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])) && NOT(ISBLANK(Opportunity[Final Floor])) && Opportunity[Commissionable_Price_Per_Watt__c] < Opportunity[Final Floor], ""Floor"", BLANK())"', N'CASE WHEN Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL 
AND Opportunity.[Target_Floor] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c] < Opportunity.[Target_Floor] THEN ''Floor'' ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Below_target_Loan', N'Case - Result', N'Column', N'"If(not(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])) && not(ISBLANK(Opportunity[Final Loan])) && Opportunity[Commissionable_Price_Per_Watt__c] < Opportunity[Final Loan],""Loan"", BLANK())"', N'CASE WHEN Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL AND Opportunity.[Target_Loan] IS NOT NULL 
AND Opportunity.[Commissionable_Price_Per_Watt__c] < Opportunity.[Target_Loan] THEN ''Loan''  ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Below_target_Min', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])) && NOT(ISBLANK(Opportunity[Final Minimum])) && Opportunity[Commissionable_Price_Per_Watt__c] < Opportunity[Final Minimum], ""Minimum"", BLANK())"', N'CASE WHEN Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL AND Opportunity.[Target_Minimum] IS NOT NULL 
AND Opportunity.[Commissionable_Price_Per_Watt__c] < Opportunity.[Target_Minimum] THEN ''Minimum''  ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Below_target_Rate', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[PPA_Rate__c])) && NOT(ISBLANK(Opportunity[Final Rate])) && Opportunity[PPA_Rate__c] < Opportunity[Final Rate], ""PPA"",BLANK())"', N'CASE WHEN Opportunity.[PPA_Rate__c] IS NOT  NULL AND Opportunity.[Target_Rate] IS NOT NULL AND 
Opportunity.[PPA_Rate__c] < Opportunity.[Target_Rate] THEN ''PPA'' ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Business_Days_Contract_Signed_to_Submitted', N'Calculation', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Contract_Signed__c]), ISBLANK(Opportunity[Date_Contract_Submitted__c])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], Opportunity[Date_Contract_Signed__c], Opportunity[Date_Contract_Submitted__c] -1),     ''Date''[Working Day] = 1,     ALL(''Opportunity'') )+0)"', N'Isnull(CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL 
OR Opportunity.[Date_Contract_Submitted__c] IS NULL THEN NULL 
ELSE count(Date_Table.[Date]) END,0)', N'[Date_Table]', N'Date_Table.[Date] >= Opportunity.[Date_Contract_Signed__c] and Date_Table.[Date] <= Opportunity.[Date_Contract_Submitted__c] -1  and Date_Table.[Working_Day]=1', 26, NULL, N'opportunity.Date_Contract_Signed__c,opportunity.Date_Contract_Submitted__c', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Business_Days_Contract_to_Install', N'Calculation', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Contract_Signed__c]), ISBLANK(Opportunity[Actual_Install_Date__c])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], Opportunity[Date_Contract_Signed__c], Opportunity[Actual_Install_Date__c] -1),     ''Date''[Working Day] = 1,     ALL(''Opportunity'') )+0)"', N'isnull(CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL OR 
Opportunity.[Actual_Install_Date__c] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'[Date_Table]', N'Date_Table.[Date] >= Opportunity.[Date_Contract_Signed__c] and   
Date_Table.[Date] <= Opportunity.[Actual_Install_Date__c] -1 and Date_Table.[Working_Day]=1', 25, NULL, N'opportunity.Date_Contract_Signed__c,opportunity.Actual_Install_Date__c', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Business_Days_Contract_to_PTO', N'Calculation', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Contract_Signed__c]), ISBLANK(Opportunity[Date_Interconn_Approved__c])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], Opportunity[Date_Contract_Signed__c], Opportunity[Date_Interconn_Approved__c] -1),     ''Date''[Working Day] = 1,     ALL(''Opportunity'') )+0)"', N'isnull(CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL OR 
Opportunity.[Date_Interconn_Approved__c] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'[Date_Table]', N'Date_Table.[Date] >= Opportunity.[Date_Contract_Signed__c] and   
Date_Table.[Date] <= Opportunity.[Actual_Install_Date__c] -1 and Date_Table.[Working_Day]=1', 24, NULL, N'opportunity.Date_Contract_Signed__c,opportunity.Date_Interconn_Approved__c', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Count_Track_C', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Direct Points] = 0, 0, Opportunity[Under Rep Control])"', N'CASE WHEN Opportunity.[Direct_Points]=0 THEN 0 ELSE Opportunity.[Under_Rep_Control] END', NULL, NULL, 32, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Day_of_Week', N'Format', N'Column', N'WEEKDAY(Opportunity[Appt Date])', N'DATEPART(WEEKDAY, Opportunity.[Appt_Date])', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Demo_Scheduled', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Demo Date w/DST] >= TODAY() && Opportunity[Appt_Completed__c] = 0, 1, 0)"', N'CASE WHEN Opportunity.[Demo_Date_Time_w_DST]
 >= GETDATE() AND Opportunity.[Appt_Completed__c] = 0 THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Business_Days_Install_Complete_to_PTO', N'Calculation', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Interconn_Approved__c]), ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c], Opportunity[Date_Interconn_Approved__c] -1),     ''Date''[Working Day] = 1,     ALL(''Opportunity'') )+0)"', N'isnull(CASE WHEN Opportunity.[Date_Interconn_Approved__c] IS NULL OR 
Opportunity.[Actual_Install_Complete_Date__c] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'[Date_Table]', N'Date_Table.Date >= Opportunity.[Actual_Install_Complete_Date__c] and   Date_Table.[Date]<= Opportunity.[Date_Interconn_Approved__c] -1 and Date_Table.[Working_Day]=1', 23, NULL, N'opportunity.date_interconn_approved__c,opportunity.actual_install_complete_date__c', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Business_Days_Installs_Started_to_Completed', N'Calculation', N'Column', N'"IF(OR(ISBLANK(Opportunity[Actual_Install_Date__c]), ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], Opportunity[Actual_Install_Date__c], Opportunity[Actual_Install_Complete_Date__c] -1),     ''Date''[Working Day] = 1,     ALL(''Opportunity'') )+0)"', N'isnull(CASE WHEN Opportunity.[Actual_Install_Date__c] IS NULL OR 
Opportunity.[Actual_Install_Complete_Date__c] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'[Date_Table]', N'Date_Table.Date >= Opportunity.[Actual_Install_Date__c] and   Date_Table.[Date]<= Opportunity.[Actual_Install_Complete_Date__c] -1 and Date_Table.[Working_Day]=1', 22, NULL, N'opportunity.Actual_Install_Date__c,opportunity.Actual_Install_Complete_Date__c', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Target_Cash', N'Case - Result', N'Column', N'"IF(     Opportunity[PM Groups] <> BLANK(),      LOOKUPVALUE(''Pricing_Matrix EPC''[Cash], ''Pricing_Matrix EPC''[StateUtility], Opportunity[State Utility], ''Pricing_Matrix EPC''[sales_division], Opportunity[Trad or Direct], ''Pricing_Matrix EPC''[effective_date], Opportunity[Effective Date]),     BLANK() )"', N'CASE WHEN Opportunity.[PM_Groups] IS NOT NULL THEN Pricing_Matrix_Denormalized.[Cash] ELSE NULL END', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[StateUtility]   = Opportunity.[State_Utility] AND  Pricing_Matrix_Denormalized.[sales_division]= 
Opportunity.[Trad_or_Direct] AND    Pricing_Matrix_Denormalized.[effective_date]= Opportunity.[Effective_Date]', 17, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'State', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[BillingState],Account[Id],Opportunity[AccountId])"', N'Account.[BillingState]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trad_or_Direct', N'Case - Result', N'Column', N'"IF(SEARCH(""Traditional"", Opportunity[Division__c],, BLANK() )>0, ""Traditional"",  IF(SEARCH(""Direct"", Opportunity[Division__c],, BLANK())>0, ""Direct"", BLANK()))"', N'CASE WHEN Opportunity.[Division__c] LIKE ''%Traditional%'' THEN ''Traditional'' WHEN Opportunity.[Division__c] LIKE ''%Direct%'' THEN ''Direct'' ELSE '''' END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installs_Started_to_Completed_seconds', N'Calculation', N'Column', N'Opportunity[Business Days Installs Started to Completed] * 86400', N'Opportunity.[Business_Days_Installs_Started_to_Completed] * 86400', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Last_Appt_Before_Contract_Signed', N'Case - Result', N'Column', N'"IF(     Opportunity[Contract -CF] = 1,     CALCULATE(MAX(Event[Appt Date]), FILTER(Event, Event[Opp Id] = Opportunity[Id]), FILTER(Event, Event[Appt Date] <= Opportunity[Date_Contract_Signed__c])),     BLANK() )"', N'CASE WHEN Opportunity.[Contract_Signed_CF] = 1 THEN MAX(Event.[Appt_Date]) END', N'[Event]', N'Event.[Oppt_Id] = Opportunity.[Id] AND Event.[Appt_Date] <= Opportunity.[Date_Contract_Signed__c]', 53, NULL, N'Opportunity.Date_Contract_Signed__c,Opportunity.[Contract_Signed_CF]', N'Id', 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lead_Source_Lookup', N'Case - Result', N'Column', N'"IF(     ISBLANK(LOOKUPVALUE(LeadSource[leadSourceGroup], LeadSource[leadSource], Opportunity[Actual Lead Source])),     ""Other"",     LOOKUPVALUE(LeadSource[leadSourceGroup], LeadSource[leadSource], Opportunity[Actual Lead Source]) )"', N'CASE WHEN Lead_Source.[LeadSourceGroup] IS NULL THEN ''Other'' ELSE Lead_Source.[LeadSourceGroup] END', N'Lead_Source', N'Lead_Source.[LeadSource] = Opportunity.[Actual_Lead_Source]', 50, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Target_Loan', N'Case - Result', N'Column', N'"IF(     Opportunity[PM Groups] <> BLANK(),      LOOKUPVALUE(''Pricing_Matrix EPC''[Loan], ''Pricing_Matrix EPC''[StateUtility], Opportunity[State Utility], ''Pricing_Matrix EPC''[sales_division], Opportunity[Trad or Direct], ''Pricing_Matrix EPC''[effective_date], Opportunity[Effective Date]),     BLANK() )"', N'CASE WHEN Opportunity.[PM_Groups] IS NOT NULL THEN Pricing_Matrix_Denormalized.[Loan] ELSE NULL END', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[StateUtility] = Opportunity.[State_Utility] AND  Pricing_Matrix_Denormalized.[effective_date] = Opportunity.[Effective_Date] AND Pricing_Matrix_Denormalized.[sales_division]=Opportunity.[Trad_or_Direct]', 41, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Completed_Before_DToFA', N'Case - Power of 1', N'Column', N'"VAR Completed = CALCULATE(MIN(''Action Item''[Completed_Date__c]), FILTER(''Action Item'', ''Action Item''[Opportunity__c] = Opportunity[Id]), FILTER(''Action Item'', NOT(ISBLANK(''Action Item''[Completed_Date__c]))), FILTER(''Action Item'', ''Action Item''[RSA Completed] = 1))  return IF(     NOT(ISBLANK(Completed)) && Completed < Opportunity[Date_Time_of_First_Appt__c],     1,     0 )"', N'CASE WHEN MIN(action_item.Completed_Date__c)<Opportunity.[Date_Time_of_First_Appt__c] THEN 1 ELSE 0 END', N'action_item', N'action_item.[Opportunity__c] = Opportunity.[Id] AND action_item.[Completed_Date__c] IS NOT NULL AND action_item.[RSA_Completed]=1', 52, NULL, N'Opportunity.[Date_Time_of_First_Appt__c] ', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_First_Name', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[FirstName], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id] = Opportunity.[Primary_Contact__c]
', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Has_Phone', N'Case - Result', N'Column', N'"IF(OR(Opportunity[Has Main Phone] = 1, Opportunity[Has Contact Phone] = 1), ""Yes"", ""No"")"', N'CASE WHEN Opportunity.[Has_Main_Phone] = 1 OR Opportunity.[Has_Contact_Phone]=1 THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Last_Name', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[LastName], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id] = Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_to_PTO_seconds', N'Calculation', N'Column', N'Opportunity[Business Days Contract to PTO] * 86400', N'Opportunity.[Business_Days_Contract_to_PTO] * 86400 ', NULL, NULL, 27, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Direct_Points', N'Case - Power of 1', N'Column', N'"IF(Opportunity[CA A&B] = 1, 1, IF(ISBLANK(Opportunity[Actual_Install_Date__c]), 0, 1))"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NULL THEN 0 ELSE 1 END', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Division_and_Office', N'Format', N'Column', N'"Opportunity[Division__c (groups)] & "" | "" & Opportunity[Direct_Sales_Office__c (groups)]"', N'CONCAT(Opportunity.[Division__c_groups] ,'' | '',Opportunity.[Direct_Sales_Office__c_groups])', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Rate_Escalator_Zero', N'Case - Result', N'Column', N'"IF(Opportunity[PM Groups] = ""IGS"" || Opportunity[PM Groups] = ""Sunrun"" || Opportunity[PM Groups] = ""Sunnova PPA"" || Opportunity[PM Groups] = ""Sunnova Lease"", IF(Opportunity[PPA_Rate_Escalator__c] = 0, ""0"", ""Remove Esc Zeros""),BLANK())"', N'CASE WHEN Opportunity.[PM_Groups] = ''IGS'' OR 
Opportunity.[PM_Groups] = ''Sunrun'' OR     Opportunity.[PM_Groups] = ''Sunnova PPA'' OR 
Opportunity.[PM_Groups] = ''Sunnova Lease'' THEN  NULL 
  WHEN Opportunity.[PPA_Rate_Escalator__c] = ''0.0%'' THEN ''0'' ELSE ''Remove Esc Zeros'' END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Finance_Partner', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[Name], Account[Id], Opportunity[Partner__c])"', N'Account.[Name]', N'[Account]', N'Account.[Id]=Opportunity.[Partner__c]', 37, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Target_floor', N'Case - Result', N'Column', N'"IF(     Opportunity[PM Groups] <> BLANK(),      LOOKUPVALUE(''Pricing_Matrix EPC''[Floor], ''Pricing_Matrix EPC''[StateUtility], Opportunity[State Utility], ''Pricing_Matrix EPC''[sales_division], Opportunity[Trad or Direct], ''Pricing_Matrix EPC''[effective_date], Opportunity[Effective Date]),     BLANK() )"', N'CASE WHEN Opportunity.[PM_Groups] IS NOT NULL THEN Pricing_Matrix_Denormalized.[floor] ELSE NULL END', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[StateUtility] = Opportunity.[State_Utility] AND  Pricing_Matrix_Denormalized.[effective_date] = Opportunity.[Effective_Date] AND Pricing_Matrix_Denormalized.[sales_division]=Opportunity.[Trad_or_Direct]', 41, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Address', N'Format', N'Column', N'"""Account[Name] & """" """" & Account[BillingPostalCode]""', N'CONCAT([Customer_Name],'' '',[BillingPostalCode])', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'AHJ_Blanks', N'Case - Power of 1', N'Column', N'"IF(Account[Median_Income__c] = BLANK() && Account[Population__c] = BLANK() && Account[of_Households__c] = BLANK(),1,0)"', N'CASE WHEN [Median_Income__c] IS NULL AND [Population__c] IS NULL AND [of_Households__c] IS NULL THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'billingCityAndState', N'Format', N'Column', N'"Account[BillingCity] & "", "" & Account[BillingStateCode]"', N'CONCAT([BillingCity],'','',[BillingStateCode])', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Scheduled_Completed', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Actual_Install_Date__c] = Opportunity[Actual_Install_Complete_Date__c], 1,0)"', N'CASE WHEN  Opportunity.[Actual_Install_Date__c] = Opportunity.[Actual_Install_Complete_Date__c] THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Started', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Installed]=""Yes"",1,0)"', N'CASE WHEN Opportunity.[Installed] =''YES'' THEN 1 ELSE 0 END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Duration_Range', N'Case - Result', N'Column', N'"if(not ISBLANK(Account[Process_Duration_days__c]),if(Account[Process_Duration_days__c] <30, ""<30"",if(Account[Process_Duration_days__c] = 30,""30"",IF(Account[Process_Duration_days__c] = 45,""45"",IF(Account[Process_Duration_days__c] =60, ""60"",IF(Account[Process_Duration_days__c] = 90,""90"",if(Account[Process_Duration_days__c]>90,"">90"")))))))"', N'CASE WHEN [Process_Duration_days__c]<30 THEN  CAST(''<30'' AS VARCHAR(5)) WHEN [Process_Duration_days__c]=30 THEN   CAST(''30'' AS VARCHAR(5)) WHEN [Process_Duration_days__c]=45 THEN  CAST(''45'' AS VARCHAR(5))  WHEN [Process_Duration_days__c]=60 THEN  CAST(''60'' AS VARCHAR(5)) WHEN [Process_Duration_days__c]=90 THEN   CAST(''90'' AS VARCHAR(5)) WHEN [Process_Duration_days__c]>90 THEN  CAST(''>90'' AS VARCHAR(5)) ELSE  CAST(''0'' AS VARCHAR(20)) END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lost_Before_Appt', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Stage Number] = 11 && Opportunity[Appointment_Completed__c] = 0, 1, 0)"', N'CASE WHEN Opportunity.[StageNumber] =11 AND Opportunity.[Appointment_Completed__c] = 0 THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Managing_Office', N'Case - Result', N'Column', N'var ManagingOffice = LOOKUPVALUE(Account[Name],Account[Id],Opportunity[Managing_Office__c])
return
IF(ISBLANK(ManagingOffice),BLANK(),
IF(SEARCH("Trinity Solar -", ManagingOffice,,BLANK())>0,
LEFT(RIGHT(ManagingOffice,LEN(ManagingOffice)-16),LEN(RIGHT(ManagingOffice,LEN(ManagingOffice)-0))-0),
ManagingOffice))', N'CASE WHEN Account.[Name] IS NULL THEN NULL WHEN  Account.[Name] LIKE''%Trinity Solar -%'' AND Account.[Name] IS NOT NULL THEN
LEFT(RIGHT(Account.[Name],LEN(Account.[Name])-16),LEN(RIGHT(Account.[Name],LEN(Account.[Name])-0))-0) END ', N'Account', N' Account.[Id]=Opportunity.[Managing_Office__c]', 21, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Latest_Appt_Ran_Date', N'Calculation', N'Column', N'"CALCULATE(MAX(Event[Start Date w/ DST]), FILTER(Event, Event[Opp Id] = Opportunity[Id]), FILTER(Event, Event[Start Date w/ DST] <= Opportunity[Date_Contract_Signed__c]), FILTER(Event,Event[Outcomes (groups 1)] = ""Appointment Ran""))"', N'MAX(Event.[Appt_Date])', N'[Event]', N'Event.[Oppt_Id] = Opportunity.[Id] AND Event.[Appt_Date] <= Opportunity.[Date_Contract_Signed__c]   AND Event.[Outcomes_groups_1] = ''Appointment Ran''', 51, NULL, N'Opportunity.Id', N'Id', 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Target_Rate', N'Case - Result', N'Column', N'"IF(Opportunity[PM Groups] = ""Sunnova PPA"" || Opportunity[PM Groups] = ""Sunnova Lease"" || Opportunity[PM Groups] = ""IGS"" || Opportunity[PM Groups] = ""Sunrun"", LOOKUPVALUE(''Pricing_Matrix PPA''[Rate], ''Pricing_Matrix PPA''[StateUtilityPurchaseMethod], Opportunity[SUP], ''Pricing_Matrix PPA''[effective_date], Opportunity[Effective Date], ''Pricing_Matrix PPA''[sales_division], Opportunity[Trad or Direct]))"', N'CASE WHEN Opportunity.[PM_Groups] 
IN(''Sunnova PPA'',''Sunnova Lease'',''IGS'',''Sunrun'')    THEN Pricing_Matrix_Denormalized.[Rate] END ', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[StateUtilityPurchaseMethod]=Opportunity.[SUP] AND  Pricing_Matrix_Denormalized.[effective_date]= Opportunity.[Effective_Date] AND    Pricing_Matrix_Denormalized.[sales_division]= Opportunity.[Trad_or_Direct]', 44, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Target_Minimum', N'Lookup', N'Column', N'"LOOKUPVALUE(''Pricing_Matrix EPC''[Minimum], ''Pricing_Matrix EPC''[StateUtility], Opportunity[State Utility], ''Pricing_Matrix EPC''[sales_division], Opportunity[Trad or Direct], ''Pricing_Matrix EPC''[effective_date], Opportunity[Effective Date])"', N'[Pricing_Matrix_Denormalized].[Minimum]', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[StateUtility]   = Opportunity.[State_Utility] AND Pricing_Matrix_Denormalized.[sales_division] = Opportunity.[Trad_or_Direct]   AND Pricing_Matrix_Denormalized.[effective_date] = Opportunity.[Effective_Date]', 45, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Multiplier', N'Case - Power of 1', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Multiplier__c]) && not ISBLANK(Opportunity[Contract Multiplier]), IF(Opportunity[Contract Multiplier] > Opportunity[Actual_Multiplier__c],1,0),BLANK())"', N'CASE WHEN Opportunity.[Actual_Multiplier__c] IS NOT NULL AND Opportunity.[Contract_Multiplier] IS NOT NULL   
  AND   Opportunity.[Contract_Multiplier] > Opportunity.[Actual_Multiplier__c] THEN 1  ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Multiplier_Calc', N'Calculation', N'Column', N'"IFERROR([X12_mos_PVWATTS_prod_Actual__c]/[System_Size_kWdc__c]/1000,0)"', N'((Opportunity.[X12_mos_PVWATTS_prod_Actual__c]/NULLIF(Opportunity.[System_Size_kWdc__c],0))/1000)', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Account_Street', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[BillingStreet], Account[Id], Opportunity[AccountId])"', N'Account.[BillingStreet]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'original_project_track', N'Lookup', N'Column', N'"LOOKUPVALUE(''Project Track''[Track__c], ''Project Track''[Id], Opportunity[Original Track])"', N'Project_Track.[Track__c]', N'[Project_Track]', N'Project_Track.[Id]=Opportunity.[Original_Project_Track_Id]', 35, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Original_Project_Track_Status', N'Lookup', N'Column', N'"LOOKUPVALUE(''Project Track''[Status__c], ''Project Track''[Id], Opportunity[Original Track])"', N'Project_Track.[Status__c]', N'[Project_Track]', N'Project_Track.[Id]=Opportunity.[Original_Project_Track_Id]', 35, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Original_Project_Track_Id', N'Lookup', N'Column', N'"CALCULATE(FIRSTNONBLANK(''Project Track''[Id],1), FILTER(''Project Track'', ''Project Track''[Opportunity__c] = Opportunity[Id]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'[Project_Track].Id', N'[Project_Track]', N'Project_Track.[Opportunity__c] = Opportunity.[id]', 34, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Pallet_Project', N'Case - Power of 1', N'Column', N'"IF(Opportunity[OPT] = ""C"" && Opportunity[OPT Status] = ""Open"" && Opportunity[StageName] = ""4: Contracted"" && Opportunity[Project_Status__c] <> ""Win Back"", 1,0)"', N'CASE WHEN Opportunity.[original_project_track] = ''C'' AND Opportunity.[Original_Project_Track_Status] = ''Open'' AND 
Opportunity.[StageName] = ''4: Contracted'' AND Opportunity.[Project_Status__c] <> ''Win Back'' THEN 1 ELSE 0 END', NULL, NULL, 36, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'AccountBillingCityAndState', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[billingCityAndState], Account[Id], Opportunity[AccountId])"', N'Account.[billingCityAndState]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PPA_Multiplier', N'Calculation', N'Column', N'16 * Opportunity[? PPA]', N'16 * Opportunity.[delta_rate_PPA]', NULL, NULL, 49, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PSA', N'Lookup', N'Column', N'"CALCULATE (     FIRSTNONBLANK ( ''Action Item''[AI_Template_Name__c], 1 ),     FILTER ( ALL ( ''Action Item'' ), ''Action Item''[Opportunity__c] = Opportunity[Id] ) )"', N'Action_Item.[AI_Template_Name__c]', N'Action_Item', N'Action_Item.[Opportunity__c] = Opportunity.[id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Site_Quality', N'Case - Result', N'Column', N'"IF(OR(Opportunity[Willing_to_Remove_Trees__c] = ""N/A"", Opportunity[Willing_to_Remove_Trees__c] = ""No Shade""), 1, IF(Opportunity[Willing_to_Remove_Trees__c] = ""Yes"", 2, IF(AND(Opportunity[Willing_to_Remove_Trees__c] = ""No"", Opportunity[Amount_of_Trees_Shading__c] <= 2), 2, 3)))"', N'CASE WHEN Opportunity.[Willing_to_Remove_Trees__c] = ''N/A'' OR        
Opportunity.[Willing_to_Remove_Trees__c] = ''No Shade'' THEN 1  WHEN Opportunity.[Willing_to_Remove_Trees__c] = ''Yes'' THEN 2       
WHEN Opportunity.[Willing_to_Remove_Trees__c] = ''No'' AND LEFT(Opportunity.[Amount_of_Trees_Shading__c],1) <= ''2'' THEN 2 ELSE 3 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Oppt_Contact_Self_Gen', N'Case - Result', N'Column', N'"var ContactLeadSource = LOOKUPVALUE(Contact[LeadSource], Contact[Id], Opportunity[Primary_Contact__c])  return IF(Opportunity[Self_Gen__c] = 1, 1, IF(ContactLeadSource = ""CAP Add-On"" ||  ContactLeadSource = ""CAP Referral"" ||  ContactLeadSource = ""Customer Referral"" ||  ContactLeadSource = ""Customer Referral – Web Form"" || ContactLeadSource = ""Door to Door Canvassing"" ||  ContactLeadSource = ""Prime"" ||  ContactLeadSource = ""Trinity Direct"" || ContactLeadSource = ""Self Generated"" ||  ContactLeadSource = ""Self Generated with Referral"", 1, 0))"', N'CASE WHEN  Opportunity.[Self_Gen__c]=1  THEN 1  
 WHEN Contact.[LeadSource] IN (''CAP Add-On'',''CAP Referral'',''Customer Referral'',''Customer Referral – Web Form'',
 ''Door to Door Canvassing'',''Prime'',''Trinity Direct'',''Self Generated'',''Self Generated with Referral'') THEN 1 ELSE 0 END', N'[Contact]', N'Contact.[Id]= Opportunity.[Primary_Contact__c]', 39, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Record_Type', N'Lookup', N'Column', N'"LOOKUPVALUE(''Record Type''[Name], ''Record Type''[Id], Opportunity[RecordTypeId])"', N'Record Type.[Customer_Name]', N'Record Type', N'Record Type.[Id] =Opportunity.[RecordTypeId]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'State_Utility_Purchase', N'Format', N'Column', N'Opportunity[Full State] & Opportunity[Utility_Company_Formula__c] & Opportunity[Purchase_Method__c (groups)]', N'CONCAT(Opportunity.[State], Opportunity.[Utility_Company_Formula__c] , Opportunity.[PM_Groups])', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Delta_cash_sys_size', N'Case - Result', N'Column', N'"If(Opportunity[? Starting Cash] < 0, Opportunity[Sys Size Watts] * Opportunity[? Starting Cash], BLANK())"', N'CASE WHEN Opportunity.[delta_CPPW_Cash] < 0 THEN   Opportunity.System_Size_Watts * Opportunity.[delta_CPPW_Cash] ELSE NULL END', NULL, NULL, 48, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Delta_floor_sys_size', N'Case - Result', N'Column', N'"If(Opportunity[? Floor] < 0, Opportunity[Sys Size Watts] * Opportunity[? Floor], BLANK())"', N'CASE WHEN Opportunity.[delta_CPPW_Floor] < 0 THEN   Opportunity.System_Size_Watts * Opportunity.[delta_CPPW_Floor] ELSE NULL END', NULL, NULL, 48, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Delta_loan_sys_size', N'Case - Result', N'Column', N'"If(Opportunity[? Starting Loan] < 0, Opportunity[Sys Size Watts] * Opportunity[? Starting Loan], BLANK())"', N'CASE WHEN Opportunity.[delta_CPPW_Loan] < 0 THEN   Opportunity.System_Size_Watts * Opportunity.[delta_CPPW_Loan] ELSE NULL END
', NULL, NULL, 48, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Delta_Minimum_sys_size', N'Case - Result', N'Column', N'"If(Opportunity[? Minimum] < 0, Opportunity[Sys Size Watts] * Opportunity[? Minimum], BLANK())"', N'CASE WHEN Opportunity.[delta_CPPW_Minimum] < 0 THEN   Opportunity.System_Size_Watts * Opportunity.[delta_CPPW_Minimum] ELSE NULL END', NULL, NULL, 48, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Days_Contract_to_Install', N'Case - Result', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Contract_Signed__c]), ISBLANK(Opportunity[Actual_Install_Date__c])), BLANK(), DATEDIFF(Opportunity[Date_Contract_Signed__c],Opportunity[Actual_Install_Date__c],DAY))"', N'CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL  OR Opportunity.[Actual_Install_Date__c] IS NULL THEN NULL ELSE   
 DATEDIFF(DAY,  Opportunity.[Actual_Install_Date__c],Opportunity.[Date_Contract_Signed__c]) END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Days_Install_Complete_to_PTO', N'Case - Result', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Interconn_Approved__c]), ISBLANK(Opportunity[Actual_Install_Complete_Date__c])),  BLANK(), DATEDIFF(Opportunity[Actual_Install_Complete_Date__c],Opportunity[Date_Interconn_Approved__c],DAY))"', N'CASE WHEN Opportunity.[Date_Interconn_Approved__c] IS NULL OR   
Opportunity.[Actual_Install_Complete_Date__c] IS NULL THEN NULL ELSE     
DATEDIFF(DAY, Opportunity.[Date_Interconn_Approved__c],Opportunity.[Actual_Install_Complete_Date__c]) END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Points_For_Non_Self_Gen_Contract', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Real Self Gen] = 0,      2,     0 )"', N'CASE WHEN Opportunity.[Oppt_Contact_Self_Gen] = 0 THEN 2 ELSE 0 END', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Lead_Source', N'Case - Result', N'Column', N'IF(Opportunity[Google Leads] = 1, "Google", Opportunity[LeadSource])', N'CASE WHEN Opportunity.[Google_Leads] = 1 THEN ''Google'' ELSE Opportunity.[LeadSource] END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Rep_Office', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Office__c (groups)], Contact[Id], Opportunity[Trinity_Salesperson__c])"', N'Contact.[Sales_Office__c_groups]', N'[Contact]', N'Contact.[Id] = Opportunity.[Trinity_Salesperson__c]', 57, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'RSA_Requested_before_DToFA', N'Case - Power of 1', N'Column', N'"VAR Requested = CALCULATE(MIN(''Action Item''[CreatedDate]), FILTER(''Action Item'', ''Action Item''[Opportunity__c] = Opportunity[Id]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment""))  return IF(     NOT(ISBLANK(Requested)) && Requested < Opportunity[Date_Time_of_First_Appt__c],     1,     0 )"', N'MIN(Action_Item.[CreatedDate])', N'Action_Item', N'Action_Item.[Opportunity__c] = Opportunity.[Id] AND Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment''', 54, NULL, N'Opportunity.Id', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Resolution_Review_End', N'Calculation', N'Column', N'"CALCULATE(MAX(''Action Item''[Completed_Date__c]), FILTER(''Action Item'', ''Action Item''[Opportunity__c] = Opportunity[Id]))"', N'MAX(Action_Item.[Completed_Date__c])', N'Action_Item', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 59, NULL, N'Opportunity.Id', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Resolution_Review_Start', N'Calculation', N'Column', N'"CALCULATE(MIN(''Action Item''[CreatedDate]), FILTER(''Action Item'', ''Action Item''[Opportunity__c] = Opportunity[Id]))"', N'MIN(Action_Item.[CreatedDate])', N'Action_Item', N'Action_Item.[Opportunity__c] = Opportunity.[id]', 15, NULL, N'Opportunity.Id', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Resolution_Specialist', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], Opportunity[Resolution_Specialist__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id]=Opportunity.[Resolution_Specialist__c]', 40, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sales_Division_and_Sales_Rep', N'Format', N'Column', N'"CONCATENATE(Opportunity[Division Abbreviation],Opportunity[Sales Rep])"', N'CONCAT(Opportunity.[Division_Abbreviation],Opportunity.[Sales_Rep])', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Amount_Minus_Credit_Fails', N'Case - Result', N'Column', N'"IF(     Opportunity[Reason_Lost__c] = ""Financial - Credit Reject"",     BLANK(),     Opportunity[Amount] )"', N'CASE WHEN Opportunity.[Reason_Lost__c]=''Financial - Credit Reject'' THEN NULL ELSE Opportunity.[Amount]  END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Commissionable_Amount_Minus_Credit_Fails', N'Case - Result', N'Column', N'"IF(     Opportunity[Reason_Lost__c] = ""Financial - Credit Reject"",     BLANK(),     Opportunity[Commissionable_Amount__c] )"', N'CASE WHEN Opportunity.[Reason_Lost__c]=''Financial - Credit Reject'' THEN NULL ELSE Opportunity.[Commissionable_Amount__c]  END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sales_Office_State', N'Format', N'Column', N'"LEFT(Opportunity[Direct_Sales_Office__c],2)"', N'LEFT([Direct_Sales_Office__c],2)', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Scheduled_to_PTO', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Date__c]) && not ISBLANK(Opportunity[Date_Interconn_Approved__c]), Opportunity[Date_Interconn_Approved__c] - Opportunity[Actual_Install_Date__c], BLANK())"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NOT   NULL AND Opportunity.[Date_Interconn_Approved__c] IS NOT NULL     
 THEN DATEDIFF(DAY, Opportunity.[Actual_Install_Date__c], Opportunity.[Date_Interconn_Approved__c]) ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Scheduled_Completed', N'Case - Result', N'Column', N'"IF(AND(not ISBLANK(Opportunity[Actual_Install_Date__c]), not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])) && Opportunity[Actual_Install_Complete_Date__c] = Opportunity[Actual_Install_Date__c], ""Same Day"", IF(AND(not ISBLANK(Opportunity[Actual_Install_Date__c]), not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])) && Opportunity[Actual_Install_Complete_Date__c] <> Opportunity[Actual_Install_Date__c], ""Different Day"", IF(not ISBLANK(Opportunity[Actual_Install_Date__c]) && ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) && Opportunity[Actual_Install_Date__c] <= TODAY(), ""Not Completed"", IF(not ISBLANK(Opportunity[Actual_Install_Date__c]) && ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) && Opportunity[Actual_Install_Date__c] > TODAY(), ""Scheduled"", BLANK()))))"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND   Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND  
    Opportunity.[Actual_Install_Complete_Date__c] = Opportunity.[Actual_Install_Date__c] THEN ''Same Day'' 
	 WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND  
	 Opportunity.[Actual_Install_Complete_Date__c] <> Opportunity.[Actual_Install_Date__c] THEN ''Different Day'' 
	  WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Date__c] <= GETDATE()
	   THEN ''Not Completed''  WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Complete_Date__c] IS NULL AND
	     Opportunity.[Actual_Install_Date__c] > GETDATE() THEN ''Scheduled'' ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Self_Gen_Contract_Points', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Real Self Gen] = 1,      3,     0 )"', N'CASE WHEN Opportunity.[Oppt_Contact_Self_Gen] = 1 THEN 3 ELSE 0 END', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Self_Gen_Referral_Contract_CF', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Contract -CF] = 1 && Opportunity[Actual Lead Source (groups) (groups)] = ""Referral/Self Gen"", 1, 0)"', N'CASE WHEN Opportunity.[Contract_Signed_CF] = 1 AND Opportunity.[Lead_Source_Lookup] 
IN(''Customer Referral'', ''Employee Referral'', ''Self Gen'')   THEN 1 ELSE 0 END', NULL, NULL, 56, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Signed_to_Submitted_seconds', N'Calculation', N'Column', N'Opportunity[Business Days Contract Signed to Submitted] * 86400', N'Opportunity.[Business_Days_Contract_Signed_to_Submitted] * 86400', NULL, NULL, 29, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Site_Assessment_Complete', N'Case - Result', N'Column', N'"IF(NOT(ISBLANK(Opportunity[PSA])), ""Complete"", IF(NOT(ISBLANK(Opportunity[RSA_Status__c])) && Opportunity[RSA_Status__c] <> ""EV Not Available"" && Opportunity[RSA_Status__c] <> ""Unable to ID Home"", ""Complete"", IF(OR(Opportunity[RSA_Status__c] = ""EV Not Available"", Opportunity[RSA_Status__c] = ""Unable to ID Home"") && NOT(ISBLANK(Opportunity[PSA])), ""Complete"", ""Not Complete"")))"', N'CASE WHEN Opportunity.[PSA] IS NOT NULL THEN ''Complete'' 
WHEN Opportunity.[RSA_Status__c] IS NOT NULL AND Opportunity.[RSA_Status__c] <> ''EV Not Available'' AND
Opportunity.[RSA_Status__c] <> ''Unable to ID Home'' THEN ''Complete''
WHEN Opportunity.[RSA_Status__c] = ''EV Not Available'' OR Opportunity.[RSA_Status__c] = ''Unable to ID Home'' AND
Opportunity.[PSA] IS NOT NULL THEN ''Complete'' ELSE ''Not Complete'' END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'StageNumber', N'Case - Result', N'Column', N'"if(Opportunity[LeadSource]=""Fundraising"" ,  value(Opportunity[StageNum]), blank())"', N'SUBSTRING(StageName,  PATINDEX(''%[0-9]%'', StageName),  
(CASE WHEN PATINDEX(''%[^0-9]%'', STUFF(StageName, 1, (PATINDEX(''%[0-9]%'', StageName) - 1), NULL )) = 0  
THEN LEN(StageName) ELSE (PATINDEX(''%[^0-9]%'', STUFF(StageName, 1, (PATINDEX(''%[0-9]%'', StageName) - 1), NULL))) - 1  END ))', NULL, NULL, 7, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Created_Contract_Count', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Contract_Signed__c] = 1, 1, Opportunity[Contract_Created__c])"', N'CASE WHEN Opportunity.[Contract_Signed__c] = 1 THEN 1 ELSE Opportunity.[Contract_Created__c] END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'State_Code', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[BillingStateCode], Account[Id], Opportunity[AccountId])"', N'Account.[BillingStateCode]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'State_Utility', N'Format', N'Column', N'Opportunity[Full State] & Opportunity[Utility_Company_Formula__c]', N'CONCAT(Opportunity.[State],Opportunity.[Utility_Company_Formula__c])', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Stewardship_Account_Name', N'Lookup', N'Column', N'"LOOKUPVALUE(''Stewardship Account''[Name],''Stewardship Account''[Id],Opportunity[Stewardship_Account__c])"', N'Account.[Name]', N'[Account]', N'Account.[Id]=Opportunity.[Stewardship_Account__c]', 42, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Submitted_to_Referral', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Referrals], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Referrals]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_PPA_sys_size', N'Case - Result', N'Column', N'"IF(Opportunity[? PPA]<0, (Opportunity[Sys Size Watts] * Opportunity[PPA Multiplier]) ,BLANK())"', N'CASE WHEN Opportunity.[delta_rate_PPA] < 0 THEN Opportunity.System_Size_Watts * Opportunity.[PPA_Multiplier]  ELSE NULL END', NULL, NULL, 56, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'System_Size_kW_Minus_Credit_Fails', N'Case - Result', N'Column', N'"IF(     Opportunity[Reason_Lost__c] = ""Financial - Credit Reject"",     BLANK(),     Opportunity[System_Size_kWdc__c]  )"', N'CASE WHEN Opportunity.[Reason_Lost__c] = ''Financial - Credit Reject''   THEN NULL ELSE Opportunity.[System_Size_kWdc__c] END ', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'System_Size_Watts', N'Calculation', N'Column', N'Opportunity[System_Size_kWdc__c] *1000', N'Opportunity.[System_Size_kWdc__c] *1000', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'System_Size_Watts_Minus_Credit_Fails', N'Case - Result', N'Column', N'"IF(     Opportunity[Reason_Lost__c] = ""Financial - Credit Reject"",     BLANK(),     Opportunity[System_Size_kWdc__c] * 1000 )"', N'CASE WHEN Opportunity.[Reason_Lost__c] = ''Financial - Credit Reject'' THEN NULL   ELSE Opportunity.[System_Size_kWdc__c]*1000 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Total_Points', N'Calculation', N'Column', N'Opportunity[Regular Contract Points] + Opportunity[Self Gen Contract Points] + Opportunity[Avoided Rep Control Track C]', N'Opportunity.[Points_For_Non_Self_Gen_Contract] + 
Opportunity.[Self_Gen_Contract_Points] + Opportunity.[Avoided_Rep_Control_Track_C]', NULL, NULL, 33, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trad_Above_Rate_Bonus', N'Case - Power of 1', N'Column', N'"IF(ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[CA A&B] = 0, 0,  IF(ISBLANK(Opportunity[Min Rate]), 0, IF(Opportunity[PPA_Rate_Escalator__c] <>0.029 && Opportunity[Purchase Method Group]<> ""Cash"" && Opportunity[Purchase Method Group] <> ""Loan"", 0, IF(Opportunity[Purchase Method Group] = ""Cash"" || Opportunity[Purchase Method Group] = ""Loan"" && Opportunity[Price_per_Watt__c] >= Opportunity[Min Rate], 1, IF(NOT(ISBLANK(Opportunity[Purchase Method Group])) && Opportunity[PPA_Rate__c] >= Opportunity[Min Rate], 1, 0)))))"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS  NULL THEN 0  
WHEN Opportunity.[Target_Rate] IS NULL THEN 0          
WHEN CAST(LEFT(Opportunity.[PPA_Rate_Escalator__c], LEN(Opportunity.[PPA_Rate_Escalator__c]) - 1) AS FLOAT) <>0.029 
AND Opportunity.[PM_Groups]<> ''Cash'' AND        Opportunity.[PM_Groups] <> ''Loan'' THEN 0       
WHEN Opportunity.[PM_Groups] = ''Cash'' OR        Opportunity.[PM_Groups] = ''Loan'' AND 
Opportunity.[Price_per_Watt__c] >= Opportunity.[Target_Rate] THEN 1             
WHEN Opportunity.[PM_Groups] IS NOT NULL AND  Opportunity.[PPA_Rate__c] >= Opportunity.[Target_Rate] THEN 1      
ELSE 0 END', NULL, NULL, 56, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trad_Non_Self_Gen_Points', N'Case - Power of 1', N'Column', N'"IF(Opportunity[CA A&B] = 1 && Opportunity[Real Self Gen] = 0, 1, IF(NOT(ISBLANK(Opportunity[Actual_Install_Date__c])) && Opportunity[Real Self Gen] = 0, 1, 0))"', N'CASE WHEN Opportunity.[Oppt_Contact_Self_Gen] = 0 THEN 1  
WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Oppt_Contact_Self_Gen] = 0 THEN 1 ELSE 0 END', NULL, NULL, 46, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trad_Self_Gen_Points', N'Case - Power of 1', N'Column', N'"IF(Opportunity[CA A&B] = 1 && Opportunity[Real Self Gen] = 1, 2, IF(NOT(ISBLANK(Opportunity[Actual_Install_Date__c])) && Opportunity[Real Self Gen] = 1, 2, 0))"', N'CASE WHEN Opportunity.[Oppt_Contact_Self_Gen] = 1 THEN 2  WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Oppt_Contact_Self_Gen] = 1 THEN 2 ELSE 0 END', NULL, NULL, 46, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trad_Total_Points', N'Case - Result', N'Column', N'"IF(ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[CA A&B] =0, 0, IF(Opportunity[Trad Self Gen Points] > Opportunity[Trad Non Self Gen Points], Opportunity[Trad Self Gen Points] + Opportunity[Trad Above Rate Bonus], Opportunity[Trad Non Self Gen Points] + Opportunity[Trad Above Rate Bonus]))"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NULL  THEN 0   WHEN Opportunity.[Trad_Self_Gen_Points] > Opportunity.[Trad_Non_Self_Gen_Points] THEN   Opportunity.[Trad_Self_Gen_Points] + Opportunity.[Trad_Above_Rate_Bonus] ELSE  Opportunity.[Trad_Non_Self_Gen_Points] + Opportunity.[Trad_Above_Rate_Bonus] END', NULL, NULL, 56, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Under_Rep_Control', N'Lookup', N'Column', N'RELATED(''Project Track''[Under_Rep_Control_Count__c])', N'Project_Track.[Under_Rep_Control_Count__c]', N'Project_Track', N'Project_Track.[Opportunity__c] = Opportunity.[Id]', 16, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Under_Rep_Control_Track_C', N'Calculation', N'Column', N'"CALCULATE(MAX(''Project Track''[Under_Rep_Control_Count__c]), FILTER(''Project Track'', ''Project Track''[Opportunity__c] = Opportunity[Id]))"', N'MAX(Project_Track.[Under_Rep_Control_Count__c])', N'[Project_Track]', N'Project_Track.[Opportunity__c] = Opportunity.[Id]', 13, NULL, N'Opportunity.Id', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Salesperson_User_Name', N'Calculation', N'Column', N'"CALCULATE( CALCULATE( VALUES(Contact[User]), Opportunity), USERELATIONSHIP( Contact[Id], Opportunity[Trinity_Salesperson__c]))"', N'Contact.[User]', N'[Contact]', N'Contact.[Id]=Opportunity.[Trinity_Salesperson__c]', 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Address', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[Address], Account[Id], Opportunity[AccountId])"', N'Account.[Address]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Utility_Updated', N'Case - Result', N'Column', N'"IF(Opportunity[State] = ""Massachusetts"" && SEARCH(""Eversource"", Opportunity[Utility_Company_Formula__c],, BLANK())>0, ""Eversource"", Opportunity[Utility_Company_Formula__c])"', N'CASE WHEN Opportunity.[State] = ''Massachusetts'' AND Opportunity.[Utility_Company_Formula__c]   
LIKE ''%Eversource%'' THEN ''Eversource'' ELSE Opportunity.[Utility_Company_Formula__c] END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Winback_Slicer_Opp', N'Case - Result', N'Column', N'"IF(ISBLANK(Opportunity[Win_Back_Commenced__c]),""Non Winback Project"", IF(ISBLANK(Opportunity[Res Review End]),BLANK(), IF(Opportunity[Win_Back_Commenced__c]>Opportunity[Res Review Start]&& Opportunity[Win_Back_Commenced__c]<Opportunity[Res Review End],""During Resolution"", ""Outside Resolution"")))"', N'CASE WHEN Opportunity.[Win_Back_Commenced__c] IS NULL THEN ''Non Winback Project''
WHEN Opportunity.[Resolution_Review_End] IS NULL THEN NULL
WHEN Opportunity.[Win_Back_Commenced__c] > Opportunity.[Resolution_Review_Start] AND Opportunity.[Win_Back_Commenced__c] < Opportunity.[Resolution_Review_End]
THEN ''During Resolution'' ELSE ''Outside Resolution'' END', NULL, NULL, 60, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_CPPW_Floor', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Final Floor])) && NOT(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])),Opportunity[Commissionable_Price_Per_Watt__c] - Opportunity[Final Floor], BLANK())"', N'CASE WHEN Opportunity.[Target_Floor] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL  
THEN Opportunity.[Commissionable_Price_Per_Watt__c] - Opportunity.[Target_Floor] ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_CPPW_Minimum', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Final Minimum])) && NOT(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])),Opportunity[Commissionable_Price_Per_Watt__c] - Opportunity[Final Minimum],BLANK())"', N'CASE WHEN Opportunity.[Target_Minimum] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL  
THEN Opportunity.[Commissionable_Price_Per_Watt__c] - Opportunity.[Target_Minimum] ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_rate_PPA', N'Case - Result', N'Column', N'"If(not(ISBLANK(Opportunity[Final Rate])) && NOT(ISBLANK(Opportunity[PPA_Rate__c])),Opportunity[PPA_Rate__c] - Opportunity[Final Rate], BLANK())"', N'CASE WHEN Opportunity.[Target_Rate] IS NOT NULL AND Opportunity.[PPA_Rate__c] IS NOT NULL
THEN Opportunity.[PPA_Rate__c] - Opportunity.[Target_Rate] ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_CPPW_Cash', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Final Cash])) && NOT(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])),Opportunity[Commissionable_Price_Per_Watt__c] - Opportunity[Final Cash], BLANK())"', N'CASE WHEN Opportunity.[Target_Cash] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c]
IS NOT NULL THEN Opportunity.[Commissionable_Price_Per_Watt__c] - Opportunity.[Target_Cash] ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_CPPW_Loan', N'Case - Result', N'Column', N'"if(not(ISBLANK(Opportunity[Final Loan])) && NOT(ISBLANK(Opportunity[Commissionable_Price_Per_Watt__c])),Opportunity[Commissionable_Price_Per_Watt__c] - Opportunity[Final Loan], BLANK())"', N'CASE WHEN Opportunity.[Target_Loan] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL  
THEN Opportunity.[Commissionable_Price_Per_Watt__c] - Opportunity.[Target_Loan] ELSE NULL END', NULL, NULL, 47, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG C EPC', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([# Commissionable Amount], [# System Size] * 1000, 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# Avg Commissionable Amount', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Commissionable_Amount__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ESC', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate_Escalator__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ESC', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Gross Amount], [# System Size] * 1000, 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG PPA', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ? Cash', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[? Starting Cash]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ? Floor', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[? Floor]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ? Loan', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[? Starting Loan]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ? Min', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[? Minimum]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# AVG ? PPA', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[? PPA]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# C EPC', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[Commissionable_Price_Per_Watt__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# Commissionable Amount', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[Commissionable_Amount__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# ESC', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[PPA_Rate_Escalator__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# G EPC', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[Price_per_Watt__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# PPA', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[PPA_Rate__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# Ratio', N'Divide', N'Measure', N'"CALCULATE(if([#Total Contracts]>0,[#TotalInstalls]/[#Total Contracts],Blank()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'# System Size', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Above %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Deals Above Rate or EPC], [#Above Eligible], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Above Eligible', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, NOT(ISBLANK(Opportunity[Above]))), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Appointment Ran', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appointment_Completed__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Appt Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Appts Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appointment_Completed__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Appts Scheduled', N'Count', N'Measure', N'"CALCULATE(COUNTROWS(Opportunity), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Average Contracts / Day', N'Divide', N'Measure', N'"round([#Total Contract LB] /  [Total selling days Current] ,0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Average PPA', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Amount', N'Average', N'Measure', N'AVERAGE(Opportunity[Amount])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg C EPC Contract', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Comm Amount Contract], [#Sys Size Contract] * 1000, 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg C EPC Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Comm Amount Install], [#Sys Size Install] * 1000, 0)+0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg C EPC PTO', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Comm Amount PTO], [#Sys Size PTO] * 1000, 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Days Complete to PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Days to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Days to Install', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Days to Install]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg EPC Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Gross Amount Install], [#Sys Size Install] * 1000, 0)+0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg EPC PTO', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Gross Amount PTO], [#Sys Size PTO] * 1000, 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Escalator Contract', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate_Escalator__c]), FILTER(Opportunity, Opportunity[Contract Signed -CF] = 1), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Escalator Install', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate_Escalator__c]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Escalator PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate_Escalator__c]), USERELATIONSHIP(Opportunity[Date_Interconn_Approved__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg G EPC Contract', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Gross Amount Contract], [#Sys Size Contract] * 1000, 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Mult', N'Average', N'Measure', N'AVERAGE(Opportunity[Estimated_Multiplier__c])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg PPW', N'Average', N'Measure', N'AVERAGE(Opportunity[Price_per_Watt__c])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Rate', N'Average', N'Measure', N'AVERAGE(Opportunity[PPA_Rate__c])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Rate Contract', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate__c]), FILTER(Opportunity, Opportunity[Contract Signed -CF] = 1), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Rate Install', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate__c]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Rate PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[PPA_Rate__c]), USERELATIONSHIP(Opportunity[Date_Interconn_Approved__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Sys Size Contract', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[System_Size_kWdc__c]), FILTER(Opportunity, Opportunity[Contract Signed -CF] = 1), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Sys Size Installs', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[System_Size_kWdc__c]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg Sys Size PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[System_Size_kWdc__c]), USERELATIONSHIP(Opportunity[Date_Interconn_Approved__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg System Size', N'Average', N'Measure', N'AVERAGE(Opportunity[System_Size_kWdc__c])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg System Size', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[System_Size_kWdc__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avg System Size Watts', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[System_Size_kWdc__c]) * 1000,USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avoided Rep Control', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Avoided Rep Control Track C]), FILTER(Opportunity, Opportunity[Avoided Rep Control Track C] > 0), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Avoided Rep Control Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Avoided Rep Control Track C]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Balance Days', N'Case', N'Measure', N'"if( [#Total Selling Days] - [Total selling days Current] < 0, 0, [#Total Selling Days] - [Total selling days Current])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Bonus Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Trad Above Rate Bonus])+0, USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Sales_Office__c (groups)], ''Trad Offices''[Offices]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Chained Close', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Chained Contracts], [#Distinct Appts Ran], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Close Ratio LOI Contract Created', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#LOI Contract Signed],[#LOI''s Contracts],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Comm Amount', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Commissionable Amount Minus Credit Fails]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Comm Amount Install', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Commissionable_Amount__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Comm Amount PTO', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Commissionable_Amount__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Comm PPW Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Comm Amount], [#System Size Watts], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Completed Installs', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Completed Scheduled Diff Day', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Install Scheduled-Completed] = 0), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Completed Scheduled Same Day', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Install Scheduled-Completed] = 1), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Growth MTD', N'Subtract', N'Measure', N'[#Contract Signed w/Install MTD] - [#Contract Signed w/Install LM]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Growth QTD', N'Subtract', N'Measure', N'[#Contract Signed w/Install QTD] - [#Contract Signed w/Install LQ]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Growth YTD', N'Subtract', N'Measure', N'[#Contract Signed w/Install YTD] - [#Contract Signed w/Install LY]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract or Install', N'Case', N'Measure', N'"IF([#Total Contracts] = 1 || [#TotalInstalls] = 1, 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install LM', N'Sum', N'Measure', N'"CALCULATE([#Contract Signed w/Install MTD],PREVIOUSMONTH(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install LQ', N'Sum', N'Measure', N'"CALCULATE([#Contract Signed w/Install QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install LY', N'Sum', N'Measure', N'"CALCULATE([#Contract Signed w/Install YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install MTD', N'Sum', N'Measure', N'"TOTALMTD([#Contract Signed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install QTD', N'Sum', N'Measure', N'"TOTALQTD([#Contract Signed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed w/Install YTD', N'Sum', N'Measure', N'"TOTALYTD([#Contract Signed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract Signed_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" )', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[Date_Contract_Signed__c]) && not isblank(Opportunity[Actual_Install_Date__c])),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract to PTO Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Contract Signed to PTO Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract w/Install Date Ratio_LB', N'Divide', N'Measure', N'[#Installs Scheduled_LB] / [#Contract Signed_LB] ', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contract-Install Scheduled%', N'Divide', N'Measure', N'"ROUND(DIVIDE([#Installs Scheduled],[#Contracts Signed],0),2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts Signed Original Project Track', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts - CF]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts Signed Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract Signed -CF]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts Signed OPT A', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts - CF]), FILTER(''Project Track'', ''Project Track''[Original Track A] =1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts Signed OPT B', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts - CF]), FILTER(''Project Track'', ''Project Track''[Original Track B] =1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts Signed OPT C', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts - CF]), FILTER(''Project Track'', ''Project Track''[Original Track C] =1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts w RSA Completed After Appt', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract Signed -CF]), FILTER(Opportunity, Opportunity[Completed Before DToFA] = 0), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts w RSA Completed Before Appt', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract Signed -CF]), FILTER(Opportunity, Opportunity[Completed Before DToFA] = 1), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts with Install Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Contracts with Install Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install Scheduled -CF]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Count of Sales Reps', N'Distinct Count', N'Measure', N'"Calculate(DISTINCTCOUNT(Opportunity[Trinity_Salesperson__c]), FILTER(Opportunity, Opportunity[Contracts -CF] = 1), USERELATIONSHIP(''Date''[Date],Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Count Track C', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Count Track C]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Sales_Office__c (groups)], ''Trad Offices''[Offices]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Call Opps', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, not ISBLANK(Opportunity[Opp From Calls])), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], Opportunity[Call Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Close Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Opps Contracts], [#COVID Calls Opps Demos Completed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Contracts', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract_Signed__c]), FILTER(Opportunity, not ISBLANK(Opportunity[Opp From Calls])), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], Opportunity[Call Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Demos Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appt_Completed__c]), FILTER(Opportunity, not ISBLANK(Opportunity[Opp From Calls])), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], Opportunity[Call Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Demos Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Demo Scheduled]), FILTER(Opportunity, not ISBLANK(Opportunity[Opp From Calls])), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], Opportunity[Call Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Install Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Opps Contracts w Install], [#COVID Calls Opps Contracts], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Install Started', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Actual_Install_Date__c] <= TODAY() && not ISBLANK(Opportunity[Actual_Install_Date__c])), FILTER(Opportunity, not ISBLANK(Opportunity[Opp From Calls])), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], Opportunity[Call Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps to Demo Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Opps Total Demos], [#COVID Call Opps],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Calls Opps Total Demos', N'Sum', N'Measure', N'[#COVID Calls Opps Demos Scheduled] + [#COVID Calls Opps Demos Completed] +0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Email Close Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Email Contracts Signed],[#COVID Email Demos Completed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Email Contracts Signed', N'Sum', N'Measure', N'"(CALCULATE(SUM(Opportunity[Contract_Signed__c]), FILTER(''Lead'', not ISBLANK(''Lead''[Total Email Leads])),USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Email Installs Started', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Actual_Install_Date__c] <=TODAY() && not ISBLANK(Opportunity[Actual_Install_Date__c])), FILTER(''Lead'', NOT(ISBLANK(''Lead''[Total Email Leads]))), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Has_Contact_Phone', N'Case - Power of 1', N'Column', N'"IF(AND(not ISBLANK(Opportunity[Contact Phone]), NOT(Opportunity[Contact Phone] = ""N/A"")), 1, 0)"', N'CASE WHEN Opportunity.[Contact_Phone] IS NOT NULL AND Opportunity.[Contact_Phone]<>''N/A'' THEN 1 ELSE 0 END
', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Email Lead to Demo Conversion', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Email Total Demos],[#Total Email Leads Converted],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#COVID Email Total Demos', N'Sum', N'Measure', N'"CALCULATE([#COVID Email Demos Scheduled] + [#COVID Email Demos Completed], USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Current Month', N'Format', N'Measure', N'month(TODAY())', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Current Year', N'Format', N'Measure', N'YEAR(TODAY())', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Complete to PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Complete to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Contract to Install Scheduled', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Contract to Install]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Contract to Install Scheduled by Completed Date', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Contract to Install]), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Install Scheduled to Completed', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Install to Complete]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Scheduled to PTO', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Scheduled to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Since Last Install', N'Subtract', N'Measure', N'"CALCULATE(DATEDIFF([#Last Install], [#Latest Date],DAY)+0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Days Since Last Sale', N'Subtract', N'Measure', N'"CALCULATE(DATEDIFF([#Last Sale], [#Latest Date],DAY)+0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Deals Above Rate or EPC', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Above]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demo-Contract%', N'Divide', N'Measure', N'"ROUND(DIVIDE(Opportunity[#Contracts Signed],Opportunity[#Demos Completed],0),2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed', N'Count', N'Measure', N'"CALCULATE( count(''Opportunity''[Id]), FILTER(''Opportunity'', ''Opportunity''[LeadSource] = ""Fundraising"" && not ISBLANK(''Opportunity''[Event_Name__c]) && ''Opportunity''[Appt_Completed__c]>=1),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Demo_date_c_us]),USERELATIONSHIP(''Opportunity''[Event_Name__c],''Stewardship Account''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed LM MTD', N'Sum', N'Measure', N'"CALCULATE([#Demos Completed MTD],PREVIOUSMONTH(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed LQ QTD', N'Sum', N'Measure', N'"CALCULATE([#Demos Completed QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed LW WTD', N'Sum', N'Measure', N'"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var CurrentDate= LASTDATE(dateadd(Date_dimension[FullDate], -7, DAY))', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var DayNumberOfWeek=WEEKDAY(LASTDATE(Date_dimension[FullDate]))', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'return', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'CALCULATE(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    [#Demos Completed_LB],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATESBETWEEN(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    Date_dimension[FullDate],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATEADD(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed', N'Count', N'Measure', N'"CALCULATE( count(''Opportunity''[Id]), FILTER(''Opportunity'',''Opportunity''[Appt_Completed__c]>=1),filter(''Opportunity'', not SEARCH(""none"",Opportunity[Name],,Blank()) && Opportunity[Name] <> ""test"" && Opportunity[Name] <> ""submit"" && Opportunity[Name] <> ""lead"" && Opportunity[Name] <> ""contact""),USERELATIONSHIP(''Date_dimension''[FullDate],Opportunity[Created Date format]),USERELATIONSHIP(Opportunity[Stewardship_Account__c],''Stewardship Account''[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    -7*DayNumberOfWeek,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    DAY),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed LY YTD', N'Sum', N'Measure', N'"CALCULATE([#Demos Completed YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed MTD', N'Sum', N'Measure', N'"TOTALMTD([#Demos Completed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed PW WTD', N'Sum', N'Measure', N'"var CurrentDate= LASTDATE(dateadd(Date_dimension[FullDate], -7, DAY))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var DayNumberOfWeek=WEEKDAY(LASTDATE(Date_dimension[FullDate]),1)', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'return', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'CALCULATE(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    [#Demos Completed_LB],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATESBETWEEN(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    Date_dimension[FullDate],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATEADD(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    -1*DayNumberOfWeek,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    DAY),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed QTD', N'Sum', N'Measure', N'"TOTALQTD([#Demos Completed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed WTD', N'Sum', N'Measure', N'"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var CurrentDate=LASTDATE(Date_dimension[FullDate])', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var DayNumberOfWeek=WEEKDAY(CurrentDate)', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'return', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'CALCULATE(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    [#Demos Completed_LB],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATESBETWEEN(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    Date_dimension[FullDate],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATEADD(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    -7*DayNumberOfWeek,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    DAY),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed WTD', N'Sum', N'Measure', N'"var CurrentDate=LASTDATE(Date_dimension[FullDate])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'var DayNumberOfWeek=WEEKDAY(LASTDATE(Date_dimension[FullDate]))', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'return', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'CALCULATE(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    [#Demos Completed_LB],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATESBETWEEN(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    Date_dimension[FullDate],', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'DATEADD(', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    -1*DayNumberOfWeek,', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    DAY),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'    CurrentDate))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed YTD', N'Sum', N'Measure', N'"TOTALYTD([#Demos Completed_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" )', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[DemoDate]) ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not isblank(Opportunity[Lead_Generator__c])', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&&''Opportunity''[DemoDate]<=TODAY()),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[DemoDate]),USERELATIONSHIP(Contact[User_Id__c],User[Id])', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N')"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Completed_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" )', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[Date_of_First_Appt__c]) ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&&''Opportunity''[Date_of_First_Appt__c]<=TODAY()),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_of_First_Appt__c]))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Demos Growth MTD', N'Subtract', N'Measure', N'[#Demos Completed MTD] - [#Demos Completed LM MTD]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Direct Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Direct Points])+0, USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Direct Offices (groups)], ''Direct Offices''[Office]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Direct Points Multiplied', N'Multiply', N'Measure', N'CALCULATE([#Direct Points] * [#Direct Multiplier])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Direct Sales Office Ranking', N'Rank', N'Measure', N'"IF(HASONEVALUE(''Direct Offices''[Office]) = BLANK(), BLANK(), RANKX(ALLSELECTED(''Direct Offices''[Office]),[#Direct Points Multiplied],,DESC,Dense))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Direct Sales Rep Ranking', N'Rank', N'Measure', N'"IF(HASONEVALUE(Contact[Name]) = BLANK(), BLANK(), RANKX(ALLSELECTED(Contact[Name]),[#Direct Points],,DESC,Dense))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Distinct Appts', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appointment_Completed__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Distinct LOI''s Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[LOI_Signed__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_LOI_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Gross Amount', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Amount]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Gross Amount', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Amount Minus Credit Fails]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Gross Amount Install', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Amount]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Gross Amount PTO', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Amount]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Gross PPW Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Gross Amount], [#System Size Watts], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled by Date Contract Signed OPT A', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'', ''Project Track''[Original Track A] = 1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled by Date Contract Signed OPT B', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'', ''Project Track''[Original Track B] = 1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Complete to PTO Actual Text', N'Format', N'Measure', N'"var vSeconds=[#PTO Actual Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Complete to PTO Business Text', N'Format', N'Measure', N'"var vSeconds=[#PTO Business Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Completed Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Completed Installs], [#Install Scheduled Opp], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Pull Through', N'Divide', N'Measure', N'"ROUND(CALCULATE(DIVIDE([#Installs Scheduled]+[#Installs Completed],[#Contracts Signed])),2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Schedule Completed%', N'Divide', N'Measure', N'"ROUND(DIVIDE([#Installs Completed],[#Installs Scheduled],0)/100,2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Scheduled Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Scheduled Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Scheduled_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS( ''Opportunity'',[name],""Reinstall"",[Name] ,""R&R"") && Not ISBLANK(Opportunity[Date_Contract_Signed__c]) && Not ISBLANK(Opportunity[Actual_Install_Date__c])),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Actual Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual Days Contract to Install]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Contract to Install]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Growth MTD', N'Subtract', N'Measure', N'[#Total Install Started MTD] - [#Total Install Started LM]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Growth QTD', N'Subtract', N'Measure', N'[#Total Install Started QTD] - [#Total Install Started LQ]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Growth YTD', N'Subtract', N'Measure', N'[#Total Install Started YTD] - [#Total Install Started LY]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Ops Responsible', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'',''Project Track''[Under_Rep_Control_Count__c]=0),FILTER(''Project Track'',''Project Track''[Track__c]=""C""), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE())) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Ops Responsible Actual Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual Days Contract to Install]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'',''Project Track''[Ops Responsible Installs] =1)) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Ops Responsible Added Days', N'Case', N'Measure', N'"IF([#Install Started Ops Responsible Actual Days] = 0, BLANK(), CALCULATE([#Install Started Ops Responsible Actual Days]-[#Install Started Track A&B Actual Days]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Rep Control', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Under_Rep_Control_Count__c]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'',''Project Track''[Under_Rep_Control_Count__c]=1), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE())) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Rep Control Actual Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual Days Contract to Install]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'', ''Project Track''[Rep Control Added Days] = 1)) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Rep Control Added Days', N'Case', N'Measure', N'"IF([#Install Started Rep Control Actual Days] = 0, BLANK(), CALCULATE([#Install Started Rep Control Actual Days]-([#Install Started Track A&B Actual Days])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Track A&B', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'',''Project Track''[Track__c]<>""C""),FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE())) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Track A&B Actual Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual Days Contract to Install]), FILTER(''Project Track'', ''Project Track''[A&B timeline  not rep control] = 1), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Install Started Track C', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]), FILTER(''Project Track'',''Project Track''[Track__c]=""C""),FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE())) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Completed Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install Completed]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs PTO', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, not ISBLANK(Opportunity[Date_Interconn_Approved__c])), USERELATIONSHIP(Opportunity[Date_Interconn_Approved__c], ''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs PTO''d', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(Opportunity[Date_Interconn_Approved__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled by Date Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Completed', N'Count', N'Measure', N'"CALCULATE( count(''Opportunity''[Id]), FILTER(''Opportunity'', ''Opportunity''[LeadSource] = ""Fundraising"" && not ISBLANK(''Opportunity''[Event_Name__c]) &&  not ISBLANK(''Opportunity''[Actual_Install_Date__c])&&(''Opportunity''[StageNumber]>7)),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Actual_Install_Date__c]),USERELATIONSHIP(''Opportunity''[Event_Name__c],''Stewardship Account''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Completed', N'Count', N'Measure', N'"CALCULATE( count(''Opportunity''[Id]), FILTER(''Opportunity'',Opportunity[Install_Scheduled__c] =1 &&(''Opportunity''[StageNumber]>7)), filter(''Opportunity'', not SEARCH(""none"",Opportunity[Name],,Blank()) && Opportunity[Name] <> ""test"" && Opportunity[Name] <> ""submit"" && Opportunity[Name] <> ""lead"" && Opportunity[Name] <> ""contact""),USERELATIONSHIP(''Date_dimension''[FullDate],Opportunity[Created Date format]),USERELATIONSHIP(Opportunity[Stewardship_Account__c],''Stewardship Account''[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled by Date Contract Signed OPT C', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'', ''Project Track''[Original Track C] = 1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled Ops Responsible', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'',''Project Track''[Ops Responsible Installs] =1), USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled Rep Control', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), FILTER(''Project Track'', ''Project Track''[Rep Control Added Days] =1), USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Scheduled_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS( ''Opportunity'',[name],""Reinstall"",[Name] ,""R&R"") && Not ISBLANK(Opportunity[Date_Contract_Signed__c]) && Not ISBLANK(Opportunity[Actual_Install_Date__c])),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Started Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Started__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Installs Started_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" ) && Not ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[Actual_Install_Date__c] <= TODAY()) ,USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Actual_Install_Date__c]),USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#kW Installed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Complete_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Last Install', N'Date', N'Measure', N'"CALCULATE(MAX(Opportunity[Actual_Install_Date__c]), FILTER(Opportunity, [#Latest Date] >= Opportunity[Actual_Install_Date__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Last Sale', N'Date', N'Measure', N'"CALCULATE(MAX(Opportunity[Date_Contract_Signed__c]), FILTER(Opportunity, [#Latest Date] >= Opportunity[Date_Contract_Signed__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Latest Date', N'Date', N'Measure', N'"CALCULATE(MIN(TODAY(), MAX(''Date''[Date])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Lead-Demo%', N'Divide', N'Measure', N'"ROUND(DIVIDE(Opportunity[#Demos Completed],''Lead''[#Leads Submitted],0),2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#LOI Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract Signed -CF]), USERELATIONSHIP(''Date''[Date],''Opportunity''[Date_LOI_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#LOI Installs Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Install_Scheduled__c]), USERELATIONSHIP(''Date''[Date],''Opportunity''[Date_LOI_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#LOI Not Updated', N'Subtract', N'Measure', N'"MAX([#Distinct LOI''s] - [#LOI Contracts In Process] - [#LOI DQ Contracts Created] - [#LOI''s Contracts], 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#LOI Sit %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Appointments], [#Distinct LOI''s], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#LOI''s Contracts', N'Sum', N'Measure', N'"CALCULATE(SUM(''Opportunity''[LOI Signed and Contract Created]), USERELATIONSHIP(''Date''[Date], ''Opportunity''[Date_LOI_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Opps', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(''Date''[Date], Opportunity[Created Date w/ DST]), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed LM MTD', N'Sum', N'Measure', N'"CALCULATE([#Outreach Contract Signed MTD],PREVIOUSMONTH(Date_dimension[FullDate]) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed LQ QTD', N'Sum', N'Measure', N'"CALCULATE([#Outreach Contract Signed QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed LY YTD', N'Sum', N'Measure', N'"CALCULATE([#Outreach Contract Signed YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed MTD', N'Sum', N'Measure', N'"TOTALMTD([#Outreach Contracts Signed],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed QTD', N'Sum', N'Measure', N'"TOTALQTD([#Outreach Contracts Signed],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contract Signed YTD', N'Sum', N'Measure', N'"TOTALYTD([#Outreach Contracts Signed],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Contracts Signed', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not CONTAINS( Opportunity,[Name], ""Reinstall"",[Name], ""R&R"")  && not isblank(Opportunity[Lead_Generator__c])', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[Date_Contract_Signed__c]))', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N', USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]),USERELATIONSHIP(''Opportunity''[Trinity_Salesperson__c],Contact[Id]),USERELATIONSHIP(Contact[User_Id__c],User[Id])', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N')"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Outreach Demos Completed LY YTD', N'Sum', N'Measure', N'"TOTALYTD([#Outreach Demos Completed YTD],', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'PREVIOUSYEAR(Date_dimension[FullDate]))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Pallet Project] = 1), FILTER(''Action Item'', ''Action Item''[AI Pallet] = 1))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet $', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Amount]), FILTER(Opportunity, Opportunity[Pallet Project] = 1), FILTER(''Action Item'', ''Action Item''[AI Pallet] = 1))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet $ Both Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet $], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Both""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet $ Ops Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet $], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Operations""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet $ Sales Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet $], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Rep""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet Both Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Both""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet kW', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]), FILTER(Opportunity, Opportunity[Pallet Project] = 1), FILTER(''Action Item'', ''Action Item''[AI Pallet] = 1))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet kW Both Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet kW], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Both""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet kW Ops Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet kW], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Operations""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet kW Sales Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet kW], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Rep""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet mW', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]), FILTER(Opportunity, Opportunity[Pallet Project] = 1), FILTER(''Action Item'', ''Action Item''[AI Pallet] = 1)) /1000"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet Ops Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Operations""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pallet Sales Responsible', N'Sum', N'Measure', N'"CALCULATE([#Pallet], FILTER(''Project Track'', ''Project Track''[Responsible_Party__c] = ""Rep""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Points per Rep', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Points by Contact], [#Active Tradtional Headcount], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Projects Submitted Install Started', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PT Contract Signed to Submitted on PTO Date', N'N/A', N'Measure', N'""""""', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PTO Actual Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual Days Install Complete to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PTO Actual Seconds', N'Multiply', N'Measure', N'CALCULATE([#PTO Actual Days]*86400)', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PTO Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Install Complete to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PTO Business Seconds', N'Multiply', N'Measure', N'CALCULATE([#PTO Business Days]*86400)', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#PTO Projects', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), USERELATIONSHIP(''Date''[Date],Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Installs Scheduled by Date Contract Signed], [#Contracts Signed], 0), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through LOI', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#LOI Installs Scheduled], [#LOI Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through Opportunity', N'Divide', N'Measure', N'"DIVIDE([#Contracts with Install Opp],[#Contracts Signed Opp],0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through OPT A', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Installs Scheduled by Date Contract Signed OPT A], [#Contracts Signed OPT A], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through OPT B', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Installs Scheduled by Date Contract Signed OPT B], [#Contracts Signed OPT B], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Pull Through OPT C', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Installs Scheduled by Date Contract Signed OPT C], [#Contracts Signed OPT C], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rank', N'Rank', N'Measure', N'"IF(HASONEVALUE(''Sales Reps''[Name]) = BLANK(), BLANK(), RANKX(ALLSELECTED(''Sales Reps''[Name]), [#Total Points],,DESC,Dense))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rank_Contracts', N'Rank', N'Measure', N'"RANKX(ALLSELECTED (Opportunity[User Name]),Opportunity[#Self Gen Contracts_LB],,DESC,Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rank_Demos_LB', N'Rank', N'Measure', N'"RANKX(ALLSELECTED (Opportunity[User Name]),Opportunity[#Demos Completed_LB],,DESC,Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rank_Install_Scheduled_LB', N'Rank', N'Measure', N'"RANKX(ALLSELECTED (Opportunity[User Name]),Opportunity[#Installs Scheduled_LB],,DESC,Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rank_Installs_Started_LB', N'Rank', N'Measure', N'"RANKX(ALLSELECTED (Opportunity[User Name]),Opportunity[#Installs Started_LB],,DESC,Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Avg PPW', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral G Amount], [#Referral Watts], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Contracts Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Primary Contacts''[Referred Contracts]), USERELATIONSHIP(''Primary Contacts''[Primary_Contact__c], Opportunity[Primary_Contact__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Installs Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Primary Contacts''[Referred Installs Completed]), USERELATIONSHIP(''Primary Contacts''[Primary_Contact__c], Opportunity[Primary_Contact__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Installs Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(''Primary Contacts''[Referred Installs Scheduled]), USERELATIONSHIP(''Primary Contacts''[Primary_Contact__c], Opportunity[Primary_Contact__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]), USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Pull Through', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Installs Scheduled], [#Referral Contracts Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referral Target', N'Static Value', N'Measure', N'0.25', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referrer %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referrers by install date], [#Install Scheduled Opp], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Regular Contracts', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Regular Contract Points]), FILTER(Opportunity, Opportunity[Regular Contract Points] > 0),USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Referrers by install date', N'Count', N'Measure', N'"CALCULATE(COUNT(''Primary Contacts''[Primary_Contact__c]), FILTER(''Primary Contacts'', ''Primary Contacts''[Total Referrals] > 0), USERELATIONSHIP(''Primary Contacts''[Primary_Contact__c], Opportunity[Primary_Contact__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]) , USERELATIONSHIP(Contact[Id], Opportunity[Trinity_Salesperson__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Regular Contracts Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Regular Contract Points]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Regular Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Trad Non Self Gen Points])+0, USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Sales_Office__c (groups)], ''Trad Offices''[Offices]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Rep Control % Install Started', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Rep Control Count Install Started], [#Projects Submitted Install Started], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Reps w/ LOI''s or Appt Ran', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNTNOBLANK(Contact[Name]), FILTER(Contact, [#Distinct LOI''s Signed] > 0 || [#Distinct Appts Ran] > 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#RSA Completed %', N'Divide', N'Measure', N'"DIVIDE([#RSAs Completed Before Appt], [#RSAs Requested Before Appt], 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#RSAs Completed Before Appt', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Completed Before DToFA]), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#RSAs Requested Before Appt', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Requested Before DToFA]), USERELATIONSHIP(''Date''[Date], Opportunity[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sales $ Pallet Project', N'Sum', N'Measure', N'[#Pallet $ Both Responsible] + [#Pallet $ Sales Responsible] +0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sales kW Pallet Project', N'Sum', N'Measure', N'[#Pallet kW Both Responsible] + [#Pallet kW Sales Responsible]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sales Pallet Project', N'Sum', N'Measure', N'[#Pallet Both Responsible] + [#Pallet Sales Responsible] +0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sales Rep Ranking', N'Rank', N'Measure', N'"IF(HASONEVALUE(Contact[Name]) = BLANK(), BLANK(), RANKX(ALLSELECTED(Contact[Name]),[#Total Points by Contact],,DESC,Dense))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Scheduled Completed Diff Day', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Install Scheduled-Completed] = 0), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Scheduled Completed PTO''d', N'Case', N'Measure', N'"IF(OR([Installs Scheduled] = 1, OR([Installs Completed] = 1, [#Installs PTO] = 1)), 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Scheduled Completed Same Day', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, Opportunity[Install Scheduled-Completed] = 1), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Scheduled Not Completed', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]), FILTER(Opportunity, ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Scheduled to Completed Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Installs Completed Scheduled], [#Install Scheduled Opp], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Self Gen Contract Points]), FILTER(Opportunity, Opportunity[Self Gen Contract Points] > 0), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract - Install Date Ratio_LB', N'Divide', N'Measure', N'[#Self Gen Contracts with Install Date_LB] / [#Self Gen Contracts_LB]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract Growth MTD', N'Subtract', N'Measure', N'[#Self Gen Contract w/Install MTD] - [#Self Gen Contract w/Install LM]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract Growth QTD', N'Subtract', N'Measure', N'[#Self Gen Contract w/Install QTD] - [#Self Gen Contract w/Install LQ]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract Growth YTD', N'Subtract', N'Measure', N'[#Self Gen Contract w/Install YTD] - [#Self Gen Contract w/Install LY]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install Date_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" ) && Not ISBLANK(Opportunity[Date_Contract_Signed__c]) && Not ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[Self_Gen__c] = 1),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install LM', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Contract w/Install MTD],PREVIOUSMONTH(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install LQ', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Contract w/Install QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install LY', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Contract w/Install YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install MTD', N'Sum', N'Measure', N'"TOTALMTD([#Self Gen Contracts_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install QTD', N'Sum', N'Measure', N'"TOTALQTD([#Self Gen Contracts_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contract w/Install YTD', N'Sum', N'Measure', N'"TOTALYTD([#Self Gen Contracts_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contracts with Install Date_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" ) && Not ISBLANK(Opportunity[Date_Contract_Signed__c]) && Not ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[Self_Gen__c] = 1),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline PC Biz Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Contracts Resolutions Review to Install seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Resolution Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Resolutions Start to End]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review""), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Resolution Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Resolutions Start to End in seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Sales Biz Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Contract Signed to Submitted]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Contracts_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" && not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" )&& Not ISBLANK(''Opportunity''[Date_Contract_Signed__c]  )&& not ISBLANK(Opportunity[Actual_Install_Date__c]) &&''Opportunity''[Self_Gen__c] = 1),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]),USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install Growth MTD', N'Subtract', N'Measure', N'[#Self Gen Install MTD] - [#Self Gen Install LM]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install Growth QTD', N'Subtract', N'Measure', N'[#Self Gen Install QTD] - [#Self Gen Install  LQ]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install Growth YTD', N'Subtract', N'Measure', N'[#Self Gen Install Started YTD] - [#Self Gen Install LY]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install LM', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Install MTD],PREVIOUSMONTH(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install LQ', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Install QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install LY', N'Sum', N'Measure', N'"CALCULATE([#Self Gen Install Started YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install MTD', N'Sum', N'Measure', N'"TOTALMTD([#Self Gen Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install QTD', N'Sum', N'Measure', N'"TOTALQTD([#Self Gen Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Install Started YTD', N'Sum', N'Measure', N'"TOTALYTD([#Self Gen Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Installs Started_LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow"" ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& not CONTAINS(Opportunity,[Name], ""Reinstall"",[Name],""R&R"" )', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[Actual_Install_Date__c]) ', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&&''Opportunity''[Actual_Install_Date__c]<=Today()', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&&''Opportunity''[Self_Gen__c]=1),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Actual_Install_Date__c]),USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Self Gen Contract Points]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Self Gen Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Trad Self Gen Points])+0, USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Sales_Office__c (groups)], ''Trad Offices''[Offices]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#SGR %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#SGR Contracts Signed Opp], [#Contracts Signed Opp], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#SGR Contracts Signed Opp', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[SGR Contract -CF]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#States Covered Closed Date', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Opportunity[State]), FILTER(''Project Track'',[#Resolved Track C Projects Closed Date]>0), USERELATIONSHIP(''Project Track''[Closed_Date__c],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#States Covered Created Date', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Opportunity[State]), FILTER(''Project Track'',[#Projects Tracked Created Date]>0), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sys Size Contract', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size Minus Credit Fails]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sys Size Install', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Sys Size PTO', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[System_Size_kWdc__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#System Size Watts', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size Watts]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Contract Signed to PTO Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Contract to PTO]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Contract Signed to PTO Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Contract to PTO seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Install Complete to PTO Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Install to PTO Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Install Started to Completed Biz Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Installs Started to Completed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Install Started to Completed Biz Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Installs Started to Completed seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Install to PTO Biz Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Business Days Install Complete to PTO])*86400, USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Partner Solutions Biz Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days Contract Submitted to Resolutions Review]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review""), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Partner Solutions Biz Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Contracts Submitted to Resolutions Review seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline PC Biz Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days Resolutions Review End to Install]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review""), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Install Started to Install Complete Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Install Started to Completed Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Operations Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline PC Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Partner Solutions Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Partner Solutions Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Resolutions Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Resolution Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Sales Biz Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Signed to Submitted seconds]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Interconn_Approved__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Timeline Sales Biz Text', N'Format', N'Measure', N'"var vSeconds=[#Timeline Sales Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vDays)=0,   vRemainingHours&"" Hours."",   vDays&"" Days, ""&   vRemainingHours&"" Hours."")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Today_Date', N'Format', N'Measure', N'"format(NOW(),""dd/mm/yyyy"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Appointments', N'Sum', N'Measure', N'[#Total Appointments Scheduled] + [#Total Appointments Ran]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Appointments Ran', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appointment_Completed__c]), FILTER(''Direct Lead'',''Direct Lead''[LOI Signed]=1),USERELATIONSHIP(''Direct Lead''[Opportunity__c], Opportunity[Id]), USERELATIONSHIP(''Direct Lead''[Date_LOI_Signed__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Appointments Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Demo Scheduled]), FILTER(''Direct Lead'', ''Direct Lead''[LOI Signed]=1), USERELATIONSHIP(''Direct Lead''[Opportunity__c], Opportunity[Id]), USERELATIONSHIP(''Direct Lead''[Date_LOI_Signed__c], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Contract LB', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'FILTER(''Opportunity'',''Opportunity''[RecordType.Name]=""Solar - Oppty Flow""  && (Opportunity[StageNum] <> ""11"")', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'&& Not ISBLANK(Opportunity[Date_Contract_Signed__c])),', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[User_Id__c], User[Id]))"', N'', N'', N'', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Contract Signed MTD', N'Sum', N'Measure', N'"TOTALMTD([#Total Contracts],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Contract Signed w/Install QTD', N'Sum', N'Measure', N'"TOTALQTD([#Total Contracts],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Contract Signed YTD', N'Sum', N'Measure', N'"TOTALYTD([#Total Contracts],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Contracts', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[Contracts -CF]),USERELATIONSHIP(''Date''[Date],Opportunity[Date_Contract_Signed__c]), USERELATIONSHIP(Opportunity[Territory2__c],Account[Territory__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started LM', N'Sum', N'Measure', N'"CALCULATE([#Total Install Started MTD],PREVIOUSMONTH(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started LQ', N'Sum', N'Measure', N'"CALCULATE([#Total Install Started QTD],PREVIOUSQUARTER(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started LY', N'Sum', N'Measure', N'"CALCULATE([#Total Install Started YTD],SAMEPERIODLASTYEAR(Date_dimension[FullDate]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started MTD', N'Sum', N'Measure', N'"TOTALMTD([#Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started QTD', N'Sum', N'Measure', N'"TOTALQTD([#Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Install Started YTD', N'Sum', N'Measure', N'"TOTALYTD([#Installs Started_LB],Date_dimension[FullDate])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Points', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Total Points]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], ''Sales Reps''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Points by Contact', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Trad Total Points])+0, USERELATIONSHIP(''Trad Offices''[Offices], Contact[Sales_Office__c (groups)]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Rep Control Count Install Started', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track Under Rep Control]), USERELATIONSHIP(Opportunity[Actual_Install_Date__c],''Date''[Date])) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Total Selling Days', N'Sum', N'Measure', N'sum(Date_dimension[Current Selling Days])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#TotalInstalls', N'Sum', N'Measure', N'"CALCULATE(Sum(Opportunity[Install_Scheduled__c]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Track C %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Under Rep Control], [#Projects Submitted], 0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Traditional Sales Office Ranking', N'Rank', N'Measure', N'"IF(HASONEVALUE(''Trad Offices''[Offices]) = BLANK(), BLANK(), RANKX(ALLSELECTED(''Trad Offices''[Offices]),[#Points per Rep],,DESC,Dense))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Unchained Close', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Contracts Signed Opp], [#Distinct Appts Ran], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Under Rep Control', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Under Rep Control]), USERELATIONSHIP(Opportunity[Trinity_Salesperson__c], Contact[Id]), USERELATIONSHIP(Contact[Direct Offices (groups)], ''Direct Offices''[Office]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#Zeros Filter', N'Filter/Slicer', N'Measure', N'"IF([#Distinct LOI''s Signed] = 0 && [#Distinct Appts Ran] = 0 && [#Contracts Signed Opp] = 0 && [#Contracts with Install Opp] = 0 && [#kW Installed] = 0, 0, 1)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#? Floor', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[? Floor]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#? Min', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[? Minimum]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#? PPA', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[? PPA]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'#? Starting', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[? Starting Loan]),USERELATIONSHIP(''Date''[Date],Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appointment Completed Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Appointment_Completed__c]), CONCATENATEX(DISTINCT(Opportunity[Appointment_Completed__c]), Opportunity[Appointment_Completed__c], "", "", Opportunity[Appointment_Completed__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appointment Scheduled', N'Count', N'Measure', N'COUNT(''Opportunity''[Stage_Stage_Status_Formula__c])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Actual Production', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[X12_mos_PVWATTS_prod_Actual__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Actual Production Calc', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[X12_mos_PVWATTS_prod_Actual__c]) / [#TotalInstalls], USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Contract Multiplier', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Contract Multiplier]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Contract Production', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Contract Production Calc', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]) / [#TotalInstalls], USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Appt To Install', N'Average', N'Measure', N'"CALCULATE(AVERAGE( Opportunity[Days_First_appt_Install]), USERELATIONSHIP( ''Opportunity''[Event_Name__c], ''Stewardship Account''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Appt To Install', N'Average', N'Measure', N'CALCULATE(AVERAGE( Opportunity[Days_First_appt_Install]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Contract-Demo', N'Average', N'Measure', N'"CALCULATE(AVERAGE( Opportunity[Days_Contract_Install]), USERELATIONSHIP( ''Opportunity''[Event_Name__c], ''Stewardship Account''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Contract-Demo', N'Average', N'Measure', N'CALCULATE(AVERAGE( Opportunity[Days_Contract_Install]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Demo-Contract', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Days_First_appt_Contract]), USERELATIONSHIP( ''Opportunity''[Event_Name__c], ''Stewardship Account''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Days Demo-Contract', N'Average', N'Measure', N'CALCULATE(AVERAGE(Opportunity[Days_First_appt_Contract]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Multiplier', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual_Multiplier__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Prod Diff', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Opportunity[Actual %]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Prod Diff Calc', N'Case', N'Measure', N'"IF([Sum Contract Production]>0,CALCULATE(([Avg Actual Production] - [Avg Contract Production]) / [Avg Contract Production], USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])),BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Avg Production Diff Calc', N'Divide', N'Measure', N'([Avg Actual Production Calc] - [Avg Contract Production Calc]) / [Avg Contract Production Calc]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Balance Pace', N'Divide', N'Measure', N'[#Balance Days] * [#Average Contracts / Day]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Blank Formula', N'Case', N'Measure', N'"IF([#New LOI Total]=0 && [#Distinct Appts Ran]=0 && [#Contracts Signed Opp]=0 && [#Installs Started Opp]=0 , 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract Conversion%', N'Divide', N'Measure', N'"DIVIDE([#Contracts Signed], ''Lead''[#Leads Submitted],0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract Signed Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Contract_Signed__c]), CONCATENATEX(DISTINCT(Opportunity[Contract_Signed__c]), Opportunity[Contract_Signed__c], "", "", Opportunity[Contract_Signed__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'countOppReasonLost', N'Count', N'Measure', N'"CALCULATE(COUNT(''Opportunity''[Reason_Lost__c]),USERELATIONSHIP(''Opportunity''[Created Date w/DST],''Date''[Date]), USERELATIONSHIP(Opportunity[Territory2__c],Account[Territory__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'CurrentDate', N'Date', N'Measure', N'LASTDATE(Date_dimension[FullDate])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Data Check', N'Case', N'Measure', N'"IF([#Pallet Sales Responsible] = 1 || [#Pallet Ops Responsible] = 1 || [#Pallet Both Responsible] = 1, 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date Range', N'Format', N'Measure', N'"[Min Date] & "" - "" & [Max Date]"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'DateDiff', N'Subtract', N'Measure', N'"DATEDIFF(MIN( ''Date''[Date] ), MAX( ''Date''[Date]), MONTH) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Demo', N'Static Value', N'Measure', N'1', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Demos', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appt_Completed__c]),USERELATIONSHIP(''Date''[Date],Opportunity[DemoDate w/DST]), USERELATIONSHIP(Opportunity[Territory2__c],Account[Territory__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Escalator Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[PPA_Rate_Escalator__c]), CONCATENATEX(DISTINCT(Opportunity[PPA_Rate_Escalator__c]), Opportunity[PPA_Rate_Escalator__c], "", "", Opportunity[PPA_Rate_Escalator__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Finance Partner Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Finance Partner]), CONCATENATEX(DISTINCT(Opportunity[Finance Partner]), Opportunity[Finance Partner], "", "", Opportunity[Finance Partner], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Index', N'Divide', N'Measure', N'"Calculate(DIVIDE([Installs Scheduled] - [Installs Scheduled Last Year], [Installs Scheduled Last Year]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Index Completed', N'Divide', N'Measure', N'"Calculate(DIVIDE([Installs Completed] - [Installs Completed Last Year], [Installs Completed Last Year]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Index_Contracts', N'Divide', N'Measure', N'"Calculate(DIVIDE([Contracts] - [Contracts(Last Year)], [Contracts(Last Year)]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install Started Count', N'Sum', N'Measure', N'SUM(Opportunity[Install Started])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installed Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Installed]), CONCATENATEX(DISTINCT(Opportunity[Installed]), Opportunity[Installed], "", "", Opportunity[Installed], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installs conversion', N'Divide', N'Measure', N'[#Contracts Signed]/ [#Leads Submitted]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Last contract date', N'Date', N'Measure', N'"calculate(MAX(Opportunity[Date_Contract_Signed__c]),USERELATIONSHIP(''Date_dimension''[FullDate],''Opportunity''[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Leads/Demos', N'Divide', N'Measure', N'[Leads]/[Demos]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LeadsToOpps', N'Divide', N'Measure', N'[Leads]/[oppsByCreatedDate]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Max Date', N'Date', N'Measure', N'MAX(Opportunity[Created Date w/DST])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Min Date', N'Date', N'Measure', N'MIN(Opportunity[Created Date w/DST])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Multiplier Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Estimated_Multiplier__c (bins)]), CONCATENATEX(DISTINCT(Opportunity[Estimated_Multiplier__c (bins)]), Opportunity[Estimated_Multiplier__c (bins)], "", "",Opportunity[Estimated_Multiplier__c (bins)],ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Opportunities', N'Count', N'Measure', N'CALCULATE(COUNT(Opportunity[Id]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Opps/Demos', N'Divide', N'Measure', N'[oppsByCreatedDate]/[Demos]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'oppsByCreatedDate', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),USERELATIONSHIP(Opportunity[Created Date w/DST],''Date''[Date]), USERELATIONSHIP(Opportunity[Territory2__c],Account[Territory__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Pace', N'Sum', N'Measure', N'[Balance Pace]+ [#Total Contract LB]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PPW Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Price_per_Watt__c (bins)]), CONCATENATEX(DISTINCT(Opportunity[Price_per_Watt__c (bins)]), Opportunity[Price_per_Watt__c (bins)], "", "", Opportunity[Price_per_Watt__c (bins)], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Previous Index', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Installs Scheduled Last Year] - [Installs 2 years ago], [Installs 2 years ago]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Previous Index Completed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Installs Completed Last Year] - [Installs Completed 2 Years Ago], [Installs Completed 2 Years Ago]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Previous Index_Contracts', N'Divide', N'Measure', N'"Calculate(Divide([Contracts(Last Year)]-[Contracts 2 years ago],[Contracts 2 years ago]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Prod Diff', N'Sum', N'Measure', N'"CALCULATE((SUM(Opportunity[X12_mos_PVWATTS_prod_Actual__c]) - SUM(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c])) / SUM(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Prod Diff Calc', N'Divide', N'Measure', N'"IF([Sum Contract Production]>0 && [Sum Actual Production]>0, CALCULATE((DIVIDE([Sum Actual Production], [Sum Contract Production], 0) - 1), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])), BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Purchase Method Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Purchase_Method__c]), CONCATENATEX(DISTINCT(Opportunity[Purchase_Method__c]), Opportunity[Purchase_Method__c], "", "", Opportunity[Purchase_Method__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Rate Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[PPA_Rate__c (bins)]), CONCATENATEX(DISTINCT(Opportunity[PPA_Rate__c (bins)]), Opportunity[PPA_Rate__c (bins)], "", "", Opportunity[PPA_Rate__c (bins)], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'RSA Status Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[RSA_Status__c]), CONCATENATEX(DISTINCT(Opportunity[RSA_Status__c]), Opportunity[RSA_Status__c], "", "", Opportunity[RSA_Status__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Site Assessment Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Site_Assessment__c]), CONCATENATEX(DISTINCT(Opportunity[Site_Assessment__c]), Opportunity[Site_Assessment__c], "", "", Opportunity[Site_Assessment__c], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Site Quality Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Quality]), CONCATENATEX(DISTINCT(Opportunity[Quality]), Opportunity[Quality], "", "", Opportunity[Quality], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Stage Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[StageName]), CONCATENATEX(DISTINCT(Opportunity[StageName]), Opportunity[StageName], "", "", Opportunity[StageName], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'StageNumber', N'Case', N'Measure', N'"if(Opportunity[LeadSource]=""Fundraising"" ,  value(Opportunity[StageNum]), blank())"', N'SUBSTRING(StageName,  PATINDEX(''%[0-9]%'', StageName),  
(CASE WHEN PATINDEX(''%[^0-9]%'', STUFF(StageName, 1, (PATINDEX(''%[0-9]%'', StageName) - 1), NULL )) = 0  
THEN LEN(StageName) ELSE (PATINDEX(''%[^0-9]%'', STUFF(StageName, 1, (PATINDEX(''%[0-9]%'', StageName) - 1), NULL))) - 1  END ))', NULL, NULL, 7, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'State Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[State]), CONCATENATEX(DISTINCT(Opportunity[State]), Opportunity[State], "", "", Opportunity[State],ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Submitted Referral Filter', N'Filter/Slicer', N'Measure', N'"IF(ISFILTERED(Opportunity[Submitted Referral]), CONCATENATEX(DISTINCT(Opportunity[Submitted Referral]), Opportunity[Submitted Referral], "", "", Opportunity[Submitted Referral], ASC), ""All"")"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Actual Production', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[X12_mos_PVWATTS_prod_Actual__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Contract Production', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Sys Size Cash', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size $Cash]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Sys Size Floor', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size $Floor]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Sys Size Loan', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size $Loan]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Sys Size Minimum', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size $Minimum]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sum Sys Size PPA', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Sys Size $PPA]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sys Size $ ? PPA', N'Divide', N'Measure', N'"IF([# AVG ? PPA]<0, ([#Avg System Size Watts] * [# AVG ? PPA]) / 100, BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Total selling days Current', N'Sum', N'Measure', N'"CALCULATE( sum(Date_dimension[Current Selling Days]), USERELATIONSHIP( Opportunity[Date_Contract_Signed__c], Date_dimension[FullDate]), filter( Date_dimension, Date_dimension[FullDate] <= [Last contract date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingCity', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingCountry', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingPostalCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingState', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingStateCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'BillingStreet', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Campaign_Start_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'County__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'EagleView_Order_Status_Formula__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'EagleView_Report__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Email__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Last_EagleView_Ordered__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Median_Income__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'of_Households__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Phase__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Population__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Presentation_Scheduled_Date_Time__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Process_Duration_days__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Referral_Goal__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Solicitation_Permit_Fee__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Stewardship__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Stewardship_Org_Contact__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'STW_Lead_Generator__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'STW_Presenter__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'STW_SDR__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Territory__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Type', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Has_Main_Phone', N'Case - Power of 1', N'Column', N'"IF(AND(not ISBLANK(Opportunity[Main_Phone__c]), NOT(Opportunity[Main_Phone__c] = ""N/A"")), 1, 0)"', N'CASE WHEN Opportunity.[Main_Phone__c] IS NOT NULL AND Opportunity.[Main_Phone__c]<>''N/A'' THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_Multiplier', N'Case - Result', N'Column', N'"IF(Opportunity[System_Size_kWdc__c]>0,IF(not ISBLANK(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]), Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c] / (Opportunity[System_Size_kWdc__c] * 1000), BLANK()),BLANK())"', N'CASE WHEN Opportunity.[System_Size_kWdc__c]>0 AND Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c] IS NOT NULL THEN Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c] / (Opportunity.[System_Size_kWdc__c] * 1000) ELSE '' '' END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_Signed_CF', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Reason_Lost__c] = ""Financial - Credit Reject"", 0, Opportunity[Contract_Signed__c])"', N'CASE WHEN Opportunity.[Reason_Lost__c] = ''Financial - Credit Reject'' THEN 0  ELSE Opportunity.[Contract_Signed__c] END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_to_Install_Group', N'Case - Result', N'Column', N'"IF(OR(ISBLANK(Opportunity[Contract to Install]), Opportunity[Contract to Install] < 0), BLANK(), IF(Opportunity[Date_Contract_Signed__c] = Opportunity[Actual_Install_Date__c], ""Same Day"", IF(Opportunity[Contract to Install] < 15, ""<15 Days"", IF(Opportunity[Contract to Install] >= 15 && Opportunity[Contract to Install] < 30, ""15-30 Days"", IF(Opportunity[Contract to Install] >= 31 && Opportunity[Contract to Install] < 46, ""31-45 Days"", IF(Opportunity[Contract to Install] >= 46 && Opportunity[Contract to Install] < 61, ""46-60 Days"", IF(Opportunity[Contract to Install] >=61 && Opportunity[Contract to Install] < 90, ""61-90 Days"", IF(Opportunity[Contract to Install] >= 91 && Opportunity[Contract to Install] < 121, ""91-120 Days"", "">120 Days""))))))))"', N'CASE WHEN Opportunity.[Contract_to_Install_Days] IS NULL OR  Opportunity.[Contract_to_Install_Days]<0 THEN NULL    WHEN Opportunity.[Date_Contract_Signed__c] = Opportunity.[Actual_Install_Date__c] THEN ''Same Day''    WHEN Opportunity.[Contract_to_Install_Days] < 15 THEN ''<15 Days''       WHEN Opportunity.[Contract_to_Install_Days] >= 15 AND  Opportunity.[Contract_to_Install_Days] < 30 THEN ''15-30 Days''    WHEN Opportunity.[Contract_to_Install_Days] >= 31 AND  Opportunity.[Contract_to_Install_Days] < 46 THEN ''31-45 Days''    WHEN Opportunity.[Contract_to_Install_Days] >= 46 AND  Opportunity.[Contract_to_Install_Days] < 61 THEN ''46-60 Days''    WHEN Opportunity.[Contract_to_Install_Days] >=61  AND  Opportunity.[Contract_to_Install_Days] < 90 THEN ''61-90 Days''  WHEN  Opportunity.[Contract_to_Install_Days] >= 91 AND  Opportunity.[Contract_to_Install_Days] < 121 THEN ''91-120 Days''  ELSE  ''>120 Days'' END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Days_to_Install', N'Case - Result', N'Column', N'"IF(OR(ISBLANK(Opportunity[Actual_Install_Date__c]), ISBLANK(Opportunity[Date_Contract_Signed__c])), BLANK(), Opportunity[Actual_Install_Date__c] - Opportunity[Date_Contract_Signed__c])"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NULL OR Opportunity.[Date_Contract_Signed__c] IS NULL THEN '' ''  
 ELSE DATEDIFF(DAY, Opportunity.[Date_Contract_Signed__c], Opportunity.[Actual_Install_Date__c]) END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Cost Per Appt', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Cost Per Appointment], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Cost Per Appointment G FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Cost Per Appointment], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Cost Per Contract', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Cost Per Contract Filtered], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Cost Per Contract Filtered G & FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Cost Per Contract], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Resolved Track C Projects Closed Date Simplified', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Closed Track]), USERELATIONSHIP(''Project Track''[Closed_Date__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Track A Submissions Created Date Simplified', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track A]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Track A&B Biz Days Created Date Simplified', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Original A or B Res Start to End]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Assigned_To__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Completed_By__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Completed_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'LastModifiedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Cost Per Lead', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Cost Per Lead], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Cost Per Lead G & FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Cost Per Lead], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Cost Per Lead Converted', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Cost Per Lead Converted], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Cost Per Lead Converted G FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Cost Per Lead Converted], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Cost Per Watt', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Cost Per Watt], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Cost Per Watt G & FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Cost Per Watt], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Lead Conversion Ratio', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Lead Conversion Ratio], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Lead Conversion Ratio], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Lead Conversion Ratio], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",[Lead Conversion Ratio], BLANK()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Days_to_PTO', N'Case - Result', N'Column', N'"IF(OR(ISBLANK(Opportunity[Date_Interconn_Approved__c]), ISBLANK(Opportunity[Actual_Install_Complete_Date__c])), BLANK(), Opportunity[Date_Interconn_Approved__c] - Opportunity[Actual_Install_Complete_Date__c])"', N'CASE WHEN Opportunity.[Date_Interconn_Approved__c] IS NULL OR Opportunity.[Actual_Install_Complete_Date__c] IS NULL     THEN '' ''  
  ELSE DATEDIFF(DAY, Opportunity.[Actual_Install_Complete_Date__c], Opportunity.[Date_Interconn_Approved__c]) END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Pipeline to Sit', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Pipeline to Sit], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Pipeline to Sit], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Pipeline to Sit], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",[Pipeline to Sit], BLANK()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Sit %', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Sit %], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Sit %], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Sit %], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",[Sit %], BLANK()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'#Consolidated Spend', N'Crossfiltered', N'Measure', N'"IF(ISCROSSFILTERED(''Lead''[Actual_Lead_Source (groups)]), SWITCH( TRUE(), VALUES(''Lead''[Actual_Lead_Source (groups)]) = ""Paid Leads"",[Total Spend], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Marketing"",[Total Spend G & FB], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Referral"",[Referral Spend], Values(''Lead''[Actual_Lead_Source (groups)]) = ""Outreach"",BLANK(), BLANK()))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Missing_Items__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Notes__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Opportunity_Stage__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Other_Pending_Reason__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Personnel_Assigned_To__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Status_Details__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Status_Details_list__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Action_Item_Business_Days', N'Calculation', N'Column', N'"IF(ISBLANK(''Action Item''[Completed Date w/ DST]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 1,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[Completed_Date_w/_DST] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.Date >= Action_Item.[Created_Date_w/_DST] and     Date_Table.[Date]<= Action_Item.[Completed_Date_w/_DST] -1 and Date_Table.[Working_Day]=1', 3, NULL, N'action_item.[Completed_Date_w/_DST],action_item.[Created_Date_w/_DST]', N'id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Date_Contract_Submitted', N'Lookup', N'Column', N'RELATED(Opportunity[Date_Contract_Submitted__c])', N'Opportunity.[Date_Contract_Submitted__c]', N'Opportunity', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Eagleview_Available', N'Lookup', N'Column', N'RELATED(Opportunity[Eagleview])', N'Opportunity.[Eagleview_Status]', N'Opportunity', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'ERP', N'Case - Power of 1', N'Column', N'"IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[Created During Resolutions Review] = 1 && ''Action Item''[Created by Resolutions] = 1 && ''Action Item''[AI_Template_Name__c] = ""Electrical Review"", 1, 0))"', N'CASE WHEN Action_Item.[Completed_Date__c] IS NULL THEN NULL
WHEN Action_Item.[Created_During_Resolutions_Review] = 1 AND Action_Item.[Created_by_Resolutions] = 1 AND 
Action_Item.[AI_Template_Name__c] = ''Electrical Review'' THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'AI_Pallet', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] = ""Resolutions Review"" && ''Action Item''[Status__c] <> ""Completed"" && ''Action Item''[Status__c] <> ""Not Needed"" && ''Action Item''[Status__c] <> ""Opp Lost"", 1, 0)"', N'CASE WHEN Action_Item.[AI_Template_Name__c] = ''Resolutions Review'' AND Action_Item.[Status__c] <> ''Completed'' AND
Action_Item.[Status__c] <> ''Not Needed'' AND Action_Item.[Status__c] <> ''Opp Lost'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Broken_Roof', N'Case - Power of 1', N'Column', N'"IF(     ''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment"" && CONTAINSSTRING(''Action Item''[Other_Pending_Reason__c], ""Broken Roof"") && (''Action Item''[Status__c] = ""Completed"" || ''Action Item''[Status__c] = ""Not Needed""),     1,     0 )"', N'CASE WHEN Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment'' AND
Action_Item.[Other_Pending_Reason__c] LIKE ''%Broken Roof%'' AND 
Action_Item.[Status__c] = ''Completed'' OR Action_Item.[Status__c] = ''Not Needed'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_Contract_Submitted_to_Resolutions_Review', N'Calculation', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] <> ""Resolutions Review"", BLANK(), IF(OR(ISBLANK(''Action Item''[Date Contract Submitted]), ISBLANK(''Action Item''[Created Date w/ DST])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Date Contract Submitted], ''Action Item''[Created Date w/ DST] -1),     ''Date''[Working Day] = 1,     ALL(''Action Item'') )+0))"', N'Isnull(CASE WHEN Action_Item.[AI_Template_Name__c] <> ''Resolutions Review'' THEN NULL   WHEN Action_Item.[Date_Contract_Submitted] IS NULL OR Action_Item.[Created_Date_w/_DST] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.Date >= Action_Item.[Date_Contract_Submitted] and       Date_Table.[Date]<= Action_Item.[Completed_Date_w/_DST] -1 and Date_Table.[Working_Day]=1', 6, NULL, N'Action_Item.ai_template_name__c,Action_Item.Date_Contract_Submitted,Action_Item.[Created_Date_w/_DST]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_ERP', N'Case - Result', N'Column', N'"IF((''Action Item''[ERP Time] - ''Action Item''[Non Business Days ERP]) < 0, BLANK(), (''Action Item''[ERP Time] - ''Action Item''[Non Business Days ERP]))"', N'CASE WHEN DATEDIFF(DAY ,Action_Item.[Non_Business_Days_ERP],Action_Item.[ERP_Time]) < 0 THEN NULL       
 ELSE DATEDIFF(DAY ,Action_Item.[Non_Business_Days_ERP],Action_Item.[ERP_Time]) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_HMP', N'Case - Result', N'Column', N'"IF((''Action Item''[HMP Time] - ''Action Item''[Non Business Days HMP]) < 0, BLANK(), (''Action Item''[HMP Time] - ''Action Item''[Non Business Days HMP]))"', N'CASE WHEN DATEDIFF(DAY ,Action_Item.[Non_Business_Days_HMP],Action_Item.[HMP_Time]) < 0 THEN NULL      
 ELSE DATEDIFF(DAY,Action_Item.[Non_Business_Days_HMP],Action_Item.[HMP_Time] ) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_PSA', N'Case - Result', N'Column', N'"IF((''Action Item''[PSA Time] - ''Action Item''[Non Business Days PSA]) < 0, BLANK(), (''Action Item''[PSA Time] - ''Action Item''[Non Business Days PSA]))"', N'CASE WHEN DATEDIFF(DAY ,Action_Item.[Non_Business_Days_PSA],Action_Item.[PSA_Time]) < 0 THEN NULL           
 ELSE DATEDIFF(DAY ,Action_Item.[Non_Business_Days_PSA],Action_Item.[PSA_Time]) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Not_Needed_or_Opp_Lost', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[Status__c] = ""Not Needed"" || ''Action Item''[Status__c] = ""Opp Lost"", 1, 0)"', N'CASE WHEN Action_Item.[Status__c] = ''Not Needed'' OR Action_Item.[Status__c] = ''Opp Lost'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Opp_ERP', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[ERP], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[ERP]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Opp_HMP', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[Hybrid Measure], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[Hybrid_Measure]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_Resolutions_Review_End_to_Install', N'Calculation', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] <> ""Resolutions Review"", BLANK(), IF(OR(ISBLANK(''Action Item''[Completed Date w/ DST]), ISBLANK(''Action Item''[Install Start])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Completed Date w/ DST], ''Action Item''[Install Start] -1),     ''Date''[Working Day] = 1,     ALL(''Action Item'') ))+0)"', N'isnull(CASE WHEN Action_Item.[AI_Template_Name__c] <> ''Resolutions Review'' THEN NULL   
WHEN Action_Item.[Completed_Date_w/_DST] IS NULL OR Action_Item.[Install_Start] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Completed_Date_w/_DST] and 
Date_Table.[Date] <= Action_Item.[Install_Start] -1  and Date_Table.[Working_Day]=1', 11, NULL, N'Action_Item.[ai_template_name__c],Action_Item.[Completed_Date_w/_DST],Action_Item.[Install_Start]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Business_Days_SRP', N'Case - Result', N'Column', N'"IF((''Action Item''[SRP Time] - ''Action Item''[Non Business Days SRP]) < 0, BLANK(), (''Action Item''[SRP Time] - ''Action Item''[Non Business Days SRP]))"', N'CASE WHEN DATEDIFF(DAY ,Action_Item.[Non_Business_Days_SRP],Action_Item.[SRP_Time]) < 0 THEN NULL       
 ELSE DATEDIFF(DAY ,Action_Item.[Non_Business_Days_SRP],Action_Item.[SRP_Time]) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Completed_Date_w/_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Action Item''[Completed_Date__c])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Action Item''[Completed_Date__c]))  return IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), FORMAT(if(and(''Action Item''[Completed_Date__c] >= DST_Start, ''Action Item''[Completed_Date__c] < DST_End), ''Action Item''[Completed_Date__c] - (4/24), ''Action Item''[Completed_Date__c] - (5/24)), ""MM/DD/YYYY""))"', N'Action_Item.[Completed_Date__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Completed_DateTime_w/_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Action Item''[Completed_Date__c])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Action Item''[Completed_Date__c]))  return IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), if(and(''Action Item''[Completed_Date__c] >= DST_Start, ''Action Item''[Completed_Date__c] < DST_End), ''Action Item''[Completed_Date__c] - (4/24), ''Action Item''[Completed_Date__c] - (5/24)))"', N'Action_Item.[Completed_Date__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Completed_Time', N'Format', N'Column', N'"IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), FORMAT(''Action Item''[Completed DateTime w/ DST], ""hh:mm:ss""))"', N'CASE WHEN Action_Item.[Completed_Date__c] IS NULL THEN NULL ELSE FORMAT(Action_Item.[Completed_DateTime_w/_DST],''hh:mm:ss'') END', NULL, NULL, 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Contracts_Resolutions_Review_to_Install_seconds', N'Calculation', N'Column', N'Action Item''[Business Days Resolutions Review End to Install] * 86400', N'Action_Item.[Business_Days_Resolutions_Review_End_to_Install] * 86400', NULL, NULL, 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Contracts_Submitted_to_Resolutions_Review_seconds', N'Calculation', N'Column', N'Action Item''[Business Days Contract Submitted to Resolutions Review] * 86400', N'Action_Item.[Business_Days_Contract_Submitted_to_Resolutions_Review] * 86400', NULL, NULL, 7, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Created_by_Resolutions', N'Case - Power of 1', N'Column', N'"IF(ISBLANK(LOOKUPVALUE(Resolutions[Resolution Specialist], Resolutions[LastModifiedById], ''Action Item''[CreatedById])), 0, 1)"', N'CASE WHEN Resolutions.[Resolution_Specialist] IS NULL THEN 0 ELSE 1 END', N'Resolutions', N'Resolutions.[LastModifiedById] = Action_Item.[CreatedById]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Created_Date_w/_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Action Item''[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Action Item''[CreatedDate]))  return IF(ISBLANK(''Action Item''[CreatedDate]), BLANK(), FORMAT(if(and(''Action Item''[CreatedDate] >= DST_Start, ''Action Item''[CreatedDate] < DST_End), ''Action Item''[CreatedDate] - (4/24), ''Action Item''[CreatedDate] - (5/24)), ""MM/DD/YYYY""))"', N'Action_Item.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Created_During_Resolutions_Review', N'Case - Power of 1', N'Column', N'"IF(OR(ISBLANK(''Action Item''[Res Review Completed]), ISBLANK(''Action Item''[Res Review Start])), BLANK(), IF(''Action Item''[CreatedDate] >= ''Action Item''[Res Review Start] && ''Action Item''[CreatedDate] <= ''Action Item''[Res Review Completed], 1, 0))"', N'CASE WHEN Action_Item.[Res_Review_Completed] IS NULL OR Action_Item.[Resolution_Review_Start] THEN NULL
WHEN Action_Item.[CreatedDate] >=Action_Item.[Resolution_Review_Start] AND Action_Item.[CreatedDate] <= Action_Item.[Res_Review_Completed] THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Date_Contract_Signed', N'Lookup', N'Column', N'RELATED(Opportunity[Date_Contract_Signed__c])', N'Opportunity.[Date_Contract_Signed__c]', N'Opportunity', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'ERP_Business_Seconds', N'Case - Result', N'Column', N'"IF((''Action Item''[ERP Time] - ''Action Item''[Non Business Days ERP]) < 0, BLANK(), ROUND((''Action Item''[ERP Time] - ''Action Item''[Non Business Days ERP]) * 86400,0))"', N'CASE WHEN DATEDIFF(DAY , Action_Item.[Non_Business_Days_ERP],Action_Item.[ERP_Time]) < 0 THEN NULL    
 ELSE ROUND(DATEDIFF(DAY, Action_Item.[Non_Business_Days_ERP],Action_Item.[ERP_Time] ) * 86400,0) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'ERP_Count', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[ERP] = 1 && ''Action Item''[Opp ERP] = 1, 1, 0)"', N'CASE WHEN Action_Item.[ERP] = 1 AND Action_Item.[Opp_ERP] = 1 THEN 1 ELSE O END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'ERP_Time', N'Case - Result', N'Column', N'"IF(''Action Item''[Opp ERP] = 0 || ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[AI_Template_Name__c] = ""Electrical Review"", ''Action Item''[Completed_Date__c] - ''Action Item''[CreatedDate], BLANK()))"', N'CASE WHEN Action_Item.[Opp_ERP] = 0 OR Action_Item.[Completed_Date__c] IS NULL THEN NULL    
 WHEN Action_Item.[AI_Template_Name__c] = ''Electrical Review''   
 THEN DATEDIFF(DAY , Action_Item.[CreatedDate],Action_Item.[Completed_Date__c]) ELSE NULL END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'HMP_Business_Seconds', N'Case - Result', N'Column', N'"IF((''Action Item''[HMP Time] - ''Action Item''[Non Business Days HMP]) < 0, BLANK(), ROUND((''Action Item''[HMP Time] - ''Action Item''[Non Business Days HMP]) * 86400,0))"', N'CASE WHEN DATEDIFF(DAY ,Action_Item.[HMP_Time], Action_Item.[Non_Business_Days_HMP]) < 0 THEN NULL         
 ELSE ROUND(DATEDIFF(DAY ,Action_Item.[HMP_Time], Action_Item.[Non_Business_Days_HMP]) * 86400,0) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'HMP_Count', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[Hybrid Measure Project] = 1 && ''Action Item''[Opp HMP] = 1, 1, 0)"', N'CASE WHEN Action_Item.[Hybrid_Measure_Project] = 1 AND Action_Item.[Opp_HMP] = 1 THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'HMP_Time', N'Case - Result', N'Column', N'"IF(''Action Item''[Opp HMP] = 0 || ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment"" || ''Action Item''[AI_Template_Name__c] = ""Site Verification"" || ''Action Item''[AI_Template_Name__c] = ""Measure Documents"" || ''Action Item''[AI_Template_Name__c] = ""Modify Genesis Report"" || ''Action Item''[AI_Template_Name__c] = ""Preliminary Layout"", ''Action Item''[Completed_Date__c] - ''Action Item''[CreatedDate], BLANK()))"', N'CASE WHEN Action_Item.[Opp_HMP] = 0 OR Action_Item.[Completed_Date__c] IS NULL THEN NULL    
 WHEN Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment'' OR   Action_Item.[AI_Template_Name__c] = ''Site Verification'' OR 
 Action_Item.[AI_Template_Name__c] = ''Measure Documents'' OR   Action_Item.[AI_Template_Name__c] = ''Modify Genesis Report'' OR    
 Action_Item.[AI_Template_Name__c] = ''Preliminary Layout'' THEN   
 DATEDIFF(DAY , Action_Item.[CreatedDate],Action_Item.[Completed_Date__c]) ELSE NULL END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Hybrid_Measure_Project', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment"" && ISBLANK(''Action Item''[Completed_Date__c]), 0, IF(''Action Item''[Eagleview Available] <> ""Completed"" && ''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment"" && ''Action Item''[Created During Resolutions Review] = 1, 1, 0))"', N'CASE WHEN Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment'' AND 
Action_Item.[Completed_Date__c] IS NULL THEN O 
WHEN Action_Item.[Eagleview_Available] <> ''Completed'' AND Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment'' AND
Action_Item.[Created_During_Resolutions_Review] = 1 THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Install_Start', N'Lookup', N'Column', N'RELATED(Opportunity[Actual_Install_Date__c])', N'Opportunity.[Actual_Install_Date__c]', N'Opportunity', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Non_Business_Days_ERP', N'Calculation', N'Column', N'"IF(ISBLANK(''Action Item''[ERP Time]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 0,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[ERP_Time] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Created_Date_w_DST] and   
Date_Table.[Date] <= Action_Item.[Completed_Date_w_DST] -1) and Date_Table.[Working_Day]=0', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Non_Business_Days_HMP', N'Calculation', N'Column', N'"IF(ISBLANK(''Action Item''[HMP Time]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 0,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[HMP_Time] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Created_Date_w_DST] and   
Date_Table.[Date] <= Action_Item.[Completed_Date_w_DST] -1) and Date_Table.[Working_Day]=0', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Non_Business_Days_PSA', N'Calculation', N'Column', N'"IF(ISBLANK(''Action Item''[PSA Time]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 0,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[PSA_Time] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Created_Date_w_DST] and   
Date_Table.[Date] <= Action_Item.[Completed_Date_w_DST] -1) and Date_Table.[Working_Day]=0', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Non_Business_Days_SRP', N'Calculation', N'Column', N'"IF(ISBLANK(''Action Item''[SRP Time]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 0,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[SRP_Time] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Created_Date_w_DST] and   
Date_Table.[Date] <= Action_Item.[Completed_Date_w_DST] -1) and Date_Table.[Working_Day]=0', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Non_Business_Days_Resolutions_Review_Start_to_End', N'Calculation', N'Column', N'"IF(OR(ISBLANK(''Action Item''[Completed Date w/ DST]), ISBLANK(''Action Item''[Created Date w/ DST])), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Action Item''[Created Date w/ DST], ''Action Item''[Completed Date w/ DST] -1),     ''Date''[Working Day] = 0,     ALL(''Action Item'') )+0)"', N'isnull(CASE WHEN Action_Item.[Completed_Date_w/_DST] IS NULL OR Action_Item.[Created_Date_w/_DST] IS NULL  THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.[Date] >= Action_Item.[Created_Date_w/_DST] and       Date_Table.[Date] <= Action_Item.[Completed_Date_w/_DST] -1 and Date_Table.[Working_Day]=0', 9, NULL, N'action_item.[Completed_Date_w/_DST],action_item.[Created_Date_w/_DST]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Opp_PSA', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[PSA], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[PSA]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Opp_SRP', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[SRP], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[SRP]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Original_A_or_B_Res_Start_to_End', N'Case - Result', N'Column', N'"IF(CALCULATE(MAX(''Project Track''[Original A or B]), FILTER(''Project Track'', ''Project Track''[Opportunity__c] = ''Action Item''[Opportunity__c])) = 1, ''Action Item''[Resolutions Start to End], BLANK())"', N'CASE WHEN MAX(Project_Track.[Original_A_or_B]) = 1 THEN Action_Item.[Resolutions_Start_to_End] ELSE NULL END ', N'Project_Track', N'action_item.Opportunity__c=Project_Track.Opportunity__c', 14, NULL, N'Action_Item.Opportunity__c,Action_Item.[Resolutions_Start_to_End]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Personnel_Assigned_To', N'Lookup', N'Column', N'RELATED(Contact[Name])', N'Contact.[Name]', N'[Contact]', N'Action_item.[Personnel_Assigned_To__c]=Contact.Id', 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Pitch_Change', N'Case - Power of 1', N'Column', N'"IF(     ''Action Item''[AI_Template_Name__c] = ""Modify Genesis Report"" && ''Action Item''[Pitch Filter] = 1 && ''Action Item''[Status__c] <> ""Not Needed"",     1,     0 )"', N'CASE WHEN Action_Item.[AI_Template_Name__c] = ''Modify Genesis Report'' AND Action_Item.[Pitch_Filter] = 1 AND 
Action_Item.[Status__c] <> ''Not Needed'' THEN 1 ELSE 0 END', NULL, NULL, 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Pitch_Filter', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[Missing_Items__c] = ""Pitch Change"", 1, 0)"', N'CASE WHEN Action_Item.[Missing_Items__c] = ''Pitch Change'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'PSA_Business_Seconds', N'Case - Result', N'Column', N'"IF((''Action Item''[PSA Time] - ''Action Item''[Non Business Days PSA]) < 0, BLANK(), ROUND((''Action Item''[PSA Time] - ''Action Item''[Non Business Days PSA]) * 86400,0))"', N'CASE WHEN DATEDIFF(DAY, Action_Item.[Non_Business_Days_PSA],Action_Item.[PSA_Time] ) < 0 THEN NULL    
ELSE ROUND(DATEDIFF(DAY , Action_Item.[Non_Business_Days_PSA],Action_Item.[PSA_Time]) * 86400,0) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'PSA_Count', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[PSA MP] = 1 && ''Action Item''[Opp PSA] = 1, 1, 0)"', N'CASE WHEN Action_Item.[PSA_MP] = 1 AND Action_Item.[Opp_PSA] = 1 THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'PSA_MP', N'Case - Power of 1', N'Column', N'"IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[Created During Resolutions Review] = 1 && ''Action Item''[Created by Resolutions] = 1 && ''Action Item''[Eagleview Available] <> ""Completed"" && ''Action Item''[AI_Template_Name__c] = ""Physical Site Assessment"", 1, 0))"', N'CASE WHEN Action Item.[Completed_Date__c] IS NULL THEN NULL
WHEN Action_Item.[Created_During_Resolutions_Review] = 1 AND Action_Item.[Created_by_Resolutions] = 1 AND  
Action_Item.[Eagleview_Available] <> ''Completed'' AND Action.Item.[AI_Template_Name__c] = ''Physical Site Assessment'' THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'PSA_Time', N'Case - Result', N'Column', N'"IF(''Action Item''[Opp PSA] = 0 || ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[AI_Template_Name__c] = ""Physical Site Assessment"" || ''Action Item''[AI_Template_Name__c] = ""Site Documents"" || ''Action Item''[AI_Template_Name__c] = ""Site Modeling"" || ''Action Item''[AI_Template_Name__c] = ""Create Shade Analysis"" || ''Action Item''[AI_Template_Name__c] = ""Preliminary Layout (Design Team)"" || ''Action Item''[AI_Template_Name__c] = ""Remodel"" , ''Action Item''[Completed_Date__c] - ''Action Item''[CreatedDate], BLANK()))"', N'CASE WHEN Action_Item.[Opp_PSA] = 0 OR Action_Item.[Completed_Date__c] IS NULL THEN NULL    
WHEN Action_Item.[AI_Template_Name__c] = ''Physical Site Assessment'' OR   Action_Item.[AI_Template_Name__c] = ''Site Documents'' OR     
Action_Item.[AI_Template_Name__c] = ''Site Modeling'' OR   Action_Item.[AI_Template_Name__c] =''Create Shade Analysis''  OR   
Action_Item.[AI_Template_Name__c] = ''Preliminary Layout (Design Team)''  OR   Action_Item.[AI_Template_Name__c] = ''Remodel''   
THEN DATEDIFF(DAY , Action_Item.[CreatedDate],Action_Item.[Completed_Date__c]) ELSE NULL END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Res_Review_Completed', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[Resolutions Review Last Completed], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[Resolutions_Review_Last_Completed]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Res_Review_Start', N'Lookup', N'Column', N'"LOOKUPVALUE(''Operations Timelines''[Resolutions Review Created], ''Operations Timelines''[Opportunity__c], ''Action Item''[Opportunity__c])"', N'Operations_Timelines.[Resolutions_Review_Created]', N'Operations_Timelines', N'Operations_Timelines.[Opportunity__c] = Action_Item.[Opportunity__c]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Resolutions_Start_to_End', N'Case - Result', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] <> ""Resolutions Review"", BLANK(), IF(''Action Item''[Completed_Date__c] < ''Action Item''[CreatedDate], BLANK(),''Action Item''[Completed_Date__c] - ''Action Item''[CreatedDate] - ''Action Item''[Non Business Days Resolutions Review Start to End]))"', N'CASE WHEN Action_Item.[AI_Template_Name__c] <> ''Resolutions Review'' THEN NULL    
WHEN Action_Item.[Completed_Date__c] < Action_Item.[CreatedDate] THEN NULL 
ELSE DATEDIFF(DAY,DATEDIFF(DAY,Action_Item.[Completed_Date__c],Action_Item.[CreatedDate]),
Action_Item.[Non_Business_Days_Resolutions_Review_Start_to_End]) END', NULL, NULL, 13, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Resolutions_Start_to_End_in_seconds', N'Calculation', N'Column', N'"ROUND(''Action Item''[Resolutions Start to End] * 86400,0)"', N'ROUND(Action_Item.[Resolutions_Start_to_End]*86400,0)', NULL, NULL, 15, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'RSA_Completed', N'Case - Power of 1', N'Column', N'"IF(     ''Action Item''[AI_Template_Name__c] = ""Remote Site Assessment"" && ''Action Item''[Status__c] = ""Completed"",     1,     0 )"', N'case when Action_Item.[AI_Template_Name__c] = ''Remote Site Assessment'' AND Action_Item.[Status__c] = ''Completed'' THEN 1 ELSE 0 END ', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'SRP', N'Case - Power of 1', N'Column', N'"IF(ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[Created During Resolutions Review] = 1 && ''Action Item''[Created by Resolutions] = 1 && ''Action Item''[AI_Template_Name__c] = ""Structural Review"", 1, 0))"', N'CASE WHEN Action_Item.[Completed_Date__c] IS NULL  THEN NULL 
WHEN Action_Item.[Created_During_Resolutions_Review] = 1  AND Action_Item.[Created_by_Resolutions] = 1
AND Action_Item.[AI_Template_Name__c] = ''Structural Review'' THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'SRP_Business_Seconds', N'Case - Result', N'Column', N'"IF((''Action Item''[SRP Time] - ''Action Item''[Non Business Days SRP]) < 0, BLANK(), ROUND((''Action Item''[SRP Time] - ''Action Item''[Non Business Days SRP]) * 86400,0))"', N'CASE WHEN DATEDIFF(DAY,Action_item.[SRP_Time] , Action_Item.[Non_Business_Days_SRP]) < 0 THEN NULL ELSE
ROUND(DATEDIFF(DAY , Action_Item.[Non_Business_Days_SRP],Action_Item.[SRP_Time])*86400,0) END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'SRP_Count', N'Case - Power of 1', N'Column', N'"IF(''Action Item''[SRP] = 1 && ''Action Item''[Opp SRP] = 1, 1, 0)"', N'CASE WHEN Action_Item.[SRP] = 1 AND Action_Item.[Opp_SRP] = 1 THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'SRP_Time', N'Case - Result', N'Column', N'"IF(''Action Item''[Opp SRP] = 0 || ISBLANK(''Action Item''[Completed_Date__c]), BLANK(), IF(''Action Item''[AI_Template_Name__c] = ""Structural Review"" || ''Action Item''[AI_Template_Name__c] = ""Structural Site Visit"" || ''Action Item''[AI_Template_Name__c] = ""Roof Quality Review"", ''Action Item''[Completed_Date__c] - ''Action Item''[CreatedDate], BLANK()))"', N'CASE WHEN Action_Item.[Opp_SRP] = 0 OR Action_Item.[Completed_Date__c] IS NULL THEN NULL    
WHEN Action_Item.[AI_Template_Name__c] = ''Structural Review'' OR   Action_Item.[AI_Template_Name__c] = ''Structural Site Visit'' OR    
Action_Item.[AI_Template_Name__c] = ''Roof Site_Quality Review'' THEN   
DATEDIFF(DAY , Action_Item.[CreatedDate],Action_Item.[Completed_Date__c])  ELSE NULL END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Track_C_Days_Grouped', N'Case - Result', N'Column', N'"IF(''Action Item''[AI_Template_Name__c] <> ""Resolutions Review"", BLANK(), IF(ISBLANK(''Action Item''[Action Item Business Days]),BLANK(),IF(''Action Item''[Action Item Business Days]<=5,""<5 Days"",IF(''Action Item''[Action Item Business Days]>5 && ''Action Item''[Action Item Business Days]<=11,""6-11 Days"",IF(''Action Item''[Action Item Business Days]>11, "">11 Days"")))))"', N'CASE WHEN Action_Item.[AI_Template_Name__c] <> ''Resolutions Review'' THEN NULL
WHEN Action_Item.[Action_Item_Business_Days] IS NULL THEN NULL
WHEN Action_Item.[Action_Item_Business_Days] <= 5 THEN ''<5 Days''
WHEN Action_Item.[Action_Item_Business_Days] > 5 AND Action_Item.[Action_Item_Business_Days] < 11 THEN ''6-11 Days''
WHEN Action_Item.[Action_Item_Business_Days] > 11 THEN ''11 Days''
END ', NULL, NULL, 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Winback_Commenced', N'Lookup', N'Column', N'RELATED(Opportunity[Win_Back_Commenced__c])', N'Opportunity.[Win_Back_Commenced__c]', N'Opportunity', N'Action_Item.[Opportunity__c] = Opportunity.[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'action_item', N'Winback_Slicer', N'Case - Result', N'Column', N'"IF(''Action Item''[AI_Template_Name__c]<>""Resolutions Review"",BLANK(), IF(ISBLANK(''Action Item''[Winback Commenced]),""Non Winback Project"", IF(''Action Item''[Winback Commenced]>''Action Item''[CreatedDate]&& ''Action Item''[Winback Commenced]<''Action Item''[Completed_Date__c],""During Resolution"", ""Outside Resolution"")))"', N'CASE WHEN Action_Item.[AI_Template_Name__c] <> ''Resolutions Review'' THEN NULL
WHEN Action_Item.[Winback_Commenced] IS NULL THEN ''Non Winback Project''
WHEN  Action_Item.[Winback_Commenced] > Action_Item.[CreatedDate] AND Action_Item.[Winback_Commenced] < Action_Item.[Completed_Date__c]
THEN ''During Resolution'' ELSE ''Outside Resolution'' END', NULL, NULL, 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Broken Roofs', N'Sum', N'Measure', N'"CALCULATE(SUM(''Action Item''[Broken Roof]), USERELATIONSHIP(''Action Item''[Completed Date w/ DST], ''Date''[Date])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Contracts Created', N'Count', N'Measure', N'"CALCULATE(COUNT(''Action Item''[Id]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#ER Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days ERP]), FILTER(''Action Item'',NOT(ISBLANK(''Action Item''[ERP Time]))), FILTER(''Action Item'', ''Action Item''[Opp ERP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#ER Project Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[ERP Business Seconds]), FILTER(''Action Item'', ''Action Item''[Opp ERP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#ER Projects', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(''Action Item'', ''Action Item''[ERP Count] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#HMP Biz Days 2', N'Sum', N'Measure', N'"CALCULATE(SUM(''Action Item''[Business Days HMP]), FILTER(''Action Item'', [#Hybrid Measure Projects] =1))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Hybrid Measure Project Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days HMP]), FILTER(''Action Item'',NOT(ISBLANK(''Action Item''[HMP Time]))), FILTER(''Action Item'', ''Action Item''[Opp HMP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Hybrid Measure Project Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[HMP Business Seconds]), FILTER(''Action Item'', ''Action Item''[Opp HMP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Hybrid Measure Projects', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(''Action Item'', ''Action Item''[HMP Count] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#LOI Contract Not Needed Not DQ', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(Opportunity, Opportunity[LOI_Signed__c] = 1), FILTER(''Action Item'', ''Action Item''[Status__c] = ""Not Needed""), FILTER(Opportunity, NOT(SEARCH(""Lost"", Opportunity[StageName],, BLANK()) > 0)), FILTER(Opportunity, Opportunity[Contract_Signed__c] <> 1), USERELATIONSHIP(''Date''[Date], Opportunity[Date_LOI_Signed__c]), USERELATIONSHIP(''Action Item''[Opportunity__c],Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#LOI Contracts Created', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(Opportunity, Opportunity[LOI_Signed__c] = 1), FILTER(''Action Item'', ''Action Item''[Status__c] = ""Completed""), USERELATIONSHIP(''Date''[Date], Opportunity[Date_LOI_Signed__c]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#LOI Contracts In Process', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[LOI_Signed__c]), FILTER(''Action Item'', OR(''Action Item''[Status__c] = ""Requested"", ''Action Item''[Status__c] = ""On Hold"")),USERELATIONSHIP(''Date''[Date], ''Opportunity''[Date_LOI_Signed__c]), USERELATIONSHIP(''Action Item''[Opportunity__c],Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#LOI DQ Contracts Created', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[LOI_Signed__c]), FILTER(''Action Item'', ''Action Item''[Not Needed or Opp Lost] = 1), FILTER(Opportunity, Opportunity[Lost No Contract] = 1), USERELATIONSHIP(''Date''[Date], ''Opportunity''[Date_LOI_Signed__c]), USERELATIONSHIP(''Action Item''[Opportunity__c],''Opportunity''[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#Pitch Changes', N'Sum', N'Measure', N'"CALCULATE(SUM(''Action Item''[Pitch Change]), USERELATIONSHIP(''Action Item''[Created Date], ''Date''[Date])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#PSA Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days PSA]), FILTER(''Action Item'',NOT(ISBLANK(''Action Item''[PSA Time]))), FILTER(''Action Item'', ''Action Item''[Opp PSA] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#PSA Measure Projects', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(''Action Item'', ''Action Item''[PSA Count] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#PSA Project Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[PSA Business Seconds]), FILTER(''Action Item'', ''Action Item''[Opp PSA] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#RSAs Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Action Item''[RSA Completed]), USERELATIONSHIP(''Action Item''[Completed Date w/ DST], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#SR Business Days', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Business Days SRP]), FILTER(''Action Item'',NOT(ISBLANK(''Action Item''[SRP Time]))), FILTER(''Action Item'', ''Action Item''[Opp SRP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#SR Project Seconds', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[SRP Business Seconds]), FILTER(''Action Item'', ''Action Item''[Opp SRP] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'#SR Projects', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(''Action Item''[Opportunity__c]), FILTER(''Action Item'', ''Action Item''[SRP Count] = 1), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]), USERELATIONSHIP(''Action Item''[Opportunity__c], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'AIs Completed', N'Count', N'Measure', N'"CALCULATE(COUNT(''Action Item''[Id]), USERELATIONSHIP(''Action Item''[Completed Date w/ DST], ''Date''[Date])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'AIs Created', N'Count', N'Measure', N'"CALCULATE(COUNT(''Action Item''[Id]), USERELATIONSHIP(''Action Item''[Created Date], ''Date''[Date])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Action Item', N'Id Count', N'Count', N'Measure', N'"CALCULATE(COUNT(''Action Item''[Id]), USERELATIONSHIP(''Date''[Date], ''Action Item''[Completed Date w/ DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'Affiliation_Id__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'Church_Name__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'Event_Name__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Affiliation Code', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Amt_Owed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Amt_Paid__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Date_Referrer_Paid__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'IsDeleted', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Lead_Source__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Referred_Project_Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Referrer_Account__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Referrer_Name_Contact__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Stewardship_Account__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check_Request', N'Oppt_Lead_Source', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Actual Lead Source], Opportunity[Id], ''Check Request''[Referred_Project_Opportunity__c])"', N'Opportunity.Actual_Lead_Source', N'[Opportunity]', N'Opportunity.[Id]=Check_Request.[Referred_Project_Opportunity__c]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check_Request', N'Created_Date_Time_w/_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Check Request''[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Check Request''[CreatedDate]))  return IF(ISBLANK(''Check Request''[CreatedDate]), BLANK(), if(and(''Check Request''[CreatedDate] >= DST_Start, ''Check Request''[CreatedDate] < DST_End), ''Check Request''[CreatedDate] - (4/24), ''Check Request''[CreatedDate] - (5/24)))"', N'Check_Request.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check_Request', N'Oppt_Referrer', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Referrer_Name_new__c], Opportunity[Id], ''Check Request''[Referred_Project_Opportunity__c])"', N'Opportunity.Referrer_Name_new__c', N'[Opportunity]', N'Opportunity.[Id]=Check_Request.[Referred_Project_Opportunity__c]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check_Request', N'Referrer', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], ''Check Request''[Referrer_Name_Contact__c])"', N'[Contact].[Name]', N'[Contact]', N'Contact.[Id]=Check_Request.[Referrer_Name_Contact__c]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Contract by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Contract Signed],[#Contracts Signed -CF by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Contract by Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Install],[#Contracts Signed -CF by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Demo by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Contract Signed],[#Total Demos by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Demo by Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Install],[#Total Demos by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Lead', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend],[#Leads],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Lead  by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Contract Signed],[#Leads by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Lead by Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Install],[#Leads by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Lead Converted by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Contract Signed],[#Leads Converted by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Cost Per Lead Converted by Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Install],[#Leads Converted by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral CPW', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend],[#Total kW Install Scheduled]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral CPW by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Contract Signed],[#Total kW Install Scheduled by Contract]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral CPW by Install Date', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Referral Spend by Install],[#Total kW Install Scheduled by Install]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Spend', N'Sum', N'Measure', N'"CALCULATE(SUM(Opps[Install Scheduled Spend]), USERELATIONSHIP(''Lead''[ConvertedOpportunityId], Opps[Referred_Project_Opportunity__c]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Spend by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opps[Install Scheduled Spend]), USERELATIONSHIP(''Lead''[ConvertedOpportunityId], Opps[Referred_Project_Opportunity__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Spend by Install', N'Sum', N'Measure', N'"CALCULATE(SUM(Opps[Install Scheduled Spend]), USERELATIONSHIP(''Lead''[ConvertedOpportunityId], Opps[Referred_Project_Opportunity__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'#Referral Spend Per Contract', N'Divide', N'Measure', N'"DIVIDE([#Referral Spend],[#Contracts Signed -CF],0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Potential Amount Raised', N'Sum', N'Measure', N'"CALCULATE( sum(''Check Request''[Amt_Owed__c]),  FILTER(''Check Request'', ''Check Request''[Lead_Source__c] = ""Fundraising""  && (''Check Request''[RecordType.Name]=""Installation Referral Payment""||''Check Request''[RecordType.Name]=""Appointment Referral Payment"")  &&  ''Check Request''[Status__c]=""Check Requested""),USERELATIONSHIP(Contact[Affiliation_Org__c],''Stewardship Account''[Id]), USERELATIONSHIP(''Check Request''[Referrer_Name_Contact__c],Contact[Id]), USERELATIONSHIP(Date_dimension[FullDate], ''Check Request''[Created_Date_m]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Total Amount Raised', N'Sum', N'Measure', N'"CALCULATE( sum(''Check Request''[Amt_Paid__c]), FILTER(''Check Request'', ''Check Request''[Lead_Source__c] = ""Fundraising"" && (''Check Request''[RecordType.Name]=""Installation Referral Payment""||''Check Request''[RecordType.Name]=""Appointment Referral Payment"") &&  ''Check Request''[Status__c]=""Closed-Paid""),USERELATIONSHIP(Contact[Affiliation_Org__c],''Stewardship Account''[Id]), USERELATIONSHIP(''Check Request''[Referrer_Name_Contact__c],Contact[Id]), USERELATIONSHIP(Date_dimension[FullDate], ''Check Request''[Date_Referrer_Paid__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Check Request', N'Total and Potential Amount', N'Sum', N'Measure', N'[Potential Amount Raised] + [Total Amount Raised]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'AccountId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'ADP_Employee_Number__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Affiliation_Org__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Department', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'DoNotCall', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Email', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Employment_Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Event_Name__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'HasOptedOutOfEmail', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'LeadSource', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingCity', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingCountry', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingPostalCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingState', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingStateCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'MailingStreet', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Number_of_Days_Employed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Phone', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Referral_Submissions__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Division__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Solar_Pro__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'User_Id__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Active_Direct', N'Case - Power of 1', N'Column', N'"IF(     (Contact[Employment_Status__c] = ""Active"" || Contact[Employment_Status__c] = ""New Hire"") && Contact[Sales Division] = ""Direct"",     1,     0 )"', N'CASE WHEN (Contact.[Employment_Status__c] = ''Active'' OR Contact.[Employment_Status__c] = ''New Hire'') AND  Contact.[Sales_Division] = ''Direct'' THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Active_Direct_Solar_Pro', N'Case - Power of 1', N'Column', N'"IF(     (Contact[Employment_Status__c] = ""Active"" || Contact[Employment_Status__c] = ""New Hire"") && Contact[Sales Division] = ""Direct - Solar Pro"",     1,     0 )"', N'CASE WHEN (Contact.[Employment_Status__c] = ''Active'' OR Contact.[Employment_Status__c] = ''New Hire'') AND  Contact.[Sales_Division] = ''Direct - Solar Pro'' THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Active_Outreach', N'Case - Power of 1', N'Column', N'"IF(     (Contact[Employment_Status__c] = ""Active"" || Contact[Employment_Status__c] = ""New Hire"") && Contact[Sales Division] = ""Outreach"",     1,     0 )"', N'CASE WHEN (Contact.[Employment_Status__c] = ''Active'' OR Contact.[Employment_Status__c] = ''New Hire'') AND  Contact.[Sales_Division] = ''Outreach'' THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Active_Trad_or_Direct', N'Case - Power of 1', N'Column', N'"IF(     (Contact[Employment_Status__c] = ""Active"" || Contact[Employment_Status__c] = ""New Hire"") && OR(Contact[Sales_Division__c (groups)] = ""Traditional"", Contact[Sales_Division__c (groups)] = ""Direct""),     1,     0 )"', N'CASE WHEN (Contact.[Employment_Status__c] = ''Active'' OR Contact.[Employment_Status__c] = ''New Hire'') AND 
   (Contact.[Sales_Division__c_groups] = ''Traditional'' OR Contact.[Sales_Division__c_groups] = ''Direct'') THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Active_Trad', N'Case - Power of 1', N'Column', N'"IF(     (Contact[Employment_Status__c] = ""Active"" || Contact[Employment_Status__c] = ""New Hire"") && Contact[Sales Division] = ""Traditional"",     1,     0 )"', N'CASE WHEN (Contact.[Employment_Status__c] = ''Active'' OR Contact.[Employment_Status__c] = ''New Hire'') AND  Contact.[Sales_Division] = ''Traditional'' THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Address', N'Case - Result', N'Column', N'"IF(not ISBLANK(Contact[MailingStreet]),Contact[MailingStreet] & "", "" & Contact[MailingCity] & "", "" & Contact[MailingStateCode] & "" "" & Contact[MailingPostalCode], BLANK())"', N'CASE WHEN Contact.[MailingStreet] IS NOT NULL THEN CONCAT(Contact.[MailingStreet],'' '',Contact.[MailingCity],'' '',Contact.[MailingStateCode],'' '',
Contact.[MailingPostalCode]) ELSE NULL END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'User', N'Lookup', N'Column', N'RELATED( User[Name])', N'[User].[Name]', N'[User]', N'[contact].user_id__c=[User].Id', 1, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Active Reps', N'Sum', N'Measure', N'SUM(Contact[Active Trad or Direct])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Average Days Employed', N'Average', N'Measure', N'"CALCULATE(AVERAGE(Contact[Number_of_Days_Employed__c]), USERELATIONSHIP(Contact[Id],Opportunity[Trinity_Salesperson__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Average Years Employed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Average Days Employed],365,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Days_Employed_Groups', N'Case - Result', N'Column', N'"IF(Contact[Number_of_Days_Employed__c] < 0 || ISBLANK(Contact[Number_of_Days_Employed__c]) || (Contact[Employment_Status__c] <> ""Active"" && Contact[Employment_Status__c] <> ""New Hire""), BLANK(),  IF(Contact[Number_of_Days_Employed__c] < 90, ""<90 Days"", IF(Contact[Number_of_Days_Employed__c] >= 90 && Contact[Number_of_Days_Employed__c] < 180, ""90-179 Days"", IF(Contact[Number_of_Days_Employed__c] >=180 && Contact[Number_of_Days_Employed__c] < 365, ""180-364 Days"", ""1+ Years""))))"', N'CASE WHEN (Contact.[Number_of_Days_Employed__c] < 0 OR Contact.[Number_of_Days_Employed__c] IS NULL) OR  
 (Contact.[Employment_Status__c] <> ''Active'' AND Contact.[Employment_Status__c] <> ''New Hire'') THEN NULL  
 WHEN Contact.[Number_of_Days_Employed__c] < 90 THEN ''<90 Days''  WHEN Contact.[Number_of_Days_Employed__c] >= 90 AND 
 Contact.[Number_of_Days_Employed__c] < 180 THEN ''90-179 Days''  WHEN Contact.[Number_of_Days_Employed__c] >= 180 AND 
 Contact.[Number_of_Days_Employed__c] < 365 THEN ''180-364 Days'' ELSE ''1+ Years'' END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Division_and_Office', N'Format', N'Column', N'"Contact[Sales_Division__c (groups)] & "" | "" & Contact[Sales_Office__c (groups)]"', N'CONCAT(Contact.[Sales_Division__c_groups] ,'' | '',Contact.[Sales_Office__c_groups])', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Referrals', N'Case - Result', N'Column', N'"IF(Contact[Referral_Submissions__c] > 0, ""Yes"", ""No"")"', N'CASE WHEN Contact.[Referral_Submissions__c] > 0 THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Time To Completed Hours', N'Case - Result', N'Column', N'"IF(not ISBLANK(''EagleView Report''[Last Order]) && not ISBLANK(''EagleView Report''[Date_Received__c]), (''EagleView Report''[Date_Received__c] - ''EagleView Report''[Last Order]) * 24, BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Time To Completed Seconds', N'Case - Result', N'Column', N'"IF(not ISBLANK(''EagleView Report''[Last Order]) && not ISBLANK(''EagleView Report''[Date_Received__c]), (''EagleView Report''[Date_Received__c] - ''EagleView Report''[Last Order]) * 86400, BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Division', N'Case - Result', N'Column', N'"IF(     CONTAINSSTRING(Contact[Sales_Division__c], ""Traditional""),     ""Traditional"",     IF(         CONTAINSSTRING(Contact[Sales_Division__c], ""Outreach""),         ""Outreach"",         IF(             CONTAINSSTRING(Contact[Sales_Division__c], ""Direct"") && Contact[Solar_Pro__c] = TRUE(),             ""Direct - Solar Pro"",             IF(                 CONTAINSSTRING(Contact[Sales_Division__c], ""Direct"") && Contact[Solar_Pro__c] = FALSE(),                 ""Direct"",                 IF(                     ISBLANK(Contact[Sales_Division__c]),                     BLANK(),                     ""Other""                 )             )         )     ) )"', N'CASE WHEN Contact.[Sales_Division__c] LIKE ''%Traditional%'' THEN ''Traditional''
WHEN Contact.[Sales_Division__c] LIKE ''%Outreach%'' THEN ''Outreach''
WHEN Contact.[Sales_Division__c] LIKE ''%Direct%'' AND Contact.[Solar_Pro__c] = 1 THEN ''Direct - Solar Pro''
WHEN Contact.[Sales_Division__c] LIKE ''%Direct%'' AND Contact.[Solar_Pro__c] = 0 THEN ''Direct''
WHEN Contact.[Sales_Division__c] IS NULL THEN NULL ELSE ''Other'' END', NULL, NULL, 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Division_Abbreviation', N'Case - Result', N'Column', N'"IF(AND(Contact[Sales_Division__c]=""Sales- Direct"",Contact[Solar_Pro__c]=TRUE()),""SP - "",IF(Contact[Sales_Division__c]=""Sales- Traditional"",""T - "",IF(Contact[Sales_Division__c]=""Sales- Direct"",""D - "",BLANK())))"', N'CASE WHEN Contact.[Sales_Division__c]=''Sales- Direct'' AND Contact.[Solar_Pro__c]=1 THEN ''SP - ''
WHEN Contact.[Sales_Division__c] = ''Sales- Traditional'' THEN ''T - ''
WHEN Contact.[Sales_Division__c] = ''Sales- Direct'' THEN ''D - '' ELSE NULL END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Division_and_Sales_Rep_Name', N'Format', N'Column', N'"CONCATENATE(Contact[Sales Division Abbreviation],Contact[Name])"', N'CONCAT(Contact.[Sales_Division_Abbreviation] ,Contact.[Name])', NULL, NULL, 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_State', N'Case - Result', N'Column', N'"IF(     ISBLANK(Contact[Sales_Office__c]),     BLANK(),     IF(         Contact[Sales_Office__c] = ""MA- RI"",         ""RI"",         LEFT(Contact[Sales_Office__c], 2)     ) )"', N'CASE WHEN Contact.[Sales_Office__c] IS NULL THEN NULL 
WHEN Contact.[Sales_Office__c] = ''MA- RI'' THEN ''RI'' ELSE LEFT(Contact.[Sales_Office__c],2) END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Count Reps', N'Count', N'Measure', N'"CALCULATE(CALCULATE(COUNT(Contact[Id])), CROSSFILTER(Contact[Id], Opportunity[Trinity_Salesperson__c], None), USERELATIONSHIP(Contact[Sales State], ''Sales State''[Sales State]), USERELATIONSHIP(''Sales Offices''[Sales_Office__c (groups)], Contact[Sales_Office__c (groups)]), USERELATIONSHIP(Contact[Sales Division], ''Sales Divisions''[Sales Division]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Days Employed', N'Sum', N'Measure', N'"CALCULATE(SUM(Contact[Number_of_Days_Employed__c]), USERELATIONSHIP(Contact[Id],Opportunity[Trinity_Salesperson__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Direct Reps', N'Sum', N'Measure', N'SUM(Contact[Active Direct])+0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Direct Solar Pro Reps', N'Sum', N'Measure', N'SUM(Contact[Active Direct - Solar Pro])+0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Outreach Reps', N'Sum', N'Measure', N'SUM(Contact[Active Outreach])+0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Referral Submissions', N'Sum', N'Measure', N'"CALCULATE(SUM(''Primary Contacts''[Total Referrals]), USERELATIONSHIP(''Primary Contacts''[Primary_Contact__c], Opportunity[Primary_Contact__c]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Traditional Reps', N'Sum', N'Measure', N'SUM(Contact[Active Traditional])+0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'#Years Employed', N'Average', N'Measure', N'"CALCULATE(AVERAGEX(Contact,DIVIDE([#Days Employed],365,0)))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Account__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Date_Received__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Date_Sent__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'EagleView_Order_Status_c__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'EagleView_Order_SubStatus_c__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Reorder_From__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Source__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Address', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[Name], Account[Id], ''EagleView Report''[Account__c])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Completed over 3 Hours', N'Case - Power of 1', N'Column', N'"IF(not ISBLANK(''EagleView Report''[Date_Received__c]) && ''EagleView Report''[Time To Completed Hours] > 3, 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Completed under 3 Hours', N'Case - Power of 1', N'Column', N'"IF(not ISBLANK(''EagleView Report''[Date_Received__c]) && ''EagleView Report''[Time To Completed Hours] <= 3, 1, 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Date Sent Group', N'Case - Result', N'Column', N'"IF(ISBLANK(''EagleView Report''[Date_Sent__c]), BLANK(), IF(''EagleView Report''[Date_Sent__c] = TODAY(), ""Today"", ""Other""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Last Modified', N'Time Conversion', N'Column', N'"var LastModified_DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''EagleView Report''[LastModifiedDate])) var LastModified_DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''EagleView Report''[LastModifiedDate]))  return IF(ISBLANK(''EagleView Report''[LastModifiedDate]), BLANK(), FORMAT(if(and(''EagleView Report''[LastModifiedDate] >= LastModified_DST_Start, ''EagleView Report''[LastModifiedDate] < LastModified_DST_End), ''EagleView Report''[LastModifiedDate] - (4/24), ''EagleView Report''[LastModifiedDate] - (5/24)), ""MM/DD/YYYY""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Last Order', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[Last_EagleView_Ordered__c], Account[Id], ''EagleView Report''[Account__c])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Last Order Date', N'Time Conversion', N'Column', N'"var Created_DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''EagleView Report''[Last Order])) var Created_DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''EagleView Report''[Last Order]))  return IF(ISBLANK(''EagleView Report''[Last Order]), BLANK(), FORMAT(if(and(''EagleView Report''[Last Order] >= Created_DST_Start, ''EagleView Report''[Last Order] < Created_DST_End), ''EagleView Report''[Last Order] - (4/24), ''EagleView Report''[Last Order] - (5/24)), ""MM/DD/YYYY""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Last Order Date UTC', N'Format', N'Column', N'"IF(ISBLANK(''EagleView Report''[Last Order]), BLANK(), FORMAT(''EagleView Report''[Last Order], ""MM/DD/YYYY""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Over 3 Hours', N'Case - Power of 1', N'Column', N'"IF(     ISBLANK(''EagleView Report''[Time to Complete Seconds]),     BLANK(),     IF(         ''EagleView Report''[Time to Complete Seconds] >= 10800,         1,         0     ) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Time Groups Seconds', N'Case - Result', N'Column', N'"VAR SecondsGroup = ''EagleView Report''[Time to Complete Seconds (bins)] + 1800  return IF(     ''EagleView Report''[Time to Complete Seconds] < 0,     ""Unknown"",     IF(         ISBLANK(''EagleView Report''[Time to Complete Seconds (bins)]),         BLANK(),         IF(             SecondsGroup > 10800,             ""3+ Hrs"",             DIVIDE(''EagleView Report''[Time to Complete Seconds (bins)], 3600, 0) & "" Hrs - "" & DIVIDE(SecondsGroup, 3600, 0) & "" Hrs""         )     ) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Time to Complete Seconds', N'Case - Result', N'Column', N'"IF(     ''EagleView Report''[EagleView_Order_Status_c__c] = ""Completed"" && ''EagleView Report''[EagleView_Order_SubStatus_c__c] = ""Sent"",     DATEDIFF(''EagleView Report''[Last Order], ''EagleView Report''[Date_Received__c],SECOND),     BLANK() )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Under 3 Hours', N'Case - Power of 1', N'Column', N'"IF(     ISBLANK(''EagleView Report''[Time to Complete Seconds]),     BLANK(),     IF(         ''EagleView Report''[Time to Complete Seconds] < 10800,         1,         0     ) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'#AVG Turnaround Time EV', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''EagleView Report''[Time To Completed Seconds]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""), USERELATIONSHIP(''Date''[Date], ''EagleView Report''[Last Order Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Eagleview Orders Sent', N'Count', N'Measure', N'"CALCULATE(COUNT(''EagleView Report''[Id]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""), USERELATIONSHIP(''Date''[Date], ''EagleView Report''[Last Order Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'EV Over 3 Hours', N'Count', N'Measure', N'"CALCULATE(COUNT(''EagleView Report''[Id]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""), FILTER(''EagleView Report'', ''EagleView Report''[Completed over 3 Hours] = 1), USERELATIONSHIP(''Date''[Date], ''EagleView Report''[Last Order Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'EV Total', N'Count', N'Measure', N'"CALCULATE(COUNT(''EagleView Report''[Id]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""), FILTER(''EagleView Report'', not ISBLANK(''EagleView Report''[Completed under 3 Hours])), USERELATIONSHIP(''Date''[Date], ''EagleView Report''[Last Order Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'EV Under 3 Hours', N'Count', N'Measure', N'"CALCULATE(COUNT(''EagleView Report''[Id]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""), FILTER(''EagleView Report'', ''EagleView Report''[Completed under 3 Hours] = 1), USERELATIONSHIP(''Date''[Date], ''EagleView Report''[Last Order Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report', N'Reordered', N'Count', N'Measure', N'"CALCULATE(COUNT(''EagleView Report''[Id]), USERELATIONSHIP(''Date''[Date], Account[Last Eagleview Ordered]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Field', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'IsDeleted', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'NewValue', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'OldValue', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'ParentId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Address', N'Case - Result', N'Column', N'"var Acc = LOOKUPVALUE(Account[Name], Account[Id], ''EV Details''[Account__c]) var Parent_Search = LOOKUPVALUE(Account[Name], Account[EagleView_Report__c], ''EV Details''[ParentId])  return IF(     ISBLANK(Acc),     Parent_Search,     Acc )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Duplicates', N'Case - Result', N'Column', N'"var Dupes = CALCULATE(MAX(''EV Duplicates''[Count]), FILTER(''EV Duplicates'', ''EV Details''[Parent and Date] = ''EV Duplicates''[Parent and Date]))  return IF(     Dupes > 1,     ""Yes"",     ""No"" )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Parent and Date', N'Format', N'Column', N'"EV Details''[ParentId] & "" "" & ''EV Details''[Date Created]"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Address', N'Lookup', N'Column', N'"LOOKUPVALUE(''EV Details''[Address], ''EV Details''[ParentId], ''EV Duplicates''[ParentId])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Address and Date', N'Format', N'Column', N'"EV Duplicates''[Address] & "" "" & ''EV Duplicates''[CreatedDate]"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'Aurora Dupes', N'Calculation', N'Column', N'"CALCULATE(COUNTROWS(''Aurora Duplicates''), FILTER(''Aurora Duplicates'', ''Aurora Duplicates''[Address and Date] = ''EV Duplicates''[Address and Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Avg EV Turnaround', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''EagleView Report''[Time to Complete Seconds]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#EV Orders Less 3 Hours', N'Sum', N'Measure', N'"CALCULATE(SUM(''EagleView Report''[Under 3 Hours]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Eagleview Turnaround Time', N'Format', N'Measure', N'"var vSeconds=[#Avg EV Turnaround] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#EV Orders Over 3 Hours', N'Sum', N'Measure', N'"CALCULATE(SUM(''EagleView Report''[Over 3 Hours]), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#EV Orders Status', N'Count', N'Measure', N'"CALCULATE(COUNTROWS(''EagleView Report''), FILTER(''EagleView Report'', ''EagleView Report''[Source__c] = ""Eagleview""))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Total Orders EV', N'Count', N'Measure', N'CALCULATE(COUNTROWS(''EV Details''))+0', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Duplicate Addresses EV', N'Count', N'Measure', N'"CALCULATE(COUNTROWS(''EV Duplicates''), USERELATIONSHIP(''EV Duplicates''[Parent and Date], ''EV Details''[Parent and Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Duplicate Orders EV', N'Sum', N'Measure', N'"CALCULATE(SUM(''EV Duplicates''[Count]), USERELATIONSHIP(''EV Duplicates''[Parent and Date], ''EV Details''[Parent and Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'EagleView Report History', N'#Extra Orders EV', N'Subtract', N'Measure', N'EV Duplicates''[#Duplicate Orders EV] - ''EV Duplicates''[#Duplicate Addresses EV]', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Appointment_Confirmed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Appointment_Setting__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'EndDateTime', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Outcome__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'OwnerId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'StartDateTime', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Subject', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Telemarketer__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Type', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'WhatId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'WhoId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Appt_Type', N'Case - Result', N'Column', N'"IF(OR(CONTAINSSTRING(Event[Subject],""GO BACK""), CONTAINSSTRING(Event[Type],""GO BACK"")), ""Go Back Appointment"",""First Appointment"")"', N'CASE WHEN Event.[Subject] LIKE ''%GO BACK%'' OR Event.[Type] LIKE ''%GO BACK%'' THEN ''Go Back Appointment'' ELSE ''First Appointment'' END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Appt_Date', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Event[StartDateTime])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Event[StartDateTime]))  return IF(ISBLANK(Event[StartDateTime]), BLANK(), FORMAT(if(and(Event[StartDateTime] >= DST_Start, Event[StartDateTime] < DST_End), Event[StartDateTime] - (4/24), Event[StartDateTime] - (5/24)), ""MM/DD/YYYY""))"', N'Event.[StartDateTime] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Appts_Ran', N'Case - Result', N'Column', N'"IF(     Event[Outcome__c (groups)] = ""Ran"",     Event[Opp Id],     BLANK() )"', N'CASE WHEN Event.[Outcome__c_groups] = ''Ran'' THEN Event.[Oppt_Id] ELSE NULL END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Assigned_To', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Name], User[Id], Event[OwnerId])"', N'[User].[Name]', N'[User]', N'[User].[Id] = Event.[ownerid]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Assigned_To_Division', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Contact Division (groups)], User[Id], Event[OwnerId])"', N'[User].[Contact_Division_groups]', N'[User]', N'[User].[Id] = Event.[ownerid]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Assigned_To_Office', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Contact Office (groups)], User[Id], Event[OwnerId])"', N'[User].[Contact_Office_groups]', N'[User]', N'[User].[Id] = Event.[ownerid]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Chained_Contract', N'Case - Result', N'Column', N'"IF(     ISBLANK(CALCULATE(MAX(Opportunity[Last Appt Before Contract Signed]), FILTER(Opportunity, Opportunity[Id] = Event[Opp Id]), FILTER(Opportunity, Opportunity[Last Appt Before Contract Signed] = Event[Appt Date]))),     BLANK(),     Event[Opp Id] )"', N'CASE WHEN MAX(Opportunity.[Last_Appt_Before_Contract_Signed]) IS NULL THEN NULL ELSE Event.[Oppt_Id] END', N'[Opportunity]', N'Opportunity.[Id] = Event.[Opp_Id] AND Opportunity.[Last_Appt_Before_Contract_Signed] = Event.[Appt_Date]', 16, N'LEFT', N'Event.Opp_Id', N'Opp_Id', 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Contact_Lead_Source', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[LeadSource], Contact[Id], Event[WhoId])"', N'Contact.[LeadSource]', N'[Contact]', N'Contact.[Id] = Event.[WhoId]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Contact_State', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[MailingStateCode], Contact[Id], Event[WhoId])"', N'Contact.[MailingStateCode]', N'[Contact]', N'Contact.[Id] = Event.[WhoId]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Contract', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Contract Signed -CF], Opportunity[Id], Event[Opp Id])"', N'Opportunity.[Contract_Signed_CF]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Oppt_Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Contract_Signed', N'Case - Result', N'Column', N'"IF(Event[Contract] = 1 && Event[Last Appt] = Event[Start Date w/ DST] && Event[Outcomes (groups 1)] = ""Appointment Ran"", ""Signed"", BLANK())"', N'CASE WHEN Event.[Contract] = 1 AND Event.[Last_Appt_Date] = Event.[Appt_Date] 
AND Event.[Outcomes_groups_1] = ''Appointment Ran'' THEN ''Signed'' ELSE NULL END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Created_After_Ran', N'Case - Power of 1', N'Column', N'"IF(Event[CreatedDate] > Event[StartDateTime], 1 ,0)"', N'CASE WHEN Event.[CreatedDate] > Event.[StartDateTime] THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Created_By', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Name], User[Id], Event[CreatedById])"', N'[User].[Name]', N'[User]', N'[User].[Id] = Event.[CreatedById]', 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Created_Date_w/DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Event[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Event[CreatedDate]))  return IF(ISBLANK(Event[CreatedDate]), BLANK(), if(and(Event[CreatedDate] >= DST_Start, Event[CreatedDate] < DST_End), Event[CreatedDate] - (4/24), Event[CreatedDate] - (5/24)))"', N'Event.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Division', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Division__c], Opportunity[Id], Event[Opportunity__c])"', N'Opportunity.[Division__c]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Opportunity__c]', 7, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Event_End_Date_Time_w/DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Event[StartDateTime])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Event[StartDateTime]))  return IF(ISBLANK(Event[EndDateTime]), BLANK(), if(and(Event[EndDateTime] >= DST_Start, Event[EndDateTime] < DST_End), Event[EndDateTime] - (4/24), Event[EndDateTime] - (5/24)))"', N'Event.[StartDateTime] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Last_Appt_Date', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Max Appt], Opportunity[Id], Event[Opp Id])"', N'Opportunity.[Max_Appt]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Opp_Id]', 4, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead', N'Lookup', N'Column', N'"LOOKUPVALUE(''Lead''[Name], ''Lead''[Id], Event[Lead__c])"', N'[Lead].[Name]', N'Lead', N'Lead.[Id] = Event.[Lead__c]', 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead_Lead_Source', N'Lookup', N'Column', N'"LOOKUPVALUE(''Lead''[LeadSource], ''Lead''[Id], Event[Lead__c])"', N'Lead.[LeadSource]', N'Lead', N'Lead.[Id] = Event.[Lead__c]', 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead_Source', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Actual Lead Source], Opportunity[Id], Event[Opp Id])"', N'Opportunity.[Actual_Lead_Source]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Oppt_Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead_Source_Group', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Lead Source Lookup], Opportunity[Id], Event[Opp Id])"', N'Opportunity.[Lead_Source_Lookup]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Oppt_Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Lead_State', N'Lookup', N'Column', N'"LOOKUPVALUE(''Lead''[StateCode], ''Lead''[Id], Event[WhoId])"', N'Lead.[StateCode]', N'Lead', N'Lead.[Id] = Event.[WhoId]', 9, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Customer_Name', N'Case - Result', N'Column', N'"IF(not ISBLANK(LOOKUPVALUE(Contact[Name], Contact[Id], Event[WhoId])), LOOKUPVALUE(Contact[Name], Contact[Id], Event[WhoId]), LOOKUPVALUE(''Lead''[Name], ''Lead''[Id], Event[WhoId]))"', N'CASE WHEN Contact.[Name] IS NOT NULL THEN Contact.[Name] ELSE Lead.[Name] END', N'[Contact],[lead]', N'Contact.[Id]=Event.[WhoId],Lead.[Id]=Event.[WhoId]', 15, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Not_Updated_Appts', N'Case - Power of 1', N'Column', N'"IF(AND(Event[Event End Date Time w/DST]<DISTINCT(''Now''[Now w/ DST]),ISBLANK(Event[Outcome__c])), 1, 0)"', N'CASE WHEN Event.[Event_End_Date_Time_w_DST] < DISTINCT(Now.[Now_w_DST]) AND Event.[Outcome__c] IS NULL THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Office', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[Direct_Sales_Office__c], Opportunity[Id], Event[Opportunity__c])"', N'Opportunity.[Direct_Sales_Office__c]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Opportunity__c]', 7, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Oppt_Id', N'Case - Result', N'Column', N'"IF(     NOT(ISBLANK(Event[Opportunity__c])),     Event[Opportunity__c],     IF(         NOT(ISBLANK(Event[WhatId])) && LEFT(Event[WhatId], 3) = ""006"",         Event[WhatId],         BLANK()     ) )"', N'CASE WHEN Event.[Opportunity__c] IS NOT NULL THEN Event.[Opportunity__c]
WHEN Event.[WhatId] IS NOT NULL AND LEFT(Event.[WhatId],3) = ''006'' THEN Event.[WhatId] ELSE NULL END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Oppt_Stage', N'Lookup', N'Column', N'"LOOKUPVALUE(Opportunity[StageName], Opportunity[Id], Event[Opportunity__c])"', N'Opportunity.[StageName]', N'[Opportunity]', N'Opportunity.[Id] = Event.[Opportunity__c]', 7, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Outcome_Groups', N'Case - Result', N'Column', N'"IF(OR(SEARCH(""Appt Ran"", Event[Outcome__c],, BLANK() > 0), SEARCH(""Appt Run"", Event[Outcome__c],, BLANK() > 0)), ""Appt Ran"", IF(SEARCH(""Reschedule"", Event[Outcome__c],, BLANK() > 0), ""Rescheduled"", IF(SEARCH(""Cancelled"", Event[Outcome__c],, BLANK() > 0), ""Cancelled"", IF(not ISBLANK(Event[Outcome__c]), ""No Show"", BLANK()))))"', N'CASE WHEN Event.[Outcome__c] LIKE ''%Appt Ran%'' OR Event.[Outcome__c] LIKE ''%Appt Run%'' THEN ''Appt Ran''
WHEN Event.[Outcome__c] LIKE ''%Reschedule%'' THEN ''Rescheduled''
WHEN Event.[Outcome__c] LIKE ''%Cancelled%'' THEN ''Cancelled''
WHEN Event.[Outcome__c] IS NOT NULL THEN ''No Show'' ELSE NULL END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Outcomes', N'Case - Result', N'Column', N'"IF(Event[Not Updated Appts] = 1, ""Not Updated"", Event[Outcome__c])"', N'CASE WHEN Event.[Not_Updated_Appts] = 1 THEN ''Not Updated''  ELSE Event.[Outcome__c] END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Referral_and_Self_Gen_Appts_Ran', N'Case - Result', N'Column', N'"IF(     Event[Outcome__c (groups)] = ""Ran"" && (SEARCH(""Referral"", Event[Lead Source Group],,BLANK())>0 || SEARCH(""Self Gen"", Event[Lead Source Group],, BLANK())>0),     Event[Opp Id],     BLANK() )"', N'CASE WHEN Event.[Outcome__c_groups] = ''Ran'' AND (Event.[Lead_Source_Group] LIKE ''%Referral%'' OR 
Event.[Lead_Source_Group] LIKE ''%Self Gen%'')  THEN Event.[Oppt_Id] ELSE NULL END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Referral_Appts_Ran', N'Case - Result', N'Column', N'"IF(     Event[Outcome__c (groups)] = ""Ran"" && SEARCH(""Referral"", Event[Lead Source Group],,BLANK())>0,     Event[Opp Id],     BLANK() )"', N'CASE WHEN Event.[Outcome__c_groups] = ''Ran'' AND Event.[Lead_Source_Group] LIKE ''%Referral%''
THEN Event.[Oppt_Id] ELSE NULL END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Rep_Assigned', N'Case - Result', N'Column', N'"IF(     Event[Source] = ""Opp"",      Event[Trinity_Salesperson__c],       IF(         ISBLANK(Event[OwnerId]),         BLANK(),         LOOKUPVALUE(Contact[Id], Contact[User_Id__c], Event[OwnerId])     ) )"', N'CASE WHEN Event.[Source] = ''Opp'' THEN Event.[Trinity_Salesperson__c]
WHEN Event.[OwnerId] IS NULL THEN NULL END', N'[Contact]', N'Contact.[User_Id__c] = Event.[OwnerId]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Sales_State', N'Case - Result', N'Column', N'"IF(     Event[Assigned To Office] = ""(Blank)"",     BLANK(),     IF(         Event[Assigned To Office] = ""MA- RI"",         ""RI"",         LEFT(Event[Assigned To Office], 2)     ) )"', N'CASE WHEN Event.[Assigned_To_Office] = ''Blank'' THEN NULL 
WHEN Event.[Assigned_To_Office] = ''MA- RI'' THEN ''RI'' ELSE LEFT(Event.[Assigned_To_Office],2) END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Scheduled_Future_Appts', N'Case - Power of 1', N'Column', N'"IF(AND(Event[Event End Date Time w/DST]>=DISTINCT(''Now''[DateTime Now]),ISBLANK(Event[Outcome Groups])), 1, 0)"', N'CASE WHEN Event.[Event_End_Date_Time_w_DST] >= DISTINCT(Now.[DateTime_Now]) AND Event.[Outcome Groups] IS NULL THEN 1 ELSE 0 END', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'State', N'Case - Result', N'Column', N'"IF(not ISBLANK(Event[Contact State]), Event[Contact State], Event[Lead State])"', N'CASE WHEN Event.[Contact_State] IS NOT NULL THEN Event.[Contact_State] ELSE Event.[Lead_State] END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Unassigned_Appt', N'Case - Result', N'Column', N'"IF(     SEARCH(""Trinity Solar"", Event[Assigned To],, BLANK()) > 0 ||     SEARCH(""Trinity Direct"", Event[Assigned To],, BLANK()) > 0 ||     SEARCH(""Inside Sales"", Event[Assigned To],, BLANK()) > 0 ||     SEARCH(""aaa"", Event[Assigned To],, BLANK()) > 0 ||     Event[Assigned To] = BLANK(),     ""Unassigned"",     ""Assigned"" )"', N'CASE WHEN Event.[Assigned_To] LIKE ''%Trinity Solar%'' OR Event.[Assigned_To] LIKE ''Trinity Direct'' OR 
Event.[Assigned_To] LIKE ''%Inside Sales%'' OR Event.[Assigned_To] LIKE ''%aaa%'' OR Event.[Assigned_To] IS NULL
THEN ''Unassigned'' ELSE ''Assigned'' END', NULL, NULL, 13, NULL, NULL, NULL, 2)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Appts Cancelled', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Cancelled""))), 0, CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Cancelled"")))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Appts No Show', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""No Show""))), 0, CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""No Show"")))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Appts Not Updated', N'Count', N'Measure', N'"CALCULATE(COUNT( Event[Id]), FILTER(Event, Event[Outcomes (groups 1)] = ""Appointment Not Updated"") ,USERELATIONSHIP(Event[Opp Id],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], Event[Start Date w/ DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Appts Ran', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Appt Ran""))), 0, CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Appt Ran"")))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Appts Rescheduled', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Rescheduled""))), 0, CALCULATE(COUNT(Event[Id]), FILTER(Event, Event[Outcome Groups] = ""Rescheduled"")))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Cancelled %', N'Divide', N'Measure', N'"IF([#Appts Cancelled] = BLANK(), 0, [#Appts Cancelled] / [#Total Appts Past])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Chained Contracts', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNTNOBLANK(Event[Chained Contract]), USERELATIONSHIP(''Date''[Date], Event[Appt Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Close Ratio', N'Divide', N'Measure', N'"IF([#Contracts] = BLANK(), 0, [#Contracts] / [#Opportunities w/ Appts Ran])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Contracts', N'Distinct Count', N'Measure', N'"IF(CALCULATE(DISTINCTCOUNT(Event[Opportunity__c]), FILTER(Opportunity, Opportunity[Contract_Signed__c] = 1), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id]))=BLANK(),0,CALCULATE(DISTINCTCOUNT(Event[Opportunity__c]), FILTER(Opportunity, Opportunity[Contract_Signed__c] = 1), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Count Rows', N'Count', N'Measure', N'COUNTROWS(Event)', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Distinct Appts Ran', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNTNOBLANK(Event[Appts Ran]), USERELATIONSHIP(Event[Appt Date], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Distinct Referral Appts Ran', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNTNOBLANK(Event[Referral Appts Ran]), USERELATIONSHIP(Event[Appt Date], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Distinct Referral Self Gen Appts Ran', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNTNOBLANK(Event[Referral and Self Gen Appts Ran]), USERELATIONSHIP(Event[Appt Date], ''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Event Close %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Event Contracts], [#Appts Ran], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Event Contracts', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Event[Opp Id]), FILTER(Event, Event[Contract Signed] = ""Signed""), USERELATIONSHIP(''Date''[Date], Event[Start Date w/ DST]), USERELATIONSHIP(Event[Opp Id], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Event Contracts  Dupes', N'Count', N'Measure', N'"CALCULATE(COUNT(Event[Opp Id]), FILTER(Event, Event[Contract Signed] = ""Signed""), USERELATIONSHIP(''Date''[Date], Event[Start Date w/ DST]), USERELATIONSHIP(Event[Opp Id], Opportunity[Id]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#No Show %', N'Divide', N'Measure', N'"IF([#Appts No Show] = BLANK(), 0, [#Appts No Show] / [#Total Appts Past])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Not Updated Appts', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]),FILTER(Event,Event[Event End Date Time w/DST]<DISTINCT(''Now''[Now w/ DST])),FILTER(Event,ISBLANK(Event[Outcome Groups])))), 0, CALCULATE(COUNT(Event[Id]),FILTER(Event,Event[Event End Date Time w/DST]<DISTINCT(''Now''[Now w/ DST])),FILTER(Event,ISBLANK(Event[Outcome Groups]))))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Opportunities w/ Appts', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Event[Opportunity__c]), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Opportunities w/ Appts Completed', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Event[Opportunity__c]), FILTER(Opportunity, Opportunity[Appointment_Completed__c] = 1), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Opportunities w/ Appts Ran', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Event[Opportunity__c]), FILTER(Event, Event[Outcome Groups] = ""Appt Ran""), USERELATIONSHIP(Event[Opportunity__c], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Rank Appt Created', N'Rank', N'Measure', N'"RANKX(ALLSELECTED(Event[Created By]), [#Total Appts],,DESC, Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Rank Contracts', N'Rank', N'Measure', N'"RANKX(ALLSELECTED(Event[Assigned]),[#Contracts],,DESC,Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Rank Not Updated', N'Rank', N'Measure', N'"RANKX(ALLSELECTED(Event[Assigned]), [#Not Updated Appts],,DESC, Dense)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Referral %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Distinct Referral Appts Ran], [#Distinct Appts Ran], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Referral Self Gen %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Distinct Referral Self Gen Appts Ran], [#Distinct Appts Ran], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Rescheduled %', N'Divide', N'Measure', N'"IF([#Appts Rescheduled] = BLANK(), 0, [#Appts Rescheduled] / [#Total Appts Past])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Sched Future Appts', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]),FILTER(Event,Event[Event End Date Time w/DST]>=DISTINCT(''Now''[Now w/ DST])),FILTER(Event,ISBLANK(Event[Outcome Groups])))), 0, CALCULATE(COUNT(Event[Id]),FILTER(Event,Event[Event End Date Time w/DST]>=DISTINCT(''Now''[Now w/ DST])),FILTER(Event,ISBLANK(Event[Outcome Groups]))))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Sit%', N'Divide', N'Measure', N'"DIVIDE([#Appts Ran],[#Total Events],0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Total Appts', N'Count', N'Measure', N'COUNT(Event[Id])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Total Appts Past', N'Count', N'Measure', N'"IF(ISBLANK(CALCULATE(COUNT(Event[Id]), FILTER(Event, not ISBLANK(Event[Outcome Groups])), FILTER(Event, Event[Event End Date Time w/DST] < DISTINCT(''Now''[Now w/ DST])))), 0, CALCULATE(COUNT(Event[Id]), FILTER(Event, not ISBLANK(Event[Outcome Groups])), FILTER(Event, Event[Event End Date Time w/DST] < DISTINCT(''Now''[Now w/ DST]))))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'#Total Events', N'Count', N'Measure', N'"CALCULATE(COUNT( Event[Id]), USERELATIONSHIP(Event[Opp Id],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], Event[Start Date w/ DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Now', N'Date', N'Measure', N'NOW()', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Business_Days_In_Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Closed_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Days_in_Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'LastModifiedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Operations_Responsible__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Original_Project_Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Rep_Responsible__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Resolution_Specialist__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Responsible_Party__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Under_Rep_Control__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'Under_Rep_Control_Count__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'A_B_Timeline__Not_Rep_Control', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE() && ''Project Track''[Track__c] <> ""C"" && ''Project Track''[Under_Rep_Control_Count__c] = 0, 1, 0)"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 AND Project_Track.[Track__c] <> ''C'' AND 
Project_Track.[Under_Rep_Control_Count__c] = 0 THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Business_Days_in_Track', N'Calculation', N'Column', N'"IF(ISBLANK(''Project Track''[Date to Close]), BLANK(), CALCULATE(     COUNTROWS(''Date''),     DATESBETWEEN(''Date''[Date], ''Project Track''[Created Date w/ DST], ''Project Track''[Date to Close] -1),     ''Date''[Working Day] = 1,     ALL(''Project Track'') )+0)"', N'isnull(CASE WHEN Project_Track.[Date_to_Close] IS NULL THEN NULL ELSE count(Date_Table.[Date]) END,0)', N'Date_Table', N'Date_Table.Date >= Project_Track.[Created_Date_w/_DST] and Date_Table.[Date] <= Project_Track.[Date_to_Close] -1  and Date_Table.[Working_Day]=1', 2, NULL, N'Project_Track.Date_to_Close,Project_Track.[Created_Date_w/_DST]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Closed_Track', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Status__c] = ""Closed"", 1, 0)"', N'CASE WHEN Project_Track.[Status__c] = ''Closed'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Created_By', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Name], User[Id], ''Project Track''[CreatedById])"', N'[User].[Name]', N'[User]', N'Project_Track.[CreatedById]= [User].[Id]', 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Created_Date_w/_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Project Track''[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Project Track''[CreatedDate]))  return IF(ISBLANK(''Project Track''[CreatedDate]), BLANK(), if(and(''Project Track''[CreatedDate] >= DST_Start, ''Project Track''[CreatedDate] < DST_End), ''Project Track''[CreatedDate] - (4/24), ''Project Track''[CreatedDate] - (5/24)))"', N'Project_Track.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Date_to_Close', N'Case - Result', N'Column', N'"IF(     ISBLANK(''Project Track''[Closed_Date__c]) && ''Project Track''[Status__c] = ""Open"",     TODAY(),     ''Project Track''[Closed_Date__c] )"', N'CASE WHEN Project_Track.[Closed_Date__c] IS NULL AND Project_Track.[Status__c] = ''Open'' 
THEN GETDATE() ELSE Project_Track.[Closed_Date__c] END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Last_Modified_By', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Name], User[Id], ''Project Track''[LastModifiedById])"', N'[User].[Name]', N'[User]', N'Project_Track.[LastModifiedById]= [User].[Id]', 5, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Oppt_Reason_Lost', N'Lookup', N'Column', N'RELATED(Opportunity[Reason_Lost__c])', N'Opportunity.[Reason_Lost__c]', N'Opportunity', N'Project_Track.[Opportunity__c] = Opportunity.[Id]', 3, NULL, NULL, NULL, 1)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Change_Order', N'Case - Power of 1', N'Column', N'"IF(SEARCH(""Change Order Needed - No Signatures"",''Project Track''[Operations_Responsible__c],,BLANK()) >0,1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Change Order Needed - No Signatures%'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Electrical', N'Case - Power of 1', N'Column', N'"IF(SEARCH(""Electrical Issue Found"",''Project Track''[Operations_Responsible__c],,BLANK()) >0,1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Electrical Issue Found%'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Installs_Timeline', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE() && ''Project Track''[Track__c] = ""C"" && ''Project Track''[Under_Rep_Control_Count__c] = 0, 1, 0)"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 AND Project_Track.[Track__c] = ''C'' AND
Project_Track.[Under_Rep_Control_Count__c] = 0 THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Oversized', N'Case - Power of 1', N'Column', N'"IF(SEARCH(""Oversized"",''Project Track''[Operations_Responsible__c],,BLANK()) >0,1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Oversized%'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_RSA', N'Case - Power of 1', N'Column', N'"IF(SEARCH(""RSA"",''Project Track''[Operations_Responsible__c],,BLANK()) >0,1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%RSA%'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Structural', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Missing Structural Photos - No Access"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0,  SEARCH(""Structural Issue Found"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0), 1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Missing Structural Photos - No Access%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Structural Issue Found%'' THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_A_or_B', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE() && OR(''Project Track''[Track__c] = ""A"", ''Project Track''[Track__c] = ""B""), 1, 0)"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 AND (Project_Track.[Track__c] = ''A'' OR 
Project_Track.[Track__c] = ''B'' ) THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_PSA', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Full PSA"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0,  OR(SEARCH(""Groundmount"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Roof Dimensions"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Shade Analysis"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Sunrun Photos"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""SunRun Shade Analysis"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""State Incentive Photos"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Eagleview Not Available"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, SEARCH(""Eagleview Not Correct"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0)))))))),  1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Full PSA%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Groundmount%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Roof Dimensions%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Shade Analysis%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Sunrun Photos%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%SunRun Shade Analysis%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%State Incentive Photos%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Eagleview Not Available%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Eagleview Not Correct%'' 
THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Added_Days', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE() && ''Project Track''[Under_Rep_Control_Count__c] = 1, 1, 0)"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 AND Project_Track.[Under_Rep_Control_Count__c]=1 THEN 1 ELSE NULL END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Projects Submitted Contract Signed', N'Count', N'Measure', N'"CALCULATE(COUNT(''Project Track''[Id]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Projects Tracked Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Additional Forms', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Additional Forms]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Additional Forms %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Additional Forms], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Ops_Responsible_Special', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Remove and Replace"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0,  OR(SEARCH(""Critter Guards"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Skirts"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Increase Referral"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Overhead Wires"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Snow Guards"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Request"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Customer to ReRoof"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Customer to Cut Trees"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, OR(SEARCH(""Trinity to ReRoof"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0, SEARCH(""Trinity to Cut Trees"", ''Project Track''[Operations_Responsible__c],, BLANK() ) > 0)))))))))),  1,0)"', N'CASE WHEN Project_Track.[Operations_Responsible__c] LIKE ''%Remove and Replace%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Critter Guards%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Skirts%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Increase Referral%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Overhead Wires%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Snow Guards%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Request%'' OR 
Project_Track.[Operations_Responsible__c] LIKE ''%Customer to ReRoof%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Customer to Cut Trees%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Trinity to ReRoof%'' OR
Project_Track.[Operations_Responsible__c] LIKE ''%Trinity to Cut Trees%'' 
THEN 1 ELSE 0 END ', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_Track', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE(), 1, 0)"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 THEN 1 ELSE 0 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_Track_A', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Track__c] = ""A"" && ''Project Track''[Original_Project_Track__c] = TRUE(), 1, 0)"', N'CASE WHEN Project_Track.[Track__c] = ''A'' AND Project_Track.[Original_Project_Track__c] = 1 THEN 1 ELSE 0 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_Track_B', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Track__c] = ""B"" && ''Project Track''[Original_Project_Track__c] = TRUE(), 1, 0)"', N'CASE WHEN Project_Track.[Track__c] = ''B'' AND Project_Track.[Original_Project_Track__c] = 1 THEN 1 ELSE 0 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_Track_C', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Track__c] = ""C"" && ''Project Track''[Original_Project_Track__c] = TRUE(), 1, 0)"', N'CASE WHEN Project_Track.[Track__c] = ''C'' AND Project_Track.[Original_Project_Track__c] = 1 THEN 1 ELSE 0 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Original_Track_Under_Rep_Control', N'Case - Result', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] = TRUE(), ''Project Track''[Under_Rep_Control_Count__c], BLANK())"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 THEN Project_Track.[Under_Rep_Control_Count__c] ELSE NULL END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Original_Project_Track_C', N'Case - Result', N'Column', N'"IF(     ''Project Track''[Original_Project_Track__c] = TRUE() && ''Project Track''[Under_Rep_Control_Count__c] = 1 && ''Project Track''[Track__c] = ""C"",     ''Project Track''[Business Days in Track],     BLANK() )"', N'CASE WHEN Project_Track.[Original_Project_Track__c]=1 AND Project_Track.[Under_Rep_Control_Count__c] = 1 
and Project_Track.[Track__c] = ''C'' THEN Project_Track.[Business_Days_in_Track] ELSE NULL END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Additional Forms % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Additional Forms Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Additional_Forms', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""No Combined Packet"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""State Form Missing Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""State Form Wrong Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""All Combined Packet Signatures Missing"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Combined Packet Sig Discrepancy"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Interconnection Missing Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Interconnection Wrong Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""AHJ Authorization Form Missing Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""AHJ Authorization Form Wrong Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""HOA Form Missing Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""HOA Form Wrong Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Disclosure Form Wrong Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Disclosure Form Missing Signature"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0)))))))))))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%No Combined Packet%'' OR 
Project_Track.[Under_Rep_Control__c] LIKE ''%State Form Missing Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%State Form Wrong Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%All Combined Packet Signatures Missing%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Combined Packet Sig Discrepancy%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Interconnection Missing Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Interconnection Wrong Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%AHJ Authorization Form Missing Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%AHJ Authorization Form Wrong Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%HOA Form Missing Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%HOA Form Wrong Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Disclosure Form Wrong Signature%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Disclosure Form Missing Signature%'' 
THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible PSA', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible PSA]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible RSA', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible RSA]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible Special', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible Special]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible Structural', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible Structural]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Projects Submitted', N'Count', N'Measure', N'"CALCULATE(COUNT(''Project Track''[Id]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Additional Forms Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Additional Forms]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Contract_Issues', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Trinity Contract Not Complete"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""Wrong Trinity Contract Signatures"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Sales Countersig"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Finance Partner Contract"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Trinity Contract"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Customer Cancelled Contract"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Contract resign Needed"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Partner Cancelled Contract"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0))))))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%Trinity Contract Not Complete%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Wrong Trinity Contract Signatures%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Sales Countersig%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Finance Partner Contract%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Trinity Contract%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Customer Cancelled Contract%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Contract resign Needed%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Partner Cancelled Contract%''
THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Electric Bill %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Electric Bill], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Electric Bill % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Electric Bill Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Electric Bill Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Electric Bill Issues]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Finance %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Finance Issues], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Finance % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Finance Issues Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Design_Issues', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Direct Layout Not Signed"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""Design Intent N/A"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Oversized - Utility"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Oversized - Finance"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Oversized - State"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0)))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%Direct Layout Not Signed%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Design Intent N/A%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Oversized - Utility%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Oversized - Finance%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Oversized - State%'' 
THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Electric_Bill_Issues', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""No Bill"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""Bill Not Clear"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Bill Missing Customer Info"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Bill Missing Usage"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Bill Too Old"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Bill Name Discrepancy"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Load Calc Needed"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0)))))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%No Bill%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Bill Not Clear%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Bill Missing Customer Info%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Bill Missing Usage%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Bill Too Old%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Bill Name Discrepancy%'' OR  Project_Track.[Under_Rep_Control__c] LIKE ''%Load Calc Needed%''   THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Finance_Issues', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""ACH Not Complete"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""Credit Not Approved"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Title Not Approved"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Validation Call Not Complete"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%ACH Not Complete%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Credit Not Approved%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Title Not Approved%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Validation Call Not Complete%''   
THEN 1 ELSE 0 END ', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Not_CF', N'Case - Power of 1', N'Column', N'"IF(''Project Track''[Opp Reason Lost] = ""Financial - Credit Reject"", 0, 1)"', N'CASE WHEN Project_Track.[Oppt_Reason_Lost]=''Financial - Credit Reject'' THEN 0 ELSE 1 END ', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Rep_Control_Photo_Issues', N'Case - Power of 1', N'Column', N'"IF(OR(SEARCH(""Missing All Photos"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0,  OR(SEARCH(""Missing Main Panel Photos"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Meter Photos"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Front of Home Photo"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Detached Structure Photo"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Missing Other Photos"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, OR(SEARCH(""Site Capture Not Used"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0, SEARCH(""Missing Structural Photos"", ''Project Track''[Under_Rep_Control__c],, BLANK() ) > 0))))))), 1, 0)"', N'CASE WHEN Project_Track.[Under_Rep_Control__c] LIKE ''%Missing All Photos%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Main Panel Photos%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Meter Photos%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Front of Home Photo%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Detached Structure Photo%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Other Photos%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Site Capture Not Used%'' OR
Project_Track.[Under_Rep_Control__c] LIKE ''%Missing Structural Photos%''
THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible Change Order', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible Change Order]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible Electrical', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible Electrical]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Ops Responsible Oversized', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Ops Responsible Oversized]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'project_track', N'Track_C_Resolution_Review', N'Case - Result', N'Column', N'"IF(''Project Track''[Original_Project_Track__c] <> TRUE() || ''Project Track''[Track__c] <> ""C"", BLANK(),  IF(CALCULATE(SUM(''Action Item''[Action Item Business Days]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review"")) < 6, ""<6 Days"", IF(CALCULATE(SUM(''Action Item''[Action Item Business Days]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review"")) >= 6 && CALCULATE(SUM(''Action Item''[Action Item Business Days]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review"")) <=11, ""6-11 Days"",  IF(CALCULATE(SUM(''Action Item''[Action Item Business Days]), FILTER(''Action Item'', ''Action Item''[AI_Template_Name__c] = ""Resolutions Review"")) > 11, "">11 Days"", BLANK()))))"', N'CASE WHEN Project_Track.[Original_Project_Track__c] = 1 OR Project_Track.[Track__c] <> ''C'' THEN NULL
WHEN SUM(Action_Item.[Action_Item_Business_Days]) < 6 THEN ''<6 Days''
WHEN SUM(Action_Item.[Action_Item_Business_Days]) >=6 AND SUM(Action_Item.[Action_Item_Business_Days]) <=11 THEN ''6-11 Days''
WHEN SUM(Action_Item.[Action_Item_Business_Days]) >11  THEN ''>11 Days'' ELSE NULL END', N'Action_Item', N'Action_Item.[AI_Template_Name__c] = ''Resolutions Review''', 7, NULL, N'Project_Track.[Original_Project_Track__c],Project_Track.[Track__c]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Avg Business Days on Track C', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Project Track''[RC OPT C]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Contract Issues', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Contract Issues]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Contract Issues %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Contract Issues], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Contract Issues % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Contract Issues Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Contract Issues Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Contract Issues]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Design %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Design Issues], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Design % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Design Issues Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Design Issues', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Design Issues]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Design Issues Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Design Issues]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Electric Bill', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Electric Bill Issues]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Finance Issues', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Finance Issues]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Finance Issues Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Finance Issues]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Photo %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Photo Issues], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Photo % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#RC Photo Issues Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Photo Issues', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Photo Issues]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#RC Photo Issues Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Rep Control Photo Issues]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Rep Control %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Rep Control Count], [#Projects Submitted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Rep Control % Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Rep Control Count Contract Signed], [#Projects Submitted Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Resolution A&B Tracking Biz Seconds', N'Multiply', N'Measure', N'CALCULATE(''Project Track''[#Track A&B Biz Days Created Date]*86400)', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Resolution C Tracking Biz Seconds', N'Multiply', N'Measure', N'CALCULATE(''Project Track''[#Track C Biz Days Closed Date]*86400)', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Resolution Tracking A&B Biz Timeline Text Created Date', N'Format', N'Measure', N'"var vSeconds=[#Resolution A&B Tracking Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Resolution Tracking C Biz Timeline Text', N'Format', N'Measure', N'"var vSeconds=[#Resolution C Tracking Biz Seconds] var vMinutes=int( vSeconds/60) var vRemainingSeconds=MOD(vSeconds, 60) var vHours=INT(vMinutes/60) var vRemainingMinutes=MOD(vMinutes,60) var vDays=INT(vHours/24) var vRemainingHours=MOD(vHours,24) return IF(VALUE(vHours)=0,   vRemainingMinutes&"" Minutes."", IF(VALUE(vDays)=0,   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes."",   vDays&"" Days, ""&   vRemainingHours&"" Hours and ""&   vRemainingMinutes&"" Minutes.""))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Resolved Track C Projects Closed Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Closed Track]), USERELATIONSHIP(''Project Track''[Closed_Date__c],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Total Rep Control Count', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Under_Rep_Control_Count__c]), FILTER(''Project Track'', ''Project Track''[Original_Project_Track__c] = TRUE()))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Total Rep Control Count Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track Under Rep Control]), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date])) "', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track A Submission %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Track A Submissions Created Date],[#Projects Tracked Created Date],0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track A Submissions Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track A]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track A&B Biz Days Created Date', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Resolutions Start to End]), FILTER(''Project Track'',''Project Track''[Original A or B] = 1), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track B Submission %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Track B Submissions Created Date],[#Projects Tracked Created Date],0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track B Submissions Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track B]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track C Biz Days Closed Date', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Resolutions Start to End]), USERELATIONSHIP(''Project Track''[Closed_Date__c],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track C Biz Days Contract Signed', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Action Item Business Days]), FILTER(''Action Item'',''Action Item''[AI_Template_Name__c]=""Resolutions Review""),FILTER(''Project Track'', ''Project Track''[Original Track C] =1), USERELATIONSHIP(Opportunity[Date_Contract_Signed__c],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track C Biz Days Created Date', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Action Item''[Action Item Business Days]), FILTER(''Action Item'',''Action Item''[AI_Template_Name__c]=""Resolutions Review""),FILTER(''Project Track'',''Project Track''[Original_Project_Track__c]=TRUE()), FILTER(''Project Track'',''Project Track''[Track__c]=""C""),USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track C Submission % Created Date', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Track C Submissions Created Date],[#Projects Tracked Created Date],0))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Project Track', N'#Track C Submissions Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Project Track''[Original Track C]), USERELATIONSHIP(''Project Track''[Created Date w/ DST],''Date''[Date]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'AccountId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'ActivityDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Outcome__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'OwnerId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Reason_Lost__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Status', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Subject', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'WhatId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'WhoId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Caller', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Name], User[Id], Task[OwnerId])"', N'[User].[Name]', N'[User]', N'[Task].[OwnerId]=[User].[Id]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Caller_Division', N'Case - Result', N'Column', N'"IF(Task[OwnerId] = ""00560000000ysRBAAY"", ""Call Center"", LOOKUPVALUE(User[Contact Division], User[Id], Task[OwnerId]))"', N'CASE WHEN Task.[OwnerId] = ''00560000000ysRBAAY'' THEN ''Call Center'' ELSE [User].[Contact_Division] END', N'[User]', N'[Task].[OwnerId]=[User].[Id]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Caller_Office', N'Lookup', N'Column', N'"LOOKUPVALUE(User[Contact Office], User[Id], Task[OwnerId])"', N'[User].[Contact_Office]', N'[User]', N'[Task].[OwnerId]=[User].[Id]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Contact_Id', N'Case - Result', N'Column', N'"IF(ISBLANK(Task[WhatId]), Task[WhoId], LOOKUPVALUE(Opportunity[Primary_Contact__c], Opportunity[Id], Task[WhatId]))"', N'CASE WHEN Task.[WhatId] IS NULL THEN Task.[WhoId] ELSE Opportunity.[Primary_Contact__c] END', N'Opportunity', N'Opportunity.[Id]= Task.[WhatId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Created_Date_Time_w/DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Task[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Task[CreatedDate]))  return IF(ISBLANK(Task[CreatedDate]), BLANK(), if(and(Task[CreatedDate] >= DST_Start, Task[CreatedDate] < DST_End), Task[CreatedDate] - (4/24), Task[CreatedDate] - (5/24)))"', N'Task.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Assigned', N'Count', N'Measure', N'"CALCULATE(COUNT(Task[Id]), USERELATIONSHIP(Callers[OwnerId], Task[OwnerId]), USERELATIONSHIP(''Date''[Date], Task[Created Date Time w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Assigned Distinct', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Task[WhatId]), USERELATIONSHIP(Task[OwnerId], Callers[OwnerId]), USERELATIONSHIP(''Date''[Date], Task[Created Date Time w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Close Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Contracts Signed],[#COVID Calls Demos Completed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Completed', N'Count', N'Measure', N'"CALCULATE(COUNT(Task[Id]),  FILTER(Task, Task[Status] = ""Completed""), USERELATIONSHIP(Callers[OwnerId], Task[OwnerId]), USERELATIONSHIP(''Date''[Date], Task[Created Date Time w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Completed Distinct', N'Distinct Count', N'Measure', N'"CALCULATE(DISTINCTCOUNT(Task[WhatId]),  FILTER(Task, Task[Status] = ""Completed""), USERELATIONSHIP(Callers[OwnerId], Task[OwnerId]), USERELATIONSHIP(''Date''[Date], Task[Created Date Time w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Completed to Lead Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Leads Created],[#COVID Calls Completed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Completion Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Completed],[#COVID Calls Assigned],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Completion Ratio Distinct', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Completed Distinct],[#COVID Calls Assigned Distinct],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Contracts Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract_Signed__c]),  FILTER(''Lead'', ''Lead''[Call Referred] = 1), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Contracts w Install Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Contracts With Install] , [#COVID Calls Contracts Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Demos Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appt_Completed__c]), FILTER(''Lead'', ''Lead''[Call Referred] = 1), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Demos Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Demo Scheduled]), FILTER(''Lead'', ''Lead''[Call Referred] = 1),USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Demos Total', N'Sum', N'Measure', N'CALCULATE([#COVID Calls Demos Completed]+[#COVID Calls Demos Scheduled])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Install Scheduled Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Contracts With Install], [#COVID Calls Completed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Install Started', N'Count', N'Measure', N'"CALCULATE(COUNT(Opportunity[Id]),  FILTER(''Lead'', ''Lead''[Call Referred] = 1), FILTER(Opportunity, Opportunity[Actual_Install_Date__c] <= TODAY() && not ISBLANK(Opportunity[Actual_Install_Date__c])), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Lead to Demo Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Demos Total],[#COVID Calls Lead Converted to Opportunity],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'#COVID Calls Not Completed', N'Count', N'Measure', N'"CALCULATE(COUNT(Task[Id]), FILTER(Task, Task[Status] <> ""Completed""), USERELATIONSHIP(Callers[OwnerId], Task[OwnerId]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Duplicates', N'Count', N'Measure', N'CALCULATE(COUNT(Task[Id]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'First Date Range', N'Date', N'Measure', N'MIN(Task[ActivityDate])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Task', N'Last Date Range', N'Date', N'Measure', N'MAX(Task[ActivityDate])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Contact_Division', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Division__c], Contact[User_Id__c], User[Id])"', N'Contact.[Sales_Division__c]', N'[Contact]', N'Contact.[User_Id__c]=[User].[Id]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Contact_Office', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Office__c], Contact[User_Id__c], User[Id])"', N'Contact.[Sales_Office__c]', N'[Contact]', N'Contact.[User_Id__c]=[User].[Id]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Scheduled_not_Completed_Days_Groups', N'Case - Result', N'Column', N'IF(ISBLANK(Opportunity[Scheduled not Completed Days]), BLANK(),
IF(Opportunity[Scheduled not Completed Days] < 15, "<15 Days",
IF(Opportunity[Scheduled not Completed Days] >= 15 && Opportunity[Scheduled not Completed Days] < 31, "15-30 Days",
IF(Opportunity[Scheduled not Completed Days] >= 31 && Opportunity[Scheduled not Completed Days] < 46, "31-45 Days",
IF(Opportunity[Scheduled not Completed Days] >= 46 && Opportunity[Scheduled not Completed Days] < 61, "46-60 Days",
IF(Opportunity[Scheduled not Completed Days] >=61 && Opportunity[Scheduled not Completed Days] < 91, "61-90 Days",
IF(Opportunity[Scheduled not Completed Days] >= 91 && Opportunity[Scheduled not Completed Days] < 121, "91-120 Days",
">120 Days")))))))', N'CASE WHEN Opportunity.[Scheduled_not_Completed_Days] IS NULL  THEN '' ''   
WHEN Opportunity.[Scheduled_not_Completed_Days]<15 THEN ''<15 Days'' 
WHEN Opportunity.[Scheduled_not_Completed_Days]>=15  AND Opportunity.[Scheduled_not_Completed_Days]<31 THEN  ''15-30 Days''  
WHEN Opportunity.[Scheduled_not_Completed_Days]>=31  AND Opportunity.[Scheduled_not_Completed_Days]<46 THEN  ''31-45 Days''  
WHEN Opportunity.[Scheduled_not_Completed_Days]>=46  AND Opportunity.[Scheduled_not_Completed_Days]<61 THEN  ''46-60 Days''  
WHEN Opportunity.[Scheduled_not_Completed_Days]>=61  AND Opportunity.[Scheduled_not_Completed_Days]<91 THEN  ''61-90 Days''  
WHEN Opportunity.[Scheduled_not_Completed_Days]>=91  AND Opportunity.[Scheduled_not_Completed_Days]<121 THEN ''91-120 Days''  
ELSE ''>120 Days'' END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Lead_Source', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[LeadSource], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[LeadSource]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Name', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Phone', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Phone], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Phone]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Do_Not_Call', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[DoNotCall], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[DoNotCall]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Eagleview_Status', N'Lookup', N'Column', N'"LOOKUPVALUE(Account[EagleView_Order_Status_Formula__c], Account[Id], Opportunity[AccountId])"', N'Account.[EagleView_Order_Status_Formula__c]', N'[Account]', N'Account.[Id]=Opportunity.[AccountId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Scheduled_not_Completed_Days', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Date__c]) && ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) && Opportunity[Actual_Install_Date__c] < TODAY(), TODAY() - Opportunity[Actual_Install_Date__c], BLANK())"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND   Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND 
Opportunity.[Actual_Install_Date__c] < GETDATE() THEN 
DATEDIFF(DAY, Opportunity.[Actual_Install_Date__c],GETDATE() ) ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Demo_Date_Time_w_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Opportunity[Demo_Date__c])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Opportunity[Demo_Date__c]))  return IF(ISBLANK(Opportunity[Demo_Date__c]), BLANK(), if(and(Opportunity[Demo_Date__c] >= DST_Start, Opportunity[Demo_Date__c] < DST_End), Opportunity[Demo_Date__c] - (4/24), Opportunity[Demo_Date__c] - (5/24))"', N'Opportunity.[Demo_Date__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PM_Groups', N'Case - Result', N'Column', N'"IF(SEARCH(""Loan"", Opportunity[Purchase_Method__c],, BLANK())>0 || SEARCH(""Sunlight Financial"", Opportunity[Purchase_Method__c],, BLANK())>0 || SEARCH(""Financed"", Opportunity[Purchase_Method__c],, BLANK())>0 || SEARCH(""Financing"", Opportunity[Purchase_Method__c],, BLANK())>0, ""Loan"",  IF(SEARCH(""Cash"", Opportunity[Purchase_Method__c],, BLANK())>0, ""Cash"", IF(SEARCH(""Sunnova"", Opportunity[Purchase_Method__c],, BLANK())>0 && SEARCH(""PPA"", Opportunity[Purchase_Method__c],, BLANK())>0, ""Sunnova PPA"", IF(SEARCH(""Sunnova"", Opportunity[Purchase_Method__c],, BLANK())>0 && SEARCH(""Lease"", Opportunity[Purchase_Method__c],, BLANK())>0, ""Sunnova Lease"", IF(SEARCH(""IGS"", Opportunity[Purchase_Method__c],, BLANK())>0, ""IGS"", IF(SEARCH(""Sunrun"", Opportunity[Purchase_Method__c],, BLANK())>0, ""Sunrun"", BLANK()))))))"', N'CASE WHEN Opportunity.[Purchase_Method__c] LIKE ''%Loan%''  OR 
    Opportunity.[Purchase_Method__c] LIKE ''%Sunlight Financial%''  OR  Opportunity.[Purchase_Method__c] LIKE ''%Financed%''  OR
	  Opportunity.[Purchase_Method__c] LIKE ''%Financing%'' THEN ''Loan''  WHEN Opportunity.[Purchase_Method__c] LIKE ''%Cash%''
	  THEN ''Cash''   WHEN Opportunity.[Purchase_Method__c] LIKE ''%Sunnova%''  AND  Opportunity.[Purchase_Method__c] LIKE ''%PPA%''
	  THEN ''Sunnova PPA''  WHEN Opportunity.[Purchase_Method__c] LIKE ''%Sunnova%''  AND  Opportunity.[Purchase_Method__c]
	   LIKE ''%Lease%'' THEN ''Sunnova Lease''  WHEN Opportunity.[Purchase_Method__c] LIKE ''%IGS%''  THEN ''IGS''
	     WHEN Opportunity.[Purchase_Method__c] LIKE ''%Sunrun%'' THEN ''Sunrun'' ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Scheduled_not_Completed', N'Case - Power of 1', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Date__c]) && ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) && Opportunity[Actual_Install_Date__c] < TODAY(), 1, 0)"', N'CASE WHEN Opportunity.[Actual_Install_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Date__c] < GETDATE() THEN  1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Less_Contract', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[X12_mos_PVWATTS_prod_Actual__c]) && not  ISBLANK(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]), Opportunity[X12_mos_PVWATTS_prod_Actual__c] -  Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c], BLANK())"', N'CASE WHEN Opportunity.[X12_mos_PVWATTS_prod_Actual__c] IS NOT NULL AND     Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c]  IS NOT NULL   THEN   Opportunity.[X12_mos_PVWATTS_prod_Actual__c] - Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c]     ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Primary_contact_Email', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Email], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[Email]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Email_Opt_Out', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[HasOptedOutOfEmail], Contact[Id], Opportunity[Primary_Contact__c])"', N'Contact.[HasOptedOutOfEmail]', N'[Contact]', N'Contact.[Id]=Opportunity.[Primary_Contact__c]', 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Employment_Status', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Employment_Status__c], Contact[Id], Opportunity[Trinity_Salesperson__c])"', N'Contact.[Employment_Status__c]', N'[Contact]', N'Contact.[Id]=Opportunity.[Trinity_Salesperson__c]', 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Referral_Caller', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], Opportunity[Lead_Generator__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id]=Opportunity.[Lead_Generator__c]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Referral_Caller_Division', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Division__c], Contact[Id], Opportunity[Lead_Generator__c])"', N'Contact.[Sales_Division__c]', N'[Contact]', N'Contact.[Id]=Opportunity.[Lead_Generator__c]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Rep_Division', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Division__c], Contact[Id], Opportunity[Trinity_Salesperson__c])"', N'Contact.[Sales_Division__c]', N'[Contact]', N'Contact.[Id]=Opportunity.[Trinity_Salesperson__c]', 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Complete_to_PTO_Days', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) &&  not ISBLANK(Opportunity[Date_Interconn_Approved__c]),  Opportunity[Date_Interconn_Approved__c] - Opportunity[Actual_Install_Complete_Date__c], BLANK())"', N'CASE WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND Opportunity.[Date_Interconn_Approved__c] IS NOT NULL   
THEN DATEDIFF(Day ,Opportunity.[Actual_Install_Complete_Date__c],Opportunity.[Date_Interconn_Approved__c]) ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Referral_Caller_Office', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Sales_Office__c], Contact[Id], Opportunity[Lead_Generator__c])"', N'Contact.[Sales_Office__c]', N'[Contact]', N'Contact.[Id]=Opportunity.[Lead_Generator__c]', 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Completed', N'Case - Power of 1', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Complete_Date__c]), 1, 0)"', N'CASE WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL THEN  1 ELSE  0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Scheduled_CF', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Install_Scheduled__c] = 1 && Opportunity[Reason_Lost__c] <> ""Financial - Credit Reject"", 1, 0)"', N' CASE WHEN Opportunity.[Install_Scheduled__c]=1 AND  Opportunity.[Reason_Lost__c] <> ''Financial - Credit Reject'' THEN  1 ELSE  0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installed', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Complete_Date__c]), ""Yes"" , ""No"")"', N'CASE WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LOI_Signed_Count', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Date_LOI_Signed__c]), ""Yes"" , ""No"")"', N'CASE WHEN Opportunity.[Date_LOI_Signed__c] IS NOT NULL THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contact_Email', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Email]), ""Yes"", ""No"")"', N'CASE WHEN Opportunity.[Primary_contact_Email] IS NOT NULL THEN ''Yes'' ELSE ''NO'' END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_to_Complete', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Actual_Install_Complete_Date__c]) && not ISBLANK(Opportunity[Actual_Install_Date__c]) && Opportunity[Actual_Install_Date__c] <= TODAY(), Opportunity[Actual_Install_Complete_Date__c] - Opportunity[Actual_Install_Date__c], BLANK())"', N'CASE WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND Opportunity.[Actual_Install_Date__c] IS NOT NULL  
AND Opportunity.[Actual_Install_Date__c] < = GETDATE() THEN   
 DATEDIFF(DAY ,Opportunity.[Actual_Install_Date__c],Opportunity.[Actual_Install_Complete_Date__c]) ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Complete_to_PTO_Group', N'Case - Result', N'Column', N'"IF(ISBLANK(Opportunity[Actual_Install_Complete_Date__c]), BLANK(), IF(AND(not ISBLANK(Opportunity[Actual_Install_Complete_Date__c]), ISBLANK(Opportunity[Date_Interconn_Approved__c])), ""Not PTO-d Yet"", IF(Opportunity[Actual_Install_Complete_Date__c] = Opportunity[Date_Interconn_Approved__c], ""Same Day"", IF(Opportunity[Complete to PTO] < 15, ""<15 Days"", IF(Opportunity[Complete to PTO] >= 15 && Opportunity[Complete to PTO] < 30, ""15-30 Days"", IF(Opportunity[Complete to PTO] >= 31 && Opportunity[Complete to PTO] < 46, ""31-45 Days"", IF(Opportunity[Complete to PTO] >= 46 && Opportunity[Complete to PTO] < 61, ""46-60 Days"", IF(Opportunity[Complete to PTO] >=61 && Opportunity[Complete to PTO] < 90, ""61-90 Days"", IF(Opportunity[Complete to PTO] >= 91 && Opportunity[Complete to PTO] < 121, ""91-120 Days"", "">120 Days"")))))))))"', N'CASE WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NULL THEN NULL    WHEN Opportunity.[Actual_Install_Complete_Date__c] IS NOT NULL AND Opportunity.[Date_Interconn_Approved__c] IS NOT NULL THEN ''Not PTO-d Yet''  WHEN Opportunity.[Actual_Install_Complete_Date__c] = Opportunity.[Date_Interconn_Approved__c] THEN ''Same Day''  WHEN Opportunity.[Complete_to_PTO_Days] < 15 THEN ''<15 Days''     WHEN Opportunity.[Complete_to_PTO_Days] >= 15 AND  Opportunity.[Complete_to_PTO_Days] < 30 THEN ''15-30 Days''  WHEN Opportunity.[Complete_to_PTO_Days] >= 31 AND  Opportunity.[Complete_to_PTO_Days] < 46 THEN ''31-45 Days''  WHEN Opportunity.[Complete_to_PTO_Days] >= 46 AND  Opportunity.[Complete_to_PTO_Days] < 61 THEN ''46-60 Days''  WHEN Opportunity.[Complete_to_PTO_Days] >=61  AND  Opportunity.[Complete_to_PTO_Days] < 90 THEN ''61-90 Days''  WHEN Opportunity.[Complete_to_PTO_Days] >= 91 AND  Opportunity.[Complete_to_PTO_Days] < 121 THEN ''91-120 Days''  ELSE  ''>120 Days'' END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_to_Install_Days', N'Case - Result', N'Column', N'"IF(not ISBLANK(Opportunity[Date_Contract_Signed__c]) && not ISBLANK(Opportunity[Actual_Install_Date__c]), Opportunity[Actual_Install_Date__c] - Opportunity[Date_Contract_Signed__c], BLANK())"', N'CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NOT NULL AND Opportunity.[Actual_Install_Date__c] IS NOT NULL THEN    
DATEDIFF(DAY, Opportunity.[Date_Contract_Signed__c],Opportunity.[Actual_Install_Date__c] ) ELSE NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Created_Date_Time_w_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Opportunity[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Opportunity[CreatedDate]))  return IF(ISBLANK(Opportunity[CreatedDate]), BLANK(), if(and(Opportunity[CreatedDate] >= DST_Start, Opportunity[CreatedDate] < DST_End), Opportunity[CreatedDate] - (4/24), Opportunity[CreatedDate] - (5/24))"', N'Opportunity.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Created_Date_w_DST', N'Time Conversion', N'Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Opportunity[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Opportunity[CreatedDate]))  return IF(ISBLANK(Opportunity[CreatedDate]), BLANK(), FORMAT(if(and(Opportunity[CreatedDate] >= DST_Start, Opportunity[CreatedDate] < DST_End), Opportunity[CreatedDate] - (4/24), Opportunity[CreatedDate] - (5/24)), ""MM/DD/YYYY""))"', N'CONVERT(DATE,Opportunity.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time'')', NULL, NULL, 8, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Division_Abbreviation', N'Case - Result', N'Column', N'"IF(Opportunity[Division__c]=""Direct - Solar Pro"",""SP - "",IF(Opportunity[Division__c]=""Traditional"",""T - "",IF(Opportunity[Division__c]=""Direct"",""D - "",BLANK())))"', N'CASE WHEN Opportunity.[Division__c]=''Direct - Solar Pro'' THEN ''SP - ''   WHEN Opportunity.[Division__c]=''Traditional'' THEN ''T - ''  WHEN Opportunity.[Division__c]=''Direct'' THEN ''D - '' ELSE  NULL END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Oppt_lead_generator', N'Case - Result', N'Column', N'"IF(isblank(Opportunity[Lead_Generator__c]),Opportunity[Trinity_Salesperson__c],Opportunity[Lead_Generator__c])"', N'CASE WHEN Opportunity.[Lead_Generator__c] IS NULL THEN  Opportunity.[Trinity_Salesperson__c] ELSE Opportunity.[Lead_Generator__c] END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lost_No_Contract', N'Case - Power of 1', N'Column', N'"IF(SEARCH(""Lost"", Opportunity[StageName],,BLANK() ) > 0 && Opportunity[Contract_Signed__c] <> 1, 1, 0)"', N'CASE WHEN Opportunity.[StageName] LIKE ''%Lost%'' AND  Opportunity.[Contract_Signed__c] <> 1 THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Sales_Rep', N'Lookup', N'Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], Opportunity[Trinity_Salesperson__c])"', N'Contact.[Name]', N'[Contact]', N'Contact.[Id]=Opportunity.[Trinity_Salesperson__c]', 4, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Amount_of_Trees_Shading__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Appointment_Confirmed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'City', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'ConvertedAccountId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'ConvertedContactId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'ConvertedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'ConvertedOpportunityId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Country', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'County__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Date_Time_of_First_Appt__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'DoNotCall', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Event_Name__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Finance_Partner__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'GCLID__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'HasOptedOutOfEmail', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'IsDeleted', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Cost__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Generator__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Generator_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Provider_Lead_ID__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'LeadSource', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'MobilePhone', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'OwnerId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Phone', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'PostalCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Reason_Lost_Detail__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Reason_Lost2__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referrer_Name_new__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referrer_Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Sales_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Salesperson__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'SDR_Inside_Sales__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'State', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'StateCode', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Status', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Stewardship_Account__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Street', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Telemarketer__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Territory2__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Type__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Willing_to_Remove_Trees__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual_Cost', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[Lead Source Dashboard Actual Lead Source] = ""Google"", LOOKUPVALUE(''Google Dates''[Cost Per Lead Per Day], ''Google Dates''[Date], ''Lead''[Created Date w/DST]),  IF(''Lead''[Lead Source Dashboard Actual Lead Source] = ""Facebook"", LOOKUPVALUE(''Facebook Date''[Cost Per Lead Per Day], ''Facebook Date''[Trans_Date], ''Lead''[Created Date w/DST]), ''Lead''[Modified Lead Cost]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual_Lead_Source', N'Case - Result', N'Calculated Column', N'"var GoogleLead = IF(OR(not ISBLANK(''Lead''[GCLID__c]), SEARCH(""Google"", ''Lead''[LeadSource],, BLANK())>0), 1, 0)  return IF(GoogleLead = 1, ""Google"", ''Lead''[LeadSource])"', N'
   CASE WHEN Lead.[GCLID__c] IS NOT NULL OR Lead.[LeadSource] LIKE ''%Google%'' THEN ''Google'' ELSE Lead.[LeadSource] END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual_Reason_Lost', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[Converted] = 1, ''Lead''[Opp Reason Lost], ''Lead''[Reason_Lost2__c])"', N'CASE WHEN Lead.[Converted] = 1 THEN Lead.[Oppt_Reason_Lost] ELSE Lead.[Reason_Lost2__c] END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual_State', N'Case - Result', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[Opp State]), ''Lead''[Opp State], ''Lead''[State])"', N'CASE WHEN Lead.[Oppt_State] IS NOT NULL THEN Lead.[Oppt_State] ELSE Lead.[State] END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual_Territory', N'Case - Result', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[Opp Territory]), ''Lead''[Opp Territory], ''Lead''[Territory2__c])"', N'CASE WHEN Lead.[Oppt_Territory] IS NOT NULL THEN Lead.[Oppt_Territory] ELSE Lead.[Territory2__c] END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Address', N'Format', N'Calculated Column', N'"Lead''[Street] & "", "" & ''Lead''[City] & "", "" & ''Lead''[State] & "" "" & ''Lead''[PostalCode]"', N'CONCAT(Lead.[Street],'' '',Lead.[City],'' '',Lead.[State],'' '',Lead.[PostalCode])', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Appt_Completed', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Appointment_Completed__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Appointment_Completed__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Appt_Confirmed', N'Case - Power of 1', N'Calculated Column', N'"IF(     ''Lead''[Confirmation from Event] = ""Not Confirmed"" || ISBLANK(''Lead''[Confirmation from Event]),     0,     1 )"', N'CASE WHEN Lead.[Confirmation_from_Event] = ''Not Confirmed'' OR Lead.[Confirmation_from_Event] IS NULL THEN 0 ELSE 1 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Call_Outcome', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Task[Outcome__c], Task[Id], ''Lead''[Referred from Campaign])"', N'Task.[Outcome__c]', N'Task', N'Task.[Id] = Lead.[Referred_from_Campaign]', 8, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Call_Owner', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Task[OwnerId], Task[Id], ''Lead''[Call Referral])"', N'Task.[OwnerId]', N'Task', N'Task.[Id] = Lead.[Call_Referral]', 10, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Call_Referral', N'Lookup', N'Calculated Column', N'"IF(NOT(ISBLANK(''Lead''[Referrer_Name_new__c])), CALCULATE(FIRSTNONBLANK(Task[Id], 1), FILTER(ALL(Task), ''Lead''[Referrer_Name_new__c] = Task[Contact Id]), FILTER(ALL(Task), SEARCH(""Call: Spring 2020"", Task[Subject],, BLANK()) >0)), BLANK())"', N'CASE WHEN Lead.[Referrer_Name_new__c] IS NOT NULL THEN Task.[Id] ELSE NULL END', N'Task', N'Lead.[Referrer_Name_new__c] = Task.[Contact_Id] AND Task.[Subject] LIKE ''%Call: Spring 2020%''', 9, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Call_Referred', N'Case - Power of 1', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[Call Referral]) && ''Lead''[LeadSource] <> ""Fundraising"" && not SEARCH(""Web Form"", ''Lead''[LeadSource],, BLANK()) >0, 1, 0)"', N'CASE WHEN Lead.[Call_Referral] IS NOT NULL AND Lead.[LeadSource] <> ''Fundraising'' AND 
Lead.[LeadSource] NOT LIKE ''%Web Form%'' THEN 1 ELSE 0 END', NULL, NULL, 11, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Confirmation_from_Event', N'Calculation', N'Calculated Column', N'"CALCULATE(MAX(Event[Appointment_Confirmed__c]), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId]), FILTER(Event, Event[Appt Date] = ''Lead''[First Appt Confirmation Date]))"', N'MAX(Event.[Appointment_Confirmed__c])', N'Event', N'Event.[Opportunity__c] = Lead.[ConvertedOpportunityId] AND Event.[Appt_Date] = Lead.[First_Appt_Confirmation_Date]', 5, NULL, N'Lead.ConvertedOpportunityId', N'ConvertedOpportunityId', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Confirmation_Using_Event_Date', N'Calculation', N'Calculated Column', N'"CALCULATE(MAX(Event[Appointment_Confirmed__c]), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId]), FILTER(Event, Event[Appt Date] = ''Lead''[Date First Ran from Event]))"', N'MAX(Event.[Appointment_Confirmed__c])', N'Event', N'Event.[Opportunity__c] = Lead.[ConvertedOpportunityId] AND Event.[Appt_Date] = Lead.[First_Appt_From_Event]', 27, N'LEFT', N'Lead.[ConvertedOpportunityId]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Contracts_Signed', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Contract_Signed__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Contract_Signed__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Converted', N'Case - Power of 1', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[ConvertedOpportunityId]),1,0)"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NOT NULL THEN 1 ELSE 0 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Covid_Email_Leads', N'Case - Power of 1', N'Calculated Column', N'"IF((OR(SEARCH(""Covid"", ''Lead''[LeadSource],, BLANK() ) >0, SEARCH(""Customer Referral – Web Form"", ''Lead''[LeadSource],, BLANK() ) >0)) && ''Lead''[Created By] = ""TSBTApp Admin"", 1, 0)"', N'CASE WHEN Lead.[LeadSource] LIKE ''%Covid%'' OR Lead.[LeadSource] LIKE ''%Customer Referral – Web Form%''
AND Lead.[Created_By] = ''TSBTApp Admin'' THEN 1 ELSE 0 END', NULL, NULL, 13, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Created_By', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(User[Name], User[Id], ''Lead''[CreatedById])"', N'[User].[Name]', N'[User]', N'[User].[Id] = Lead.[CreatedById]', 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Created_By_Division', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(User[Contact Division], User[Id], ''Lead''[CreatedById])"', N'[User].[Contact_Division]', N'[User]', N'[User].[Id] = Lead.[CreatedById]', 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Created_By_Office', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(User[Contact Office], User[Id], ''Lead''[CreatedById])"', N'[User].[Contact_Office]', N'[User]', N'[User].[Id] = Lead.[CreatedById]', 12, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Created_Date_Time_w/DST', N'Time Conversion', N'Calculated Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Lead''[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Lead''[CreatedDate]))  return IF(ISBLANK(''Lead''[CreatedDate]), BLANK(), if(and(''Lead''[CreatedDate] >= DST_Start, ''Lead''[CreatedDate] < DST_End), ''Lead''[CreatedDate] - (4/24), ''Lead''[CreatedDate])"', N'Lead.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 14, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Created_Date_w/DST', N'Time Conversion', N'Calculated Column', N'"var DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(''Lead''[CreatedDate])) var DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(''Lead''[CreatedDate]))  return IF(ISBLANK(''Lead''[CreatedDate]), BLANK(), FORMAT(if(and(''Lead''[CreatedDate] >= DST_Start, ''Lead''[CreatedDate] < DST_End), ''Lead''[CreatedDate] - (4/24), ''Lead''[CreatedDate] - (5/24)), ""MM/DD/YYYY""))"', N'Lead.[CreatedDate] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 14, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'First_Appt_From_Event', N'Case - Result', N'Calculated Column', N'"var FirstRan = CALCULATE(MIN(Event[Appt Date]), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId]), FILTER(Event, Event[Outcome__c (groups)] = ""Ran"")) var FirstAppt = CALCULATE(MAX(Event[Appt Date]), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId]))  return IF(     ISBLANK(''Lead''[ConvertedOpportunityId]),     BLANK(),     IF(         ISBLANK(FirstRan),         FirstAppt,         FirstRan     ) )"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NULL THEN NULL 
	WHEN MIN(Event.[Appt_Date]) IS NULL THEN MAX(Event.[Appt_Date]) ELSE MIN(Event.[Appt_Date]) END', N'Event', N'Event.[Opportunity__c] =Lead.[ConvertedOpportunityId] AND Event.[Outcome__c_groups] = ''Ran''', 26, N'LEFT', N'Lead.[ConvertedOpportunityId]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'First_Appt_From_Oppt', N'Case - Result', N'Calculated Column', N'"IF(     ISBLANK(''Lead''[ConvertedOpportunityId]),     BLANK(),     LOOKUPVALUE(Opportunity[Date of First Appt], Opportunity[Id], ''Lead''[ConvertedOpportunityId]) )"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NULL THEN NULL ELSE Opportunity.[Date_of_First_Appt] END ', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Appt_Date', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Date of First Appt], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Date_Time_of_First_Appt__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Appt_Scheduled', N'Case - Power of 1', N'Calculated Column', N'"IF(''Lead''[Lost Before Appt Ran] = 1, 0, IF(''Lead''[Demo Completed] = 0 && ''Lead''[Demo Date] >= TODAY(),1,0))"', N'CASE WHEN Lead.[Lost_Before_Appt_Ran] = 1 THEN 0
WHEN Lead.[Demo_Completed] = 0 AND Lead.[Demo_Date] >= GETDATE() THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Division', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Division__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Division__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Disqualified', N'Case - Power of 1', N'Calculated Column', N'"IF(     [Reason Lost] IN {""Already Has Solar"", ""DQ- Credit"", ""DQ- Not Homeowner"", ""DQ- No Usage/History"", ""DQ- Shade"", ""DQ- Structure/Roof Space"", ""DQ- Title"", ""Financial"",""Incorrect Info"", ""Incorrect/missing Contact Info"", ""Mobile Home"",""Out of Area"", ""Out of Coverage Area"", ""Shading"", ""Structural Issues"", ""Utility Rejection"", ""Commercial Property"", ""Utility Rejection""},     1,     0 )"', N'CASE WHEN Lead.Reason_Lost IN (''Already Has Solar'', ''DQ- Credit'', ''DQ- Not Homeowner'',   
''DQ- No Usage/History'', ''DQ- Shade'', ''DQ- Structure/Roof Space'', ''DQ- Title'',   
''Financial'',''Incorrect Info'', ''Incorrect/missing Contact Info'', ''Mobile Home'',''Out of Area'',   ''Out of Coverage Area'', 
''Shading'', ''Structural Issues'', ''Utility Rejection'',    ''Commercial Property'', ''Utility Rejection'') THEN 1 ELSE 0 END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email_Owner', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Task[OwnerId], Task[Id], ''Lead''[Referred From Email])"', N'Task.[OwnerId]', N'Task', N'Task.[Id] = Lead.[Referred_From_Email]', 16, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email_Referred', N'Case - Power of 1', N'Calculated Column', N'"IF(''Lead''[Call Referred] = 1, 0, IF(not ISBLANK(''Lead''[Referred From Email]) && ''Lead''[LeadSource] <> ""Fundraising"" , 1, 0))"', N'CASE WHEN Lead.[Call_Referred] = 1 THEN 0
WHEN Lead.[Referred_From_Email] IS NOT NULL AND Lead.[LeadSource] <> ''Fundraising'' THEN 1 ELSE 0 END', NULL, NULL, 17, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'# Count Ids', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), filter(''Lead'', not ISBLANK(''Lead''[ConvertedDate])),USERELATIONSHIP(Account[Territory__c],''Lead''[Territory2__c]),USERELATIONSHIP(''Date''[Date],''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appointments Ran', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Completed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email_Source', N'Case - Result', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[Total Email Leads]), IF(SEARCH(""Referral"", ''Lead''[LeadSource],, BLANK() ) >0, ""Referral Incentive"", IF(SEARCH(""Covid"", ''Lead''[LeadSource],, BLANK() ) >0, ""Install Incentive"")), BLANK())"', N'CASE WHEN Lead.[Total_Email_Leads] IS NOT NULL AND  
Lead.[LeadSource] LIKE ''%Referral%'' THEN ''Referral Incentive''  
WHEN Lead.[LeadSource] LIKE ''%Covid%'' THEN ''Install Incentive'' END', NULL, NULL, 19, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Event_Appt_Confirmed', N'Case - Power of 1', N'Calculated Column', N'"IF(     ''Lead''[Confirmation Using Event Date] = ""Not Confirmed"" || ISBLANK(''Lead''[Confirmation Using Event Date]),     0,     1 )"', N'CASE WHEN Lead.[Confirmation_Using_Event_Date] = ''Not Confirmed'' OR Lead.[Confirmation_Using_Event_Date] IS NULL THEN 0 ELSE 1 END', NULL, NULL, 28, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Finance_Partner', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Account[Name], Account[Id], ''Lead''[Finance_Partner__c])"', N'[Account].[Name]', N'Account', N'Account.[Id] = Lead.[Finance_Partner__c]', 20, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'First_Appt_Confirmation_Date', N'Case - Result', N'Calculated Column', N'"IF(     ISBLANK(''Lead''[ConvertedOpportunityId]),     BLANK(),     IF(         ISBLANK(''Lead''[Date of First Appt from Opp]),         CALCULATE(MAX(Event[Appt Date]), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId])),         ''Lead''[Date of First Appt from Opp]     ) )"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NULL THEN NULL 
WHEN Lead.[First_Appt_From_Oppt] IS NULL THEN MAX(Event.[Appt_Date]) ELSE Lead.[First_Appt_From_Oppt] END', N'Event', N'Event.[Opportunity__c] = Lead.[ConvertedOpportunityId]', 4, NULL, N'Lead.[First_Appt_From_Oppt],lead.ConvertedOpportunityId', N'ConvertedOpportunityId', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Has_Email', N'Case - Result', N'Calculated Column', N'"IF(not ISBLANK(''Lead''[Email]), ""Yes"", ""No"")"', N'CASE WHEN Lead.[Email] IS NOT NULL THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Has_Phone', N'Case - Result', N'Calculated Column', N'"IF(OR(not ISBLANK(''Lead''[Phone]), NOT(ISBLANK(''Lead''[MobilePhone]))), ""Yes"", ""No"")"', N'CASE WHEN Lead.[Phone] IS NOT NULL OR Lead.[MobilePhone] IS NOT NULL THEN ''Yes'' ELSE ''No'' END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Install_Scheduled_Watts', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[Install Scheduled] = 1, ''Lead''[System Size], BLANK())"', N'CASE WHEN Lead.[Install_Scheduled] = 1 THEN Lead.[System_Size] ELSE NULL END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Install_Started', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Install_Started__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Install_Started__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Installed_Watts', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[Install Started] =1, ''Lead''[System Size], BLANK())"', N'CASE WHEN Lead.[Install_Started] =1 THEN Lead.[System_Size] ELSE NULL END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Install_Scheduled', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Install_Scheduled__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Install_Scheduled__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Last_Converted_Lead', N'Case - Result', N'Calculated Column', N'"var lastconverted = LOOKUPVALUE(''Converted Contact Id''[Last Created], ''Converted Contact Id''[ConvertedContactId], ''Lead''[ConvertedContactId], ''Converted Contact Id''[Last Created], ''Lead''[CreatedDate])  return IF(     ISBLANK(''Lead''[ConvertedContactId]),     BLANK(),     IF(         ''Lead''[CreatedDate] = lastconverted,         ''Lead''[ConvertedContactId],         BLANK()     ) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_First_Task', N'Lookup', N'Calculated Column', N'"IF(NOT(ISBLANK(''Lead''[Referrer_Name_new__c])), CALCULATE(FIRSTNONBLANK(Task[Id],1), FILTER(Task, MIN(''Task''[CreatedDate])), FILTER(ALL(''Task''), ''Task''[Contact Id] = ''Lead''[Referrer_Name_new__c]), FILTER(Task, Task[Status] = ""Completed"")), BLANK())"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Gen', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], ''Lead''[Lead_Generator__c])"', N'[Contact].[Name]', N'Contact', N'Contact.[Id] = Lead.[Lead_Generator__c]', 21, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Gen_Division', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Sales_Division__c], Contact[Id], ''Lead''[Lead_Generator__c])"', N'Contact.[Sales_Division__c]', N'Contact', N'Contact.[Id] = Lead.[Lead_Generator__c]', 21, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Source_Dashboard_Actual_Lead_Source', N'Case - Result', N'Calculated Column', N'"IF(     ''Lead''[Actual_Lead_Source] = ""Google"",     ""Google"",     IF(         ''Lead''[Actual_Lead_Source] = ""Facebook"",         ""Facebook"",         IF(             SEARCH(""Purchased"", ''Lead''[LeadSource],, BLANK())>0,             TRIM(RIGHT(''Lead''[LeadSource], LEN(''Lead''[LeadSource]) - SEARCH("" "",''Lead''[LeadSource],,BLANK()))),             ''Lead''[LeadSource]         )     ) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Source_Lookup', N'Case - Result', N'Calculated Column', N'"IF(     ISBLANK(LOOKUPVALUE(LeadSource[leadSourceGroup], LeadSource[leadSource], ''Lead''[Actual Lead Source])),     ""Other"",     LOOKUPVALUE(LeadSource[leadSourceGroup], LeadSource[leadSource], ''Lead''[Actual Lead Source]) )"', N'CASE WHEN Lead_Source.[leadSourceGroup] IS NULL THEN ''Other'' ELSE Lead_Source.[leadSourceGroup] END', N'Lead_Source', N'Lead_Source.[leadSource] = Lead.[Actual_Lead_Source]', 22, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Time', N'Case - Result', N'Calculated Column', N'"if(not ISBLANK(''Lead''[ConvertedDate]),''Lead''[ConvertedDate] - ''Lead''[Created Date w/DST], blank())"', N'CASE WHEN Lead.[ConvertedDate] IS NOT NULL THEN 
DATEDIFF(DAY,Lead.[Created_Date_w/DST],Lead.[ConvertedDate]) ELSE NULL END', NULL, NULL, 18, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead_Gen_SalesPer', N'Case - Result', N'Calculated Column', N'"IF( ISBLANK (''Lead''[Lead_Generator__c]), ''Lead''[Trinity_Salesperson__c],''Lead''[Lead_Generator__c])"', N'CASE WHEN Lead.[Lead_Generator__c] IS NULL THEN Lead.[Trinity_Salesperson__c] ELSE Lead.[Lead_Generator__c] END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lost_Before_Appt_Ran', N'Case - Result', N'Calculated Column', N'"IF(ISBLANK(''Lead''[ConvertedOpportunityId]), BLANK(), LOOKUPVALUE(Opportunity[Lost Before Appt], Opportunity[Id], ''Lead''[ConvertedOpportunityId]))"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NULL THEN NULL ELSE Opportunity.[Lost_Before_Appt] END', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Managing_Office', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Managing_Office__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Managing_Office__c]', N'opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'System_Size', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[System_Size_kWdc__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[System_Size_kWdc__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Task_Subject', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Task[Subject], Task[Id], ''Lead''[Lead First Task])"', N'Task.[Subject]', N'Task', N'Task.[Id] = Lead.[Lead_First_Task]', 23, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Total_Email_Leads', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[Email Referred] = 1, ""Call"", IF(''Lead''[Covid Email Leads] = 1, ""Email"", BLANK()))"', N'CASE WHEN Lead.[Email_Referred] = 1 THEN ''Call'' 
WHEN Lead.[Covid_Email_Leads] = 1 THEN ''Email'' ELSE NULL END', NULL, NULL, 18, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Total_Events', N'Calculation', N'Calculated Column', N'"CALCULATE(COUNTROWS(Event), FILTER(Event, Event[Opportunity__c] = ''Lead''[ConvertedOpportunityId]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Confirmed by Date Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Confirmed by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Confirmed by Lead Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Set by Date Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Set]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Modified_Lead_Cost', N'Case - Result', N'Calculated Column', N'"IF(''Lead''[LeadSource] = ""Purchased: Amplify-PPD"",     IF(''Lead''[Appointment Completed] = 1, 300, 0), IF(''Lead''[LeadSource] = ""Purchased: Against Time - LT"" && ISBLANK(''Lead''[Lead_Cost__c]), 125, IF(''Lead''[LeadSource] = ""Purchased: Against Time - PPD"",     IF(''Lead''[Appointment Completed] = 1, 300, 0), IF(''Lead''[LeadSource] = ""Purchased: Tru Power-Ex"" && ''Lead''[Lead_Cost__c] <> 0,     IF(''Lead''[StateCode] = ""NJ"" || ''Lead''[StateCode] = ""NY"", 65, 45), IF(SEARCH(""Americor"", ''Lead''[LeadSource],,BLANK())>0,     IF(''Lead''[Created Date w/DST] < DATE(2021,02,08),          ''Lead''[Lead_Cost__c],         IF(''Lead''[Converted] = 1, 150, 0)), IF(''Lead''[LeadSource] = ""Purchased: LL Media - Appt"",     IF(''Lead''[Converted] = 1, 150, 0), IF(''Lead''[Actual_Lead_Source] = ""Exclusive Prospects"" && ''Lead''[Lead_Cost__c] <> 0, 100, IF(''Lead''[Actual_Lead_Source] = ""Energy United Pros"" && ISBLANK(''Lead''[Lead_Cost__c]), 100, IF(''Lead''[Actual_Lead_Source] = ""Modernize"" && ISBLANK(''Lead''[Lead_Cost__c]), 25, IF(''Lead''[Actual_Lead_Source] = ""FiveStrata"", ''Lead''[Lead_Cost__c] * .96, IF(''Lead''[Actual_Lead_Source] = ""Dvinci"",     IF(''Lead''[Lead_Cost__c] = 0 && NOT(ISBLANK(''Lead''[Lead_Cost__c])), 0,         IF(''Lead''[Created Date w/DST] >= DATE(2020,1,1) && ''Lead''[Created Date w/DST] <= DATE(2020,6,29),         89.25,         IF(''Lead''[Created Date w/DST] >= DATE(2020,6,30) && ''Lead''[Created Date w/DST] <= DATE(2020,9,9),         80.75,         IF(''Lead''[Created Date w/DST] >=DATE(2020,9,10),         LOOKUPVALUE(''Dvinci Cost''[Lead Cost], ''Dvinci Cost''[State], ''Lead''[StateCode])     )))), ''Lead''[Lead_Cost__c])))))))))))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Oppt_Reason_Lost', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Reason_Lost__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Reason_Lost__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Oppt_State', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[State], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[State]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Oppt_Territory', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Territory2__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Territory2__c]', N'Opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Oppt_Lost_Before_Appt_Ran', N'Case - Power of 1', N'Calculated Column', N'"IF(''Lead''[Converted] = 1 && ''Lead''[Lost Before Appt Ran] = 1, 1, 0)"', N'CASE WHEN Lead.[Converted] = 1 AND Lead.[Lost_Before_Appt_Ran] = 1 THEN 1 ELSE 0 END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Site_Quality', N'Case - Result', N'Calculated Column', N'"IF(OR(ISBLANK(''Lead''[Willing_to_Remove_Trees__c]), ISBLANK(''Lead''[Amount_of_Trees_Shading__c])), BLANK(),IF(OR(''Lead''[Willing_to_Remove_Trees__c] = ""N/A"", ''Lead''[Willing_to_Remove_Trees__c] = ""No Shade""), 1, IF(''Lead''[Willing_to_Remove_Trees__c] = ""Yes"", 2, IF(AND(''Lead''[Willing_to_Remove_Trees__c] = ""No"", ''Lead''[Amount_of_Trees_Shading__c] <= 2), 2, 3))))"', N'CASE WHEN Lead.[Willing_to_Remove_Trees__c] IS NULL OR 
Lead.[Amount_of_Trees_Shading__c] IS NULL THEN NULL      
WHEN Lead.[Willing_to_Remove_Trees__c] = ''N/A'' OR 
Lead.[Willing_to_Remove_Trees__c] = ''No Shade'' THEN 1      
WHEN Lead.[Willing_to_Remove_Trees__c] = ''Yes'' THEN 2     
WHEN Lead.[Willing_to_Remove_Trees__c] = ''No'' AND 
Lead.[Amount_of_Trees_Shading__c] < =2 THEN 2 ELSE 3 END', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Reason_Lost', N'Case - Result', N'Calculated Column', N'"IF(ISBLANK(''Lead''[ConvertedOpportunityId]), ''Lead''[Reason_Lost2__c], ''Lead''[Opp Reason Lost])"', N'CASE WHEN Lead.[ConvertedOpportunityId] IS NULL THEN Lead.[Reason_Lost2__c] ELSE 
Lead.[Oppt_Reason_Lost] END', NULL, NULL, 3, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Record_Type', N'Format', N'Calculated Column', N'"IF(     ISBLANK(''Lead''[Record Type Lookup]),     BLANK(),     MID(''Lead''[Record Type Lookup], LEN(LEFT(''Lead''[Record Type Lookup], SEARCH(""-"",''Lead''[Record Type Lookup],,BLANK()>0)))+1 + 1, LEN(''Lead''[Record Type Lookup]) - LEN(LEFT(''Lead''[Record Type Lookup], SEARCH(""-"",''Lead''[Record Type Lookup],,BLANK()>0)))+1) )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Record_Type_Lookup', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(''Record Type''[Name], ''Record Type''[Id], ''Lead''[RecordTypeId])"', N'Record_Type.[Customer_Name]', N'Task', N'Record_Type.[Id] = Lead.[RecordTypeId]', NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referral_Caller', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Name], Contact[Id], ''Lead''[Referral_Solicitor__c])"', N'[Contact].[Name]', N'Contact', N'Contact.[Id] = Lead.[Referral_Solicitor__c]', 24, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referral_Caller_Division', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Sales_Division__c], Contact[Id], ''Lead''[Referral_Solicitor__c])"', N'Contact.[Sales_Division__c]', N'Contact', N'Contact.[Id] = Lead.[Referral_Solicitor__c]', 24, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referral_Caller_Office', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Sales_Office__c], Contact[Id], ''Lead''[Referral_Solicitor__c])"', N'Contact.[Sales_Office__c]', N'Contact', N'Contact.[Id] = Lead.[Referral_Solicitor__c]', 24, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referrals', N'Case - Result', N'Calculated Column', N'"var leadsreferred = CALCULATE(COUNTROWS(''Referred Leads''), FILTER(''Referred Leads'', ISBLANK(''Referred Leads''[ConvertedDate])), FILTER(''Referred Leads'', ''Referred Leads''[Referrer_Name_new__c] = ''Lead''[Last Converted Lead])) var oppsreferred = CALCULATE(COUNTROWS(''Referred Opps''), FILTER(''Referred Opps'', ''Referred Opps''[Referrer_Name_new__c] = ''Lead''[Last Converted Lead]))  return IF(     (leadsreferred + oppsreferred) > 0,     ''Lead''[Last Converted Lead],     BLANK() )"', N'', NULL, NULL, NULL, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referred_from_Campaign', N'Lookup', N'Calculated Column', N'"IF(NOT(ISBLANK(''Lead''[Referrer_Name_new__c])), CALCULATE(FIRSTNONBLANK(Task[Id], 1), FILTER(ALL(Task), ''Lead''[Referrer_Name_new__c] = Task[Contact Id]), FILTER(ALL(Task), Task[Status] = ""Completed""), FILTER(ALL(Task), SEARCH(""Call: Spring 2020"", Task[Subject],, BLANK()) >0), FILTER(Task, Task[Outcome__c] <> ""Did Not Call"")), BLANK())"', N'CASE WHEN Lead.[Referrer_Name_new__c] IS NOT NULL THEN Task.[Id] ELSE NULL END', N'Task', N'Lead.[Referrer_Name_new__c] = Task.[Contact_Id] AND Task.[Status] = ''Completed'' 
AND Task.[Subject] LIKE ''%Call: Spring 2020%'' AND Task.[Outcome__c] <> ''Did Not Call''', 7, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referred_From_Email', N'Lookup', N'Calculated Column', N'"IF(NOT(ISBLANK(''Lead''[Referrer_Name_new__c])), CALCULATE(FIRSTNONBLANK(Task[Id], 1), FILTER(ALL(Task), ''Lead''[Referrer_Name_new__c] = Task[Contact Id]),  FILTER(ALL(Task), SEARCH(""Email Opened: Spring 2020"", Task[Subject],, BLANK()) >0)), BLANK())"', N'CASE WHEN Lead.[Referrer_Name_new__c] IS NOT NULL THEN Task.[Id] ELSE NULL END', N'Task', N'Lead.[Referrer_Name_new__c] = Task.[Contact_Id] AND Task.[Subject] LIKE ''Email Opened: Spring 2020''', 15, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Referrer_Name', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Contact[Name],Contact[Id],''Lead''[Referrer_Name_new__c])"', N'[Contact].[Name]', N'Contact', N'Contact.[Id] = Lead.[Referrer_Name_new__c]', 25, N'LEFT', NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Sales_Office', N'Lookup', N'Calculated Column', N'"LOOKUPVALUE(Opportunity[Direct_Sales_Office__c], Opportunity[Id], ''Lead''[ConvertedOpportunityId])"', N'Opportunity.[Direct_Sales_Office__c]', N'opportunity', N'Opportunity.[Id] = Lead.[ConvertedOpportunityId]', 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'State_Abbreviation', N'Case - Result', N'Calculated Column', N'"SWITCH (     ''Lead''[Actual State],     ""Alaska"", ""AK"",     ""Alabama"", ""AL"",     ""Arkansas"", ""AR"",     ""Arizona"", ""AZ"",     ""California"", ""CA"",     ""Colorado"", ""CO"",     ""Connecticut"", ""CT"",     ""Delaware"", ""DE"",     ""Florida"", ""FL"",     ""Georgia"", ""GA"",     ""Hawaii"", ""HI"",     ""Iowa"", ""IA"",     ""Idaho"", ""ID"",     ""Illinois"", ""IL"",     ""Indiana"", ""IN"",     ""Kansas"", ""KS"",     ""Kentucky"", ""KY"",     ""Louisiana"", ""LA"",     ""Massachusetts"", ""MA"",     ""Maryland"", ""MD"",     ""Maine"", ""ME"",     ""Michigan"", ""MI"",     ""Minnesota"", ""MN"",     ""Missouri"", ""MO"",     ""Mississippi"", ""MS"",     ""Montana"", ""MT"",     ""North Carolina"", ""NC"",     ""North Dakota"", ""ND"",     ""Nebraska"", ""NE"",     ""New Hampshire"", ""NH"",     ""New Jersey"", ""NJ"",     ""New Mexico"", ""NM"",     ""Nevada"", ""NV"",     ""New York"", ""NY"",     ""Ohio"", ""OH"",     ""Oklahoma"", ""OK"",     ""Oregon"", ""OR"",     ""Pennsylvania"", ""PA"",     ""Rhode Island"", ""RI"",     ""South Carolina"", ""SC"",     ""South Dakota"", ""SD"",     ""Tennessee"", ""TN"",     ""Texas"", ""TX"",     ""Utah"", ""UT"",     ""Virginia"", ""VA"",     ""Vermont"", ""VT"",     ""Washington"", ""WA"",     ""Wisconsin"", ""WI"",     ""West Virginia"", ""WV"",     ""Wyoming"", ""WY"",     ""District of Columbia"", ""DC"" )"', N'CASE WHEN Lead.[Actual_State] = ''Alaska'' THEN ''AK'' 
WHEN Lead.[Actual_State] = ''Alabama'' THEN ''AL'' 
WHEN Lead.[Actual_State] = ''Arkansas'' THEN ''AR'' 
WHEN Lead.[Actual_State] = ''Arizona'' THEN ''AZ'' 
WHEN Lead.[Actual_State] = ''California'' THEN ''CA'' 
WHEN Lead.[Actual_State] = ''Connecticut'' THEN ''CT'' 
WHEN Lead.[Actual_State] = ''Delaware'' THEN ''DE'' 
WHEN Lead.[Actual_State] = ''Florida'' THEN ''FL'' 
WHEN Lead.[Actual_State] = ''Georgia'' THEN ''GA'' 
WHEN Lead.[Actual_State] = ''Hawaii'' THEN ''HI'' 
WHEN Lead.[Actual_State] = ''Iowa'' THEN ''IA'' 
WHEN Lead.[Actual_State] = ''Idaho'' THEN ''ID'' 
WHEN Lead.[Actual_State] = ''Illinois'' THEN ''IL'' 
WHEN Lead.[Actual_State] = ''Indiana'' THEN ''IN'' 
WHEN Lead.[Actual_State] = ''Kansas'' THEN ''KS'' 
WHEN Lead.[Actual_State] = ''Kentucky'' THEN ''KY'' 
WHEN Lead.[Actual_State] = ''Massachusetts'' THEN ''MA'' 
WHEN Lead.[Actual_State] = ''Maryland'' THEN ''MD'' 
WHEN Lead.[Actual_State] = ''Maine'' THEN ''ME'' 
WHEN Lead.[Actual_State] = ''Michigan'' THEN ''MI'' 
WHEN Lead.[Actual_State] = ''Minnesota'' THEN ''MN'' 
WHEN Lead.[Actual_State] = ''Missouri'' THEN ''MO'' 
WHEN Lead.[Actual_State] = ''Mississippi'' THEN ''MS'' 
WHEN Lead.[Actual_State] = ''Montana'' THEN ''MT''
WHEN Lead.[Actual_State] = ''North Carolina'' THEN ''NC'' 
WHEN Lead.[Actual_State] = ''North Dakota'' THEN ''ND'' 
WHEN Lead.[Actual_State] = ''Nebraska'' THEN ''NE'' 
WHEN Lead.[Actual_State] = ''New Hampshire'' THEN ''NH'' 
WHEN Lead.[Actual_State] = ''New Jersey'' THEN ''NJ''
WHEN Lead.[Actual_State] = ''New Mexico'' THEN ''NM''
WHEN Lead.[Actual_State] = ''Nevada'' THEN ''NV''
WHEN Lead.[Actual_State] = ''New York'' THEN ''NY''
WHEN Lead.[Actual_State] = ''Ohio'' THEN ''OH''
WHEN Lead.[Actual_State] = ''Oklahoma'' THEN ''OK''
WHEN Lead.[Actual_State] = ''Oregon'' THEN ''OR''
WHEN Lead.[Actual_State] = ''Pennsylvania'' THEN ''PA''
WHEN Lead.[Actual_State] = ''Rhode Island'' THEN ''RI''
WHEN Lead.[Actual_State] = ''South Carolina'' THEN ''SC''
WHEN Lead.[Actual_State] = ''South Dakota'' THEN ''SD''
WHEN Lead.[Actual_State] = ''Tennessee'' THEN ''TN''
WHEN Lead.[Actual_State] = ''Texas'' THEN ''TX''
WHEN Lead.[Actual_State] = ''Utah'' THEN ''UT''
WHEN Lead.[Actual_State] = ''Virginia'' THEN ''VA''
WHEN Lead.[Actual_State] = ''Vermont'' THEN ''VT''
WHEN Lead.[Actual_State] = ''Washington'' THEN ''WA''
WHEN Lead.[Actual_State] = ''Wisconsin'' THEN ''WI''
WHEN Lead.[Actual_State] = ''West Virginia'' THEN ''WV''
WHEN Lead.[Actual_State] = ''Wyoming'' THEN ''WY''
WHEN Lead.[Actual_State] = ''District of Columbia'' THEN ''DC''
END', NULL, NULL, 6, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Set by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Set]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Appts Set by Lead Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Appointment Set]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Avg Lead Time', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Lead''[Lead Time]),USERELATIONSHIP(Account[Territory__c],''Lead''[Territory2__c]), USERELATIONSHIP(''Date''[Date],''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Close Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Contracts Signed], [#Demos Completed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Close Ratio', N'Divide', N'Measure', N'"IF([#Demos Ran] = 0, 0, CALCULATE(DIVIDE([#Contracts Signed -CF],[#Demos Ran]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Close Ratio by Contract Signed', N'Divide', N'Measure', N'"IF([#Demos Ran by Contract Signed] = 0, 0, CALCULATE(DIVIDE([#Contracts Signed by Contract Signed],[#Demos Ran by Contract Signed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Close Ratio by Install Date', N'Divide', N'Measure', N'"IF([#Demos Ran by Install Date] = 0, 0, CALCULATE(DIVIDE([#Contracts Signed by Install Date],[#Demos Ran by Install Date]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed', N'Sum', N'Measure', N'CALCULATE(SUM(Opportunity[Contract_Signed__c]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Contracts Signed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Contracts Signed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Contracts Signed]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed -CF', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts -CF]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed -CF by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts -CF]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts Signed -CF by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contracts -CF]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Contracts with Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract_Signed__c]), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Date__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Converted Not Scheduled', N'Subtract', N'Measure', N'CALCULATE([#Leads Converted] - [#Total Demos])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Cost Per Lead', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend], [#Leads]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Cost Per Watt Hybrid', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend], [#Total kW Install Scheduled] + [#Total kW Installed])/1000, USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Cost Per Watt Install Scheduled', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Total kW Install Scheduled])/1000)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Calls Contracts With Install', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract_Signed__c]), FILTER(''Lead'', ''Lead''[Call Referred] = 1), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Date__c])), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Covid Calls Lead Converted Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#COVID Calls Lead Converted to Opportunity] , [#COVID Calls Leads Created] , 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Calls Lead Converted to Opportunity', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]),  FILTER(''Lead'',NOT(ISBLANK(''Lead''[ConvertedDate]))),FILTER(''Lead'', ''Lead''[Call Referred] = 1), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Calls Leads Created', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', ''Lead''[Call Referred] = 1), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Call Owner]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Email Contracts w Install Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Covid Email Leads with Install Scheduled] , [#COVID Email Contracts Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Email Demos Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appt_Completed__c]), FILTER(''Lead'', not ISBLANK(''Lead''[Total Email Leads])), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Completed', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Appointment_Completed__c]), USERELATIONSHIP(''Lead''[ConvertedOpportunityId], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Ran', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Completed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Ran by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Completed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#COVID Email Demos Scheduled', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', not ISBLANK(''Lead''[Total Email Leads])), FILTER(Opportunity, Opportunity[Appt_Completed__c] = 0), FILTER(Opportunity, Opportunity[Demo Date w/DST] > TODAY()), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Covid Email Leads with Install Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Contract_Signed__c]), FILTER(''Lead'', NOT(ISBLANK(''Lead''[Total Email Leads]))), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Date__c])), USERELATIONSHIP(''Lead''[ConvertedOpportunityId],Opportunity[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Ran by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Completed]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(Opportunity[Demo Scheduled]), USERELATIONSHIP(''Lead''[ConvertedOpportunityId], Opportunity[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Scheduled]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Scheduled by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Scheduled]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Demos Scheduled by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Demo Scheduled]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Email Lead Converted Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Email Leads Converted],[#Total Email Leads],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#G FB Real Cost Per Lead', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending 2],[#Leads]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Scheduled', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(Opportunity, not ISBLANK(Opportunity[Actual_Install_Date__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Installs Scheduled]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Scheduled by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Installs Scheduled]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Scheduled by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Installs Scheduled]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Started', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Started]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Started by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Started]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Install Started by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Started]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Installs Started', N'Sum', N'Measure', N'CALCULATE(SUM(Opportunity[Install_Started__c]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead Conversion%', N'Divide', N'Measure', N'"ROUND(''Lead''[#Leads Converted]/''Lead''[#Leads Submitted],2)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead Converted Ratio', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Leads Converted], [#Leads], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead Diff', N'Subtract', N'Measure', N'"var LeadsCM = CALCULATE([#Leads], FILTER(Months, Months[Month] = 0)) var LeadsLM = CALCULATE([#Leads], FILTER(Months, Months[Month] = 1)) var SelectedMonthCM = IF(HASONEVALUE(Months[Month Year]), DISTINCT(Months[Month]), BLANK()) var SelectedLeadsCM = CALCULATE([#Leads], FILTER(Months, Months[Month] = SelectedMonthCM)) var SelectedLeadsLM = IF(HASONEVALUE(Months[Month Year]), CALCULATE([#Leads], DATEADD(''Date''[Date], -1, MONTH)), BLANK())  return IF(HASONEVALUE(Months[Month Year]), SelectedLeadsCM - SelectedLeadsLM + 0, LeadsCM - LeadsLM + 0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead to Opportunity Conversion %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Leads Converted],[#Leads],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead to Opportunity Conversion % by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Leads Converted by Contract Signed],[#Leads by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Lead to Opportunity Conversion % Install Date', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Leads Converted by Install Date],[#Leads by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads', N'Count', N'Measure', N'CALCULATE(COUNT(''Lead''[Id]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads by Contract Signed', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads by Install Date', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Converted', N'Sum', N'Measure', N'CALCULATE(SUM(''Lead''[Converted]))', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Converted', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Converted]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Converted', N'Count', N'Measure', N'"CALCULATE( count(''Lead''[Id]), FILTER(''Lead'',not ISBLANK(''Lead''[ConvertedOpportunityId] )),USERELATIONSHIP(''Lead''[Stewardship_Account__c],''Stewardship Account''[Id]),USERELATIONSHIP(Date_dimension[FullDate], ''Lead''[Created Date format] ))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Converted by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Converted]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Converted by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Converted]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads DQ', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[DQ]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads DQ by Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[DQ]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads DQ Install', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[DQ]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads MTD', N'Sum', N'Measure', N'CALCULATE([#Leads])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Submitted', N'Count', N'Measure', N'"CALCULATE( count(''Lead''[Id]), FILTER(''Lead'', ''Lead''[LeadSource] = ""Fundraising"" && not ISBLANK(''Lead''[Event_Name__c]) ),USERELATIONSHIP(Date_dimension[FullDate], ''Lead''[CreatedDate_m] ), USERELATIONSHIP( ''Stewardship Account''[Event_Name__c], ''Lead''[Event_Name__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total kW Install Scheduled by Install', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Scheduled Watts]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Leads Submitted', N'Count', N'Measure', N'"CALCULATE( count(''Lead''[Id]),USERELATIONSHIP(Date_dimension[FullDate], ''Lead''[Created Date format] ),  filter(''Lead'', not SEARCH(""test"",''Lead''[Referrer Name],,Blank())),filter(''Lead'', not SEARCH(""test"",''Lead''[FirstName],,Blank()) && ''Lead''[FirstName] <> ""contact"" && ''Lead''[FirstName] <> ""oct"" && ''Lead''[FirstName] <> ""omg"" && ''Lead''[FirstName] <> ""galzo"" && ''Lead''[FirstName] <> ""dude"" && ''Lead''[FirstName] <> ""guy"" && ''Lead''[FirstName] <> ""submit"" && ''Lead''[FirstName] <> ""lead""), filter(''Lead'', not SEARCH(""test"",''Lead''[LastName],,Blank())), USERELATIONSHIP(''Lead''[Stewardship_Account__c],''Stewardship Account''[Id]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#New Appts Confirmed by Date Contract Signed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Event Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#New Appts Confirmed by Install Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Event Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#New Appts Confirmed by Lead Created Date', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Event Appointment Confirmed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Opps Lost', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Opportunities Lost Before Appt Ran]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) +0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline Projects', N'Subtract', N'Measure', N'CALCULATE([#Install Scheduled] - [#Installs Started])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline Projects', N'Subtract', N'Measure', N'"CALCULATE([#Install Scheduled] - [#Install Started], USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline Projects by Contract Signed', N'Subtract', N'Measure', N'"CALCULATE([#Install Scheduled by Contract Signed] - [#Install Started by Contract Signed], USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline Projects by Install Date', N'Subtract', N'Measure', N'"CALCULATE([#Install Scheduled by Install Date] - [#Install Started by Install Date], USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline to Sit', N'Subtract', N'Measure', N'CALCULATE([#Leads Converted]-[#Demos Ran]-[#Demos Scheduled] - [#Opps Lost])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline to Sit by Contract Signed', N'Subtract', N'Measure', N'CALCULATE([#Leads Converted by Contract Signed]-[#Demos Ran by Contract Signed]-[#Demos Scheduled by Contract Signed])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pipeline to Sit by Install Date', N'Subtract', N'Measure', N'CALCULATE([#Leads Converted by Install Date]-[#Demos Ran by Install Date]-[#Demos Scheduled by Install Date])', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pull Through', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Install Scheduled], [#Contracts Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pull through Percentage', N'Divide', N'Measure', N'"IF([#Contracts Signed -CF] = 0, 0, CALCULATE(DIVIDE([#Install Scheduled],[#Contracts Signed -CF]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pull through Percentage by Contract Signed', N'Divide', N'Measure', N'"IF([#Contracts Signed -CF by Contract Signed] = 0, 0, CALCULATE(DIVIDE([#Install Scheduled by Contract Signed],[#Contracts Signed -CF by Contract Signed]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Pull through Percentage by Install Date', N'Divide', N'Measure', N'"IF([#Contracts Signed by Install Date] = 0, 0, CALCULATE(DIVIDE([#Install Scheduled by Install Date],[#Contracts Signed by Install Date]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Contract', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Contracts Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Demo', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Total Demos]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Demo G FB', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending 2],[#Total Demos]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Lead', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Leads]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Lead by Contract', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend By Contract],[#Leads by Contract Signed],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Lead by Install', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend by Install],[#Leads by Install Date],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Lead Converted', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Leads Converted]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Real Cost Per Lead Converted G FB', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending 2],[#Leads Converted]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Referral Cost Per Demo', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Referral Spend],[#Total Demos],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Referral Cost Per Lead Converted', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Referral Spend],[#Leads Converted],0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Sit %', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Demos Completed] + [#Demos Scheduled], [#Leads Converted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Sit Percentage', N'Divide', N'Measure', N'"IF([#Demos Ran] = 0, 0, CALCULATE(DIVIDE([#Appointments Ran],[#Demos Ran]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Spending', N'Case', N'Measure', N'"IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) = ""Google"", [G Spend], [#Total Spend])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Demos', N'Sum', N'Measure', N'CALCULATE([#Demos Scheduled] + [#Demos Completed]) ', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Demos', N'Sum', N'Measure', N'"CALCULATE([#Demos Ran] + [#Demos Scheduled], USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Demos by Contract Signed', N'Sum', N'Measure', N'"CALCULATE([#Demos Ran by Contract Signed] + [#Demos Scheduled by Contract Signed], USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Demos by Install Date', N'Sum', N'Measure', N'"CALCULATE([#Demos Ran by Install Date] + [#Demos Scheduled by Install Date], USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Email Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', not ISBLANK(''Lead''[Total Email Leads])), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Email Leads Converted', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', not ISBLANK(''Lead''[Total Email Leads])), FILTER(''Lead'', NOT(ISBLANK(''Lead''[ConvertedDate]))), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]), USERELATIONSHIP(Callers[OwnerId], ''Lead''[Email Owner]))+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total kW Install Scheduled', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Scheduled Watts]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total kW Install Scheduled by Contract', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Install Scheduled Watts]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total kW Installed', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Installed Watts]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Spend', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Actual Cost]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Spend By Contract', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Actual Cost]), USERELATIONSHIP(''Date''[Date], Opportunity[Date_Contract_Signed__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'#Total Spend by Install', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Actual Cost]), USERELATIONSHIP(''Date''[Date], Opportunity[Actual_Install_Date__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Actual Cost Per Lead', N'Case', N'Measure', N'"IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) = ""Google"", [G Cost Per Lead], [#Cost Per Lead])"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Avg CPL', N'Average', N'Measure', N'"CALCULATE(AVERAGE(''Lead''[Actual Cost]),USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Cost Per Contract', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend],[#Contracts Signed]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'countLeadReasonLost', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Reason_Lost2__c]),USERELATIONSHIP(''Lead''[Created Date w/DST],''Date''[Date]),USERELATIONSHIP(Account[Territory__c],''Lead''[Territory2__c]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CPW', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending],[#Total kW Install Scheduled]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CPW by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend By Contract],[#Total kW Install Scheduled by Contract]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CPW by Install Date', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Total Spend by Install],[#Total kW Install Scheduled by Install]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'CPW G FB', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([Spending 2],[#Total kW Install Scheduled]*1000,0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email Covid Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', ''Lead''[Covid Email Leads]=1)) + 0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Email Referral Covid Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', ''Lead''[Email Referred] = 1))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'G Cost Per Lead', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([G Spend], [G Leads]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'G Leads', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Google Lead]), USERELATIONSHIP(''Date''[Date], ''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Lead Cost Spending', N'Sum', N'Measure', N'"CALCULATE(SUM(''Lead''[Modified Lead Cost]), USERELATIONSHIP(''Date''[Date],''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]),USERELATIONSHIP(''Lead''[Created Date w/DST],''Date''[Date]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]),USERELATIONSHIP(''Lead''[Territory2__c],Account[Territory__c]),USERELATIONSHIP(''Date''[Date],''Lead''[Created Date w/DST]))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Sit Rate', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Demos Ran] + [#Demos Scheduled], [#Leads Converted], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Sit Rate by Contract Signed', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Demos Ran by Contract Signed] + [#Demos Scheduled by Contract Signed], [#Leads Converted by Contract Signed], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Sit Rate by Install Date', N'Divide', N'Measure', N'"CALCULATE(DIVIDE([#Demos Ran by Install Date] + [#Demos Scheduled by Install Date], [#Leads Converted by Install Date], 0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Spend Per Contract', N'Divide', N'Measure', N'"DIVIDE([Spending],[#Contracts Signed -CF],0)+0"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Spend Per Contract G FB', N'Divide', N'Measure', N'"DIVIDE([Spending 2],[#Contracts Signed -CF],0)"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Spending', N'Case', N'Measure', N'"IF(OR(ISFILTERED(''Lead''[Actual Territory]),ISFILTERED(''Lead''[Actual State (groups)])),[#Total Spend],IF(HASONEVALUE(''Lead''[Actual_Lead_Source]),IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) = ""Google"", [G Spend], IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) =""Facebook"", [FB Spend], [#Total Spend])), CALCULATE([Lead Cost Spending] + [G Spend] + [FB Spend])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Spending 2', N'Case', N'Measure', N'"IF(ISFILTERED(''Lead''[Actual Territory]) || ISFILTERED(''Lead''[Actual State (groups)]) || ISFILTERED(Opportunity[Division__c (groups)]) || ISFILTERED(Opportunity[Division__c]) || ISFILTERED(Opportunity[Direct_Sales_Office__c (groups)]) || ISFILTERED(Opportunity[Sales Rep]),[#Total Spend],IF(HASONEVALUE(''Lead''[Actual_Lead_Source]),IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) = ""Google"", [G Spend], IF(SELECTEDVALUE(''Lead''[Actual Lead Source]) =""Facebook"", [FB Spend], [#Total Spend])), CALCULATE([Lead Cost Spending] + [G Spend] + [FB Spend])))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Lead', N'Total Covid Leads', N'Count', N'Measure', N'"CALCULATE(COUNT(''Lead''[Id]), FILTER(''Lead'', SEARCH(""Covid"", ''Lead''[LeadSource],, BLANK() ) >0))"', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'AccountId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Active_Project_Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Install_Complete_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Install_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Actual_Multiplier__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Amount', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Amount_of_Trees_Shading__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appointment_Completed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appointment_Setting__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appt_Completed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Commissionable_Amount__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Commissionable_Price_Per_Watt__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_Created__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_Signed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Contract_to_Install_Timeframe__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'CreatedById', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'CreatedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Customer_Interaction_Outline__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_Contract_Created__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_Contract_Signed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_Contract_Submitted__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_Interconn_Approved__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_LOI_Signed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Date_Time_of_First_Appt__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Demo_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Direct_Sales_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Division__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Eagleview_Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Estimated_Multiplier__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Event_Name__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'GCLID__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Id', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Complete_Date__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Scheduled__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_Started__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Install_to_PTO__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installation_Duration_Days__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Installation_Scheduled__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LastModifiedDate', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lead_Generation_Specialist__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lead_Generator__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lead_Generator_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LeadSource', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LOI_Requested_Rate__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'LOI_Signed__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Lost_Comments__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Main_Phone__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Managing_Office__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Name', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Opportunity_Contracts__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Opportunity_Count__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Partner__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PPA_Rate__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PPA_Rate_Escalator__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Previous_Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Price_per_Watt__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Primary_Contact__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Project_Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Project_Track__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'PTO__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Purchase_Method__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Reason_Lost__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'RecordTypeId', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Referrer_Name_new__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Referrer_Opportunity__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Resolution_Specialist__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'RSA_Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Self_Gen__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Site_Assessment__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Stage_Status__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'StageName', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Stewardship_Account__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'System_Size_kWdc__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Territory2__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Trinity_Salesperson__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Type__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Utility_Company_Formula__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Willing_to_Remove_Trees__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Win_Back_Commenced__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'X12_mos_PVWATTS_prod_Actual__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'X12_mos_PVWATTS_prod_kwh_s_Contract__c', N'SF', N'Standard', N'', N'', NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Above_EPC_rate_target', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Contract -CF] = 0,     BLANK(),     IF(         Opportunity[PM Groups] = ""Sunnova PPA"" || Opportunity[PM Groups] = ""Sunnova Lease"" || Opportunity[PM Groups] = ""IGS"" || Opportunity[PM Groups] = ""Sunrun"",         IF(             Opportunity[Above Rate] = 1 && Opportunity[Above EPC] = 1,             1,             0         ),         IF(             Opportunity[Above EPC] = 1,             1,             0         )     ) )"', N'CASE WHEN Opportunity.[Contract_CF] = 0 THEN NULL        WHEN (Opportunity.[PM_Groups] = ''Sunnova PPA'' OR Opportunity.[PM_Groups] = ''Sunnova Lease''         OR Opportunity.[PM_Groups] = ''IGS'' OR Opportunity.[PM_Groups] = ''Sunrun'') AND Opportunity.[Above_Rate_Target] = 1 AND Opportunity.[Above_EPC_target] = 1  THEN 1      WHEN (Opportunity.[PM_Groups] <> ''Sunnova PPA'' OR Opportunity.[PM_Groups] <> ''Sunnova Lease''         OR Opportunity.[PM_Groups] <> ''IGS'' OR Opportunity.[PM_Groups] <> ''Sunrun'') AND Opportunity.[Above_EPC_target] = 1 THEN 1      ELSE 0 END', NULL, NULL, 46, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Above_EPC_target', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Minimum] <> BLANK() && Opportunity[Commissionable_Price_Per_Watt__c] <> BLANK(),     IF(         Opportunity[Commissionable_Price_Per_Watt__c] >= Opportunity[Minimum],         1,         0     ) )"', N'CASE WHEN Opportunity.[Target_Minimum] IS NOT NULL AND Opportunity.[Commissionable_Price_Per_Watt__c] IS NOT NULL AND    Opportunity.[Commissionable_Price_Per_Watt__c] >= Opportunity.[Target_Minimum] THEN 1 ELSE 0 END', NULL, NULL, 46, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Above_rate_target', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Min Rate] <> BLANK() && Opportunity[PPA_Rate__c] <> BLANK(),     IF(         Opportunity[PPA_Rate__c] >= Opportunity[Min Rate],         1,         0     ) )"', N'CASE WHEN Opportunity.[Target_Rate] <> NULL AND Opportunity.[PPA_Rate__c] <> NULL  AND Opportunity.[PPA_Rate__c] >= Opportunity.[Target_Rate] THEN 1 ELSE 0 END', NULL, NULL, 48, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Account', N'Last_Eagleview_Ordered', N'Time Conversion', N'Column', N'"var Ordered_DST_Start = LOOKUPVALUE(DST[DST Start], DST[Year], YEAR(Account[Last_EagleView_Ordered__c])) var Ordered_DST_End = LOOKUPVALUE(DST[DST End], DST[Year], YEAR(Account[Last_EagleView_Ordered__c]))  return IF(ISBLANK(Account[Last_EagleView_Ordered__c]), BLANK(), FORMAT(if(and(Account[Last_EagleView_Ordered__c] >= Ordered_DST_Start, Account[Last_EagleView_Ordered__c] < Ordered_DST_End), Account[Last_EagleView_Ordered__c] - (4/24), Account[Last_EagleView_Ordered__c] - (5/24)), ""MM/DD/YYYY""))"', N'[Last_EagleView_Ordered__c] AT TIME ZONE ''UTC'' AT TIME ZONE ''Eastern Standard Time''', NULL, NULL, 1, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Active_Project_Track', N'Lookup', N'Column', N'"LOOKUPVALUE(''Project Track''[Track__c], ''Project Track''[Id], Opportunity[Active_Project_Track__c])"', N'Project_Track.[Track__c]', N'[Project_Track]', N'Project_Track.[Id]=Opportunity.[Active_Project_Track__c]', 18, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'delta_Production_estimate', N'Case - Result', N'Column', N'"IF(Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c]>0,IF(not ISBLANK(Opportunity[Actual Less Contract]), Opportunity[Actual Less Contract] / Opportunity[X12_mos_PVWATTS_prod_kwh_s_Contract__c], BLANK()),BLANK())"', N'CASE WHEN Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c]>0 THEN 
Opportunity.[Actual_Less_Contract] / Opportunity.[X12_mos_PVWATTS_prod_kwh_s_Contract__c] 
 WHEN Opportunity.[Actual_Less_Contract] IS NOT NULL THEN NULL ELSE NULL END', NULL, NULL, 10, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appt_Completed', N'Case - Power of 1', N'Column', N'"IF(     Opportunity[Appointment_Completed__c] = 1,     1,     IF(         NOT(ISBLANK(Opportunity[Appt Ran From Event])),         1,         0     ) )"', N'CASE WHEN Opportunity.[Appointment_Completed__c] = 1 THEN 1  
WHEN Opportunity.[Appts_Ran_count] >0   THEN 1 ELSE 0 END', NULL, NULL, 28, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appt_Scheduled', N'Case - Power of 1', N'Column', N'"IF(Opportunity[Appt Date] >= TODAY() && Opportunity[Appointment_Completed__c] = 0, 1, 0)"', N'CASE WHEN Opportunity.[Appt_Date] >= GETDATE() AND 
Opportunity.[Appointment_Completed__c] = 0 THEN 1 ELSE 0 END', NULL, NULL, 9, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Appt_After_Contract_Signed', N'Case - Result', N'Column', N'"IF(ISBLANK(Opportunity[Date_Contract_Signed__c]), BLANK(), CALCULATE(MAX(Event[Appt Date]), FILTER(Event, Event[Opp Id] = Opportunity[Id]), FILTER(Event, Event[Appt Date]> Opportunity[Date_Contract_Signed__c])))"', N'CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL THEN NULL ELSE MAX(Event.[Appt_Date]) END', N'[Event]', N'Event.[Oppt_Id] = Opportunity.[Id] AND Event.[Appt_Date]> Opportunity.[Date_Contract_Signed__c]', 30, NULL, N'Opportunity.[Date_Contract_Signed__c]', N'Id', 2)
GO
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Effective_Date', N'Case - Result', N'Column', N'IF(     ISBLANK(Opportunity[Date_Contract_Signed__c]),     BLANK(),     IF(         Opportunity[Trad or Direct] = BLANK(),      
   BLANK(),         IF(             Opportunity[Date_Contract_Signed__c] <= MIN(Pricing_Matrix[effective_date]),       
         MIN(Pricing_Matrix[effective_date]),             CALCULATE(MAX(Pricing_Matrix[effective_date]),
		  FILTER(Pricing_Matrix, Pricing_Matrix[sales_division] = Opportunity[Trad or Direct]),
		   FILTER(Pricing_Matrix, Pricing_Matrix[effective_date] <= Opportunity[Date_Contract_Signed__c]))         )     ) )', N'CASE WHEN Opportunity.[Date_Contract_Signed__c] IS NULL THEN NULL    WHEN Opportunity.[Trad_or_Direct] IS NULL THEN NULL          WHEN Opportunity.[Date_Contract_Signed__c] <= MIN(Pricing_Matrix_Denormalized.[effective_date]) THEN MIN(Pricing_Matrix_Denormalized.[effective_date]) ELSE MAX(Pricing_Matrix_Denormalized.[effective_date]) END', N'[Pricing_Matrix_Denormalized]', N'Pricing_Matrix_Denormalized.[sales_division]  = Opportunity.[Trad_or_Direct]
 AND Pricing_Matrix_Denormalized.effective_date<=Opportunity.[Date_Contract_Signed__c]', 11, NULL, N'Opportunity.[Date_Contract_Signed__c],Opportunity.[Trad_or_Direct]', N'Id', 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Outcome__c_groups', N'Group', N'Column', NULL, N'CASE WHEN Event.Outcome__c IN(''Appt Ran / Details to follow''  ,''Appt Run / Contract Signed'' ,
''Appt Run / Customer Not Signed''  ,''Go-Back Run/ Customer Not Signed''  ,''Go-Back Run/ Customer Signed'') 
THEN ''Ran''  WHEN Event.Outcome__c IN(  ''Door Opened / Appt Not Completed''  ,
''No Rep to Run / Avail Rep Refused Appt''  ,''No Rep to Run / Last minute schedule change, none avail''  ,
''No Rep to Run / Only time avail for customer doesnt work for TS''  ,''No Show / Rep Called In''  ,
''No Show / Rep Did Not Call In''  ,''Not Run / #3-Reschedule''  ,''Not Run / Cancelled - During Confirmation''  ,
''Not Run / Cancelled - Email''  ,''Not Run / Cancelled - Inbound Call''  ,''Not Run / Cancelled - Unqualified RSA''  ,
''Not Run / Cancelled at the Door''  ,''Not Run / Customer Already Rescheduled''  ,''Not Run / Customer Never Confirmed'',
''Not Run / Customer Requested Reschedule''  ,''Not Run / Rep Missed Appt''  ) THEN ''Not Ran''
END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Event', N'Outcomes_groups_1', N'Group', N'Column', NULL, N'
CASE WHEN Event.outcomes IN(''Appt Ran / Details to follow''  ,''Appt Run / Contract Signed''  ,
''Appt Run / Customer Not Signed''  ,''Go-Back Run/ Customer Not Signed''  ,''Go-Back Run/ Customer Signed'')
 THEN ''Appointment Ran''  
 WHEN Event.outcomes =''Not Updated'' THEN ''Appointment Not Updated'' 
  WHEN Event.outcomes IN(  ''Door Opened / Appt Not Completed''  ,''No Rep to Run / Avail Rep Refused Appt''  ,
  ''No Rep to Run / Last minute schedule change, none avail''  ,''No Rep to Run / Only time avail for customer doesnt work for TS''  ,
  ''No Show / Rep Called In''  ,''No Show / Rep Did Not Call In''  ,''Not Run / #3-Reschedule''  ,
  ''Not Run / Cancelled - During Confirmation''  ,''Not Run / Cancelled - Email''  ,''Not Run / Cancelled - Inbound Call''  ,
  ''Not Run / Cancelled - Unqualified RSA''  ,''Not Run / Cancelled at the Door''  ,''Not Run / Customer Already Rescheduled''  ,
  ''Not Run / Customer Never Confirmed''  ,''Not Run / Customer Requested Reschedule''  ,''Not Run / Rep Missed Appt'') 
  THEN ''Appointment Not Run'' END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Division__c_groups', N'Group', N'Column', NULL, N'
	CASE   WHEN Opportunity.Division__c IN(''Direct'',''Direct - Solar Pro'') THEN ''Direct''         
    WHEN Opportunity.Division__c=''Traditional'' THEN ''Traditional''         
	WHEN Opportunity.Division__c=''Outreach'' THEN ''Outreach''     ELSE  ''Other''   END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Office__c_groups', N'Group', N'Column', NULL, N'CASE WHEN  Contact.Sales_Office__c IN(''NY- Long Island - Nassau'',''NY- Long Island - Suffolk'',''NY- Long Island 1''  ,''NY- Long Island 2'',''NY- Long Island 3'') THEN ''NY- Long Island''
	  WHEN Contact.Sales_Office__c IN(''NY- Central'',''NY- Hudson'',''NY- South'',''NY- Staten Island'',''NY- Upstate'',''NY- West'')   THEN ''NY- South''  ELSE Contact.Sales_Office__c END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Contact', N'Sales_Division__c_groups', N'Group', N'Column', NULL, N'CASE WHEN Contact.Sales_Division__c=''Sales- Direct'' THEN ''Direct''
WHEN Contact.Sales_Division__c=''Sales- Outreach'' THEN ''Outreach''
WHEN Contact.Sales_Division__c=''Sales- Traditional'' THEN ''Traditional''
ELSE ''Other'' END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Contact_Division_groups', N'Group', N'Column', NULL, N'CASE WHEN contact_division =''Solar Pro'' THEN ''Solar Pro''
	WHEN contact_division LIKE''%Direct%'' THEN ''Direct''
	WHEN contact_division LIKE''%Traditional%'' THEN ''Traditional''
	WHEN contact_division LIKE''%Outreach%'' THEN ''Outreach'' ELSE ''Other'' END', NULL, NULL, 2, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'User', N'Contact_Office_groups', N'Group', N'Column', NULL, N'CASE WHEN [User].Contact_Office 
	IN(''NY- Long Island'',''NY- Long Island - Nassau'',''NY- Long Island - Suffolk''  ,
 ''NY- Long Island 1'',''NY- Long Island 2'',''NY- Long Island 3'') THEN ''NY- Long Island''      
   WHEN [User].Contact_Office IN(''NY- Central''  ,''NY- Hudson'',''NY- South'',''NY- Staten Island'',''NY- Upstate'' 
    ,''NY- West'') THEN ''NY- South''  ELSE [User].Contact_Office END', NULL, NULL, 0, NULL, NULL, NULL, 1)
INSERT [dbo].[TSBT_BI_Metadata] ([Table_Name], [Column_Name], [Type_Of_Column], [Measured_Calculated], [Measured_Calculated_Formula], [Column_Definition], [Lookup_Table], [Join_Condition], [Execution_Order], [Join_Type], [Group_By_Condition], [Identity_Column], [Cycle]) VALUES (N'Opportunity', N'Direct_Sales_Office__c_groups', N'Group', N'Column', NULL, N'CASE WHEN Opportunity.Direct_Sales_Office__c = ''CA- SD'' THEN ''CA SD''
 WHEN Opportunity.Direct_Sales_Office__c = ''CT- Central''   THEN ''CT Central''
 WHEN Opportunity.Direct_Sales_Office__c = ''CT- North''  THEN ''CT North''
 WHEN Opportunity.Direct_Sales_Office__c = ''MA- Central''  THEN ''MA Central''
 WHEN Opportunity.Direct_Sales_Office__c = ''MA- West''  THEN ''MA West''
 WHEN Opportunity.Direct_Sales_Office__c = ''MA- RI''  THEN ''MA RI''
 WHEN Opportunity.Direct_Sales_Office__c = ''MA- South'' THEN ''MA South''
 WHEN Opportunity.Direct_Sales_Office__c = ''MD'' THEN ''MD''
 WHEN Opportunity.Direct_Sales_Office__c = ''NJ- East'' THEN ''NJ East''
 WHEN Opportunity.Direct_Sales_Office__c = ''NJ- North'' THEN ''NJ North''
 WHEN Opportunity.Direct_Sales_Office__c = ''NJ- South'' THEN ''NJ South''
 WHEN Opportunity.Direct_Sales_Office__c = ''NJ- West'' THEN ''NJ West''
 WHEN Opportunity.Direct_Sales_Office__c IN (''NY- Central'', ''NY- Hudson'', ''NY- Long Island'', ''NY- Long Island - Nassau'', ''NY- Long Island - Suffolk'', 
 ''NY- Long Island 1'', ''NY- Long Island 2'', ''NY- Long Island 3'', ''NY-South'', ''NY- Staten Island'', ''NY- Upstate'', 
 ''NY- West'') THEN ''NY'' ELSE ''Other'' END', NULL, NULL, 0, NULL, NULL, NULL, 1)



 /*----------------------------------------------------------------------------------------------------*/
